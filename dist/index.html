<!DOCTYPE html>
<html>
  <head>
    <!--<link rel="stylesheet" href="css/styles.css" type="text/css">-->
    <script src="prop/prop_scripts_js.js"></script>
    <script src="resources/pako/pako.min.js"></script>
    <script src="resources/jsPDF/jspdf.umd.min.js"></script>
    <script src="resources/jsPDF/print.js"></script>
    <title>Eendraadschema online tekenen</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="keywords" content="Eendraadschema, online, tekenen, svg, gratis">
    <meta name="description" content="Een tool om ééndraadschema’s te tekenen">
    <meta name="author" content="Ivan Goethals">
    <style type="text/css" media="print">
      @page {
        size: landscape;
      }
    </style>
    <script type="module" crossorigin>var ai=Object.defineProperty,ri=Object.defineProperties;var ni=Object.getOwnPropertyDescriptors;var Re=Object.getOwnPropertySymbols;var jt=Object.prototype.hasOwnProperty,Rt=Object.prototype.propertyIsEnumerable;var $t=(i,e,t)=>e in i?ai(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,V=(i,e)=>{for(var t in e||(e={}))jt.call(e,t)&&$t(i,t,e[t]);if(Re)for(var t of Re(e))Rt.call(e,t)&&$t(i,t,e[t]);return i},me=(i,e)=>ri(i,ni(e));var ae=(i,e)=>{var t={};for(var s in i)jt.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&Re)for(var s of Re(i))e.indexOf(s)<0&&Rt.call(i,s)&&(t[s]=i[s]);return t};(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function t(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=t(a);fetch(a.href,r)}})();class oi{constructor(e,t,s){this.ulElement=document.getElementById(e),this.liClassName=t,this.menuItems=s,this.renderMenu(),this.resetToFirstItem()}renderMenu(){const e=Array.from(this.ulElement.children).filter(t=>{var s;return(s=t.classList)==null?void 0:s.contains("menu-item-right")});this.ulElement.innerHTML="",this.menuItems.forEach(t=>{const s=document.createElement("li"),a=document.createElement("a");s.className=this.liClassName,a.innerText=t.name,a.addEventListener("click",()=>{this.selectItem(a),t.callback()}),s.appendChild(a),this.ulElement.appendChild(s)}),e.forEach(t=>this.ulElement.appendChild(t))}selectItem(e){this.ulElement.querySelectorAll("a").forEach(s=>s.removeAttribute("id")),e.id="current"}findAnchorByName(e){return Array.from(this.ulElement.querySelectorAll("a")).find(t=>t.innerText===e)||null}highlightMenuItemByName(e){const t=this.findAnchorByName(e);t&&this.selectItem(t)}resetToFirstItem(){const e=this.ulElement.querySelector("a");e&&this.selectItem(e)}selectMenuItemByName(e){const t=this.menuItems.find(s=>s.name===e);if(t){const s=this.findAnchorByName(e);s&&(this.selectItem(s),t.callback())}}setMenuItems(e){const t=this.ulElement.querySelector("a#current"),s=t==null?void 0:t.innerText;this.menuItems=e,this.renderMenu(),s&&this.menuItems.some(a=>a.name===s)?this.highlightMenuItemByName(s):this.resetToFirstItem()}selectMenuItemByOrdinal(e){const t=this.ulElement.querySelectorAll("a");t.forEach(s=>s.removeAttribute("id")),this.selectItem(t[e])}}class H{constructor(){this.data="",this.xleft=0,this.xright=0,this.xrightmin=0,this.yup=0,this.ydown=0,this.firstChildydown=null,this.lastChildyup=null,this.connectorPos=[]}}class ft{constructor(e){this.id=0,this.parent=0,this.indent=0,this.collapsed=!1,this.props={},this.sourcelist=e}resetProps(){this.props={}}getMaxNumChilds(){return 18}isActief(){let e=this.sourcelist.getOrdinalById(this.id);return e===null?!1:this.sourcelist.active[e]}getParent(){let e=this.sourcelist.getOrdinalById(this.parent);if(e===null)return null;let t=this.sourcelist.data[e];return t===void 0&&(t=null),t}stringPropToHTML(e,t){let s="";if(e=="naam")switch(this.props.type){case"Aansluiting":case"Bord":s+="font-weight: bold;";break;case"Kring":case"Zekering/differentieel":case"Splitsing":s+="font-weight: bold; background-color:#FFFFE0;";break;case"Domotica":case"Domotica module (verticaal)":s+="font-weight: bold; background-color: lightgreen;";break}let a="",r="";return t!=null&&(r=' size="'+t+'" '),a=`<input type="text"${r} style="${s}" id="HL_edit_${this.id}_${e}" value="${this.props[e]}">`,a}checkboxPropToHTML(e){let t;return t='<input type="checkbox" id="HL_edit_'+this.id+"_"+e+'" '+(this.props[e]?" checked":"")+">",t}selectPropToHTML(e,t,s){let a="HL_edit_"+this.id+"_"+e,r="",n="",o="";if(e=="type")switch(this.props.type){case"Aansluiting":case"Bord":o+="background-color: #FFD580;";break;case"Kring":case"Zekering/differentieel":case"Splitsing":o+="background-color:#FFFFE0;";break;case"Domotica":case"Domotica module (verticaal)":o+="background-color: lightgreen;";break}s!=null&&(o+="width: "+s+"px;"),r=`<select style="${o}" id="${a}">`;for(let c=0;c<t.length;c++)n="",this.props[e]==t[c]&&(n+=" selected"),t[c]=="---"&&(n+=" disabled",t[c]="---------------------------"),t[c]=="-"&&(n+=" disabled",t[c]="---"),r+='<option value="'+t[c]+'" '+n+">"+t[c]+"</option>";return r+="</select>",r}toHTML(e){return"toHTML() function not defined for base class List_Item. Extend class first."}toSVG(){return new H}}function y(i){let e;typeof i=="undefined"?e="":e=i.toString();var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(s){return t[s]})}const ce=(function(){let i=null;return function(){return i!==null||("InstallTrigger"in window?i=!0:i=navigator.userAgent.toLowerCase().includes("firefox")),i}})(),ee=(()=>{const i={};return(e,t=10,s="")=>{const a=`${e}|${t}|${s}`;if(a in i)return i[a];const r=document.createElement("div");r.innerHTML=`<svg width="1000" height="20"><text x="0" y="10" style="text-anchor:start" font-family="Arial, Helvetica, sans-serif" font-size="${t}" ${s}>${e}</text></svg>`,document.body.appendChild(r);const n=r.children[0].children[0].getBBox().width;return document.body.removeChild(r),i[a]=Math.ceil(n),i[a]}})();function Ut(i="black"){return`
    <div style="display:inline-block; width:1em; height:1em; vertical-align:middle;">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="100%" height="100%">
        <path d="M4 11h12M4 11L4 4M16 11L11 6M16 11L11 16" stroke="${i}" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </div>
  `}function mt(i,e){for(let t=0;t<i.length;t++)if(i[t]===e)return!0;return!1}function I(i){if(i==null||typeof i=="undefined")return"";if(typeof i!="string")try{i=String(i)}catch(e){return""}return i.trim()}function Be(i){let e=new i.constructor,t=function(s){return Object.prototype.toString.call(s).slice(8,-1)};for(let s in i)i.hasOwnProperty(s)&&(e[s]=t(i[s])==="Object"||t(i[s])==="Array"?Be(i[s]):i[s]);return e}const li=(()=>{const i={};return(e="Rnd_")=>{e in i||(i[e]=0);const t=i[e];return i[e]++,`${e}${t.toString()}`}})();async function ci(i,e){return new Promise(t=>{const s=document.createElement("div");Object.assign(s.style,{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",visibility:"hidden",zIndex:9999}),document.body.appendChild(s);const a=document.createElement("div");Object.assign(a.style,{backgroundColor:"white",border:"1px solid #ccc",padding:"20px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)"}),s.appendChild(a);const r=document.createElement("div");r.style.display="flex",r.style.alignItems="center";const n=document.createElement("p");n.textContent=i,r.appendChild(n);const o=document.createElement("select");e.forEach(h=>{const p=document.createElement("option");p.value=h,p.textContent=h,o.appendChild(p)}),o.style.marginLeft="10px",r.appendChild(o),a.appendChild(r);const c=document.createElement("div");Object.assign(c.style,{display:"flex",justifyContent:"center",marginTop:"10px"});const l=document.createElement("button");l.textContent="OK",l.style.marginRight="10px",c.appendChild(l);const d=document.createElement("button");d.textContent="Annuleren",c.appendChild(d),a.appendChild(c),l.addEventListener("click",()=>{const h=o.value;s.style.visibility="hidden",s.removeChild(a),document.body.removeChild(s),t(h)}),d.addEventListener("click",()=>{s.style.visibility="hidden",s.removeChild(a),document.body.removeChild(s),t(null)}),s.style.visibility="visible"})}function ps(i,e,t,s,a=0,r=null){var b,_;s==0&&globalThis.structure.print_table.pagemarkers.clear();var n="",o=new XMLSerializer;new DOMParser;var c=!1,l=i;if(i.localName=="svg"){const v=(_=(b=l.attributes)==null?void 0:b.getNamedItem)==null?void 0:_.call(b,"data-eds-id");v&&typeof v.nodeValue=="string"&&v.nodeValue!==""&&(r=v.nodeValue),l.attributes.getNamedItem("newPage")&&(c=!0),l.attributes.getNamedItem("x")&&(e+=parseFloat(l.attributes.getNamedItem("x").nodeValue),l.attributes.getNamedItem("x").nodeValue=0),l.attributes.getNamedItem("y")&&(t+=parseFloat(l.attributes.getNamedItem("y").nodeValue),l.attributes.getNamedItem("y").nodeValue=0);for(var d=0;d<i.children.length;d++)n=n.concat(ps(i.children[d],e,t,s+1,a,r),`
`);s<=0&&(l.attributes.getNamedItem("width")?n='<svg id="EDSSVG" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" transform="scale(1,1)" width="'+(parseInt(l.attributes.getNamedItem("width").nodeValue)+a)+'" height="'+l.attributes.getNamedItem("height").nodeValue+'">'+n+"</svg>":n="<svg>"+n+"</svg>")}else{if(r!=null&&r!=="")try{l.setAttribute("data-eds-id",r)}catch(v){}if(i.localName=="line"&&(e!=0&&(l.attributes.getNamedItem("x1").nodeValue=parseFloat(l.attributes.getNamedItem("x1").nodeValue)+e,l.attributes.getNamedItem("x2").nodeValue=parseFloat(l.attributes.getNamedItem("x2").nodeValue)+e),t!=0&&(l.attributes.getNamedItem("y1").nodeValue=parseFloat(l.attributes.getNamedItem("y1").nodeValue)+t,l.attributes.getNamedItem("y2").nodeValue=parseFloat(l.attributes.getNamedItem("y2").nodeValue)+t)),i.localName=="use"&&(e!=0&&(l.attributes.getNamedItem("x").nodeValue=parseFloat(l.attributes.getNamedItem("x").nodeValue)+e),t!=0&&(l.attributes.getNamedItem("y").nodeValue=parseFloat(l.attributes.getNamedItem("y").nodeValue)+t)),i.localName=="rect"&&(e!=0&&(l.attributes.getNamedItem("x").nodeValue=parseFloat(l.attributes.getNamedItem("x").nodeValue)+e),t!=0&&(l.attributes.getNamedItem("y").nodeValue=parseFloat(l.attributes.getNamedItem("y").nodeValue)+t)),i.localName=="circle"&&(e!=0&&(l.attributes.getNamedItem("cx").nodeValue=parseFloat(l.attributes.getNamedItem("cx").nodeValue)+e),t!=0&&(l.attributes.getNamedItem("cy").nodeValue=parseFloat(l.attributes.getNamedItem("cy").nodeValue)+t)),i.localName=="text"&&(l.attributes.getNamedItem("x").nodeValue=parseFloat(l.attributes.getNamedItem("x").nodeValue)+e,l.attributes.getNamedItem("y").nodeValue=parseFloat(l.attributes.getNamedItem("y").nodeValue)+t,l.attributes.getNamedItem("transform")&&(l.attributes.getNamedItem("transform").value.includes("rotate")?l.attributes.getNamedItem("transform").value="rotate(-90 "+l.attributes.getNamedItem("x").nodeValue+","+l.attributes.getNamedItem("y").nodeValue+")":l.attributes.getNamedItem("transform").value="scale(-1,1) translate(-"+l.attributes.getNamedItem("x").nodeValue*2+",0)")),i.localName=="polygon"){var h="",p=l.attributes.getNamedItem("points").nodeValue,u=p.split(" ");for(let v=0;v<u.length;v++){let T=u[v].split(",");h+=T[0]*1+e+","+(T[1]*1+t),v<u.length-1&&(h+=" ")}l.attributes.getNamedItem("points").nodeValue=h}n=o.serializeToString(l);var g=/xmlns="[^"]+"/g;n=n.replace(g,"")}return globalThis.structure.print_table.pagemarkers.addMarker(s,e,c),n}function Pt(i,e=0){var t="",s=new DOMParser,a=s.parseFromString(i,"text/xml");return t=ps(a.childNodes[0],0,0,0,e,null),t}function di(i){return!isNaN(i)&&parseInt(i)==i&&!isNaN(parseInt(i,10))}function hi(){var i=window.navigator.userAgent,e=i.indexOf("MSIE "),t=i.indexOf("Trident/");return e>0||t>0}function Ae(i,e=6){if(isNaN(i)||!isFinite(i))return"";e=Math.floor(e);let s=(Math.round(i*10**e)/10**e).toString();return s=s.replace(/(\.\d*?[1-9])0+$/,"$1").replace(/\.$/,""),s}function ie(i){if(typeof i!="string"||i.trim()==="")return NaN;const e=i.trim();let t=parseFloat(e);if(!isNaN(t)&&!e.includes(","))return t;if(e.includes(",")){const s=e.replace(",",".");return t=parseFloat(s),t}return t}const at=class at{static addSymbol(e){this.neededSymbols.includes(e)||this.neededSymbols.push(e)}static clearSymbols(){this.neededSymbols=[]}static getNeededSymbols(e=!1){let t="<defs>";this.neededSymbols.includes("VerticalStripe")&&(t+='<pattern id="VerticalStripe" x="5" y="0" width="5" height="10" patternUnits="userSpaceOnUse" ><line x1="0" y1="0" x2="0" y2="10" stroke="black" /></pattern>');for(let s in this.data)if(this.neededSymbols.includes(s))if(!e)t+=`<g id="${s}">${this.data[s].replace(/\n/g,"")}</g>`;else{let a=this.data[s].replace(/fill="white"/g,'fill="#e8e8e8"');a=a.replace(/<use xlink:href="#/g,'<use xlink:href="#SB_'),t+=`<g id="SB_${s}">${a.replace(/\n/g,"")}</g>`}return t+="</defs>",t}static outputSVGSymbols(){let e='<defs><pattern id="VerticalStripe" x="5" y="0" width="5" height="10" patternUnits="userSpaceOnUse" ><line x1="0" y1="0" x2="0" y2="10" stroke="black" /></pattern>';for(let t in this.data)t!="VerticalStripe"&&(e+=`<g id="${t}">${this.data[t].replace(/\n/g,"")}</g>`);return e+="</defs>",e}};at.neededSymbols=[],at.data={aardingsonderbreker:`
<line x1="0" y1="0" x2="5" y2="0" stroke="black"/>
<line x1="10" y1="0" x2="30" y2="0" stroke="black"/>
<line x1="35" y1="0" x2="40" y2="0" stroke="black"/>
<line x1="5" y1="-5" x2="5" y2="5" stroke="black"/>
<line x1="10" y1="-5" x2="10" y2="5" stroke="black"/>
<line x1="30" y1="-5" x2="30" y2="5" stroke="black"/>
<line x1="35" y1="-5" x2="35" y2="5" stroke="black"/>
`,batterij:`
<rect x="0" y="-12" width="40" height="27" stroke="black" fill="none"/>
<rect x="5" y="-15" width="10" height="3" stroke="black" fill="none"/>
<rect x="25" y="-15" width="10" height="3" stroke="black" fill="none"/>
<line x1="8" y1="-5" x2="12" y2="-5" stroke="black"/>
<line x1="10" y1="-7" x2="10" y2="-3" stroke="black"/>
<line x1="28" y1="-5" x2="32" y2="-5" stroke="black"/>
`,batterij_nieuw:`
<line x1="0" y1="-15" x2="0" y2="+15" stroke="black" stroke-linecap="round" />
<line x1="7" y1="-8" x2="7" y2="+8" stroke="black" stroke-width="3" stroke-linecap="round" />
<line x1="8.5" y1="0" x2="21.5" y2="0" stroke="black" stroke-dasharray="3,3" stroke-linecap="round" />
<line x1="22" y1="-15" x2="22" y2="+15" stroke="black" stroke-linecap="round" />
<line x1="29" y1="-8" x2="29" y2="+8" stroke="black" stroke-width="3" stroke-linecap="round" />
`,contactdoos:`
<path d="M20 0 A15 15 0 0 1 35 -15" stroke="black" fill="none" stroke-width="2" />
<path d="M20 0 A15 15 0 0 0 35 15" stroke="black" fill="none" stroke-width="2" />
<line x1="0" y1="0" x2="20" y2="0" stroke="black" />
`,deurslot:`
<line x1="1" y1="-15" x2="31" y2="-15" stroke="black"/>
<line x1="1" y1="15"  x2="46" y2="15" stroke="black"/>
<line x1="1" y1="-15" x2="1" y2="15" stroke="black"/>
<line x1="31" y1="-15" x2="46" y2="15" stroke="black"/>
<path d="M 7 3 A 6 6 0 0 1 19 3 A 6 6 0 0 1 31 3" stroke="black" fill="none" />
`,ster:`
<line x1="0" y1="-5" x2="0" y2="5" style="stroke:black" />
<line x1="-4.33" y1="-2.5" x2="4.33" y2="2.5" style="stroke:black" />
<line x1="-4.66" y1="2.5" x2="4.33" y2="-2.5" style="stroke:black" />
`,EVlader:`
<rect x="0" y="13" width="40" height="7" fill="none" style="stroke:black" />
<line x1="0" y1="0" x2="7" y2="0" style="stroke:black" />
<line x1="7" y1="-20" x2="7" y2="13" style="stroke:black" />
<line x1="33" y1="-20" x2="33" y2="13" style="stroke:black" />
<line x1="7" y1="-20" x2="33" y2="-20" style="stroke:black" />
<rect x="10" y="-17" width="20" height="8" fill="none" style="stroke:black" />
<line x1="20" y1="-6" x2="20" y2="10" style="stroke:black" />
<line x1="33" y1="-6" x2="36" y2="-6" style="stroke:black" />
<line x1="36" y1="-6" x2="36" y2="4" style="stroke:black" />
<line x1="36" y1="4" x2="39" y2="4" style="stroke:black" />
<line x1="39" y1="4" x2="39" y2="-15" style="stroke:black" />
<line x1="39" y1="-6" x2="39" y2="-15" style="stroke:black;stroke-width:2" />
<text x="15" y="1" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="6">V</text>
<text x="25" y="1" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="6">E</text>
<text x="15" y="9" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="6">E</text>
<text x="25" y="9" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="6">V</text>
`,lamp:`
<line x1="-10.61" y1="-10.61" x2="10.61" y2="10.61" stroke="black" stroke-width="2" />
<line x1="-10.61" y1="10.61" x2="10.61" y2="-10.61" stroke="black" stroke-width="2" />
`,led:`
<line x1="0" y1="-7" x2="0" y2="7" stroke="black" stroke-width="2" />
<line x1="0" y1="-7" x2="12" y2="0" stroke="black" stroke-width="2" />
<line x1="0" y1="7" x2="12" y2="0" stroke="black" stroke-width="2" />
<line x1="12" y1="-7" x2="12" y2="7" stroke="black" stroke-width="2" />
<line x1="6" y1="-6" x2="7" y2="-11" stroke="black" stroke-width="1" />
<line x1="7" y1="-11" x2="8.11" y2="-9.34" stroke="black" stroke-width="1" />
<line x1="7" y1="-11" x2="5.34" y2="-9.9" stroke="black" stroke-width="1" />
<line x1="9" y1="-6" x2="10" y2="-11" stroke="black" stroke-width="1" />
<line x1="10" y1="-11" x2="11.11" y2="-9.34" stroke="black" stroke-width="1" />
<line x1="10" y1="-11" x2="8.34" y2="-9.9" stroke="black" stroke-width="1" />
`,luidspreker:`
<polygon points="0,-10 7,-10 17,-20 17,20 7,10 0,10" fill="none" stroke="black"/>
<line x1="7" y1="-10" x2="7" y2="10" stroke="black" stroke-width="1" />
`,magneetcontact:`
<rect x="0" y="-10" width="20" height="20" fill="black" stroke="black"/>
`,sinus:`
<path d="M0,0 C2,-5 8,-5 10,0 S18,5 20,0" style="stroke:black;fill:none" />
`,sinusVerticaal:`
<path d="M0,0 C-5,-2 -5,-8 0,-10 S5,-18 0,-20" style="stroke:black;fill:none" />
`,spot:`
<path d="M0 0 A10 10 0 0 1 10 -10" stroke="black" fill="white" stroke-width="1" />
<path d="M0 0 A10 10 0 0 0 10 10" stroke="black" fill="white" stroke-width="1" />
<circle cx="10" cy="0" r="6" style="stroke:black;fill:none" />
<line x1="5.76" x2="14.24" y1="-4.24" y2="4.24" stroke="black" stroke-width="1" />
<line x1="5.76" x2="14.24" y1="4.24" y2="-4.24" stroke="black" stroke-width="1" />
`,noodlamp_decentraal:`
<rect x="-10.61" y="-10.61" width="21.22" height="21.22" fill="white" stroke="black" />
<circle cx="0" cy="0" r="5" style="stroke:black;fill:black" />
<line x1="-7" y1="-7" x2="7" y2="7" stroke="black" stroke-width="2" />
<line x1="-7" y1="7" x2="7" y2="-7" stroke="black" stroke-width="2" />
`,signalisatielamp:`
<circle cx="0" cy="0" r="5" fill="white" stroke="black" />
<line x1="-3" y1="-3" x2="3" y2="3" stroke="black" />
<line x1="-3" y1="3" x2="3" y2="-3" stroke="black" />
`,schakelaar_enkel:`
<line x1="0" y1="0" x2="10" y2="-20" stroke="black" />
<line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black" />
<circle cx="0" cy="0" r="5" fill="white" stroke="black" />
`,schakelaar_klein:`
<line x1="0" y1="0" x2="6" y2="-12" stroke="black" />
<line x1="6" y1="-12" x2="9" y2="-10.5" stroke="black" />
<circle cx="0" cy="0" r="3" fill="white" stroke="black" />
`,schakelaar_dubbel:`
<line x1="0" y1="0" x2="10" y2="-20" stroke="black" />
<line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black" />
<line x1="8" y1="-16" x2="13" y2="-13.5" stroke="black" />
<circle cx="0" cy="0" r="5" fill="white" stroke="black" />
`,schakelaar_trippel:`
<line x1="0" y1="0" x2="10" y2="-20" stroke="black" />
<line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black" />
<line x1="8" y1="-16" x2="13" y2="-13.5" stroke="black" />
<line x1="6" y1="-12" x2="11" y2="-9.5" stroke="black" />
<circle cx="0" cy="0" r="5" fill="white" stroke="black" />
`,schakelaar_wissel_enkel:`
<line x1="0" y1="0" x2="10" y2="-20" stroke="black" />
<line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black" />
<line x1="0" y1="0" x2="-10" y2="20" stroke="black" />
<line x1="-10" y1="20" x2="-15" y2="17.5" stroke="black" />
<circle cx="0" cy="0" r="5" fill="white" stroke="black" />
`,schakelaar_rolluik:`
<line x1="0" y1="0" x2="10" y2="-20" stroke="black" />
<line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black" />
<line x1="0" y1="0" x2="-10" y2="-20" stroke="black" />
<line x1="-10" y1="-20" x2="-15" y2="-17.5" stroke="black" />
<rect x="-8" y="-8" width="16" height="16" fill="white" stroke="black" />
<text x="0" y="6" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="16">S</text>
`,schakelaar_enkel_dim:`
<line x1="0" y1="0" x2="10" y2="-20" stroke="black" />
<line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black" />
<circle cx="0" cy="0" r="5" fill="white" stroke="black" />
<polygon points="-1,-8 11,-8 11,-15" fill="black" stroke="black" />
`,schakelaar_wissel_dim:`
<line x1="0" y1="0" x2="10" y2="-20" stroke="black" />
<line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black" />
<line x1="0" y1="0" x2="-10" y2="20" stroke="black" />
<line x1="-10" y1="20" x2="-15" y2="17.5" stroke="black" />
<circle cx="0" cy="0" r="5" fill="white" stroke="black" />
<polygon points="-1,-8 11,-8 11,-15" fill="black" stroke="black" />
`,schakelaar_kruis_enkel:`
<line x1="0" y1="0" x2="10" y2="-20" stroke="black" />
<line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black" />
<line x1="0" y1="0" x2="-10" y2="20" stroke="black" />
<line x1="-10" y1="20" x2="-15" y2="17.5" stroke="black" />
<line x1="0" y1="0" x2="-10" y2="-20" stroke="black" />
<line x1="-10" y1="-20" x2="-15" y2="-17.5" stroke="black" />
<line x1="0" y1="0" x2="10" y2="20" stroke="black" />
<line x1="10" y1="20" x2="15" y2="17.5" stroke="black" />
<circle cx="0" cy="0" r="5" fill="white" stroke="black" />
`,schakelaar_dubbelaansteking:`
<line x1="0" y1="0" x2="-10" y2="-20" stroke="black" />
<line x1="-10" y1="-20" x2="-15" y2="-17.5" stroke="black" />
<line x1="0" y1="0" x2="10" y2="-20" stroke="black" />
<line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black" />
<circle cx="0" cy="0" r="5" fill="white" stroke="black" />
`,schakelaar_wissel_dubbel:`
<line x1="0" y1="0" x2="10" y2="-20" stroke="black" />
<line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black" />
<line x1="8" y1="-16" x2="13" y2="-13.5" stroke="black" />
<line x1="0" y1="0" x2="-10" y2="20" stroke="black" />
<line x1="-10" y1="20" x2="-15" y2="17.5" stroke="black" />
<line x1="-8" y1="16" x2="-13" y2="13.5" stroke="black" />
<circle cx="0" cy="0" r="5" fill="white" stroke="black" />
`,aansluitpunt:`
<circle cx="5" cy="0" r="5" style="stroke:black;fill:none" />
`,aftakdoos:`
<circle cx="15" cy="0" r="15" style="stroke:black;fill:none" />
<circle cx="15" cy="0" r="7.5" style="stroke:black;fill:black" />
`,bewegingsschakelaar:`
<rect x="0" y="-13" width="10" height="26" fill="none" style="stroke:black" />
<rect x="10" y="-13" width="30" height="26" fill="none" style="stroke:black" />
<line x1="10" y1="13" x2="40" y2="-13"  stroke="black" />
<line x1="15" y1="-5" x2="20" y2="-5"  stroke="black" />
<line x1="20" y1="-10" x2="20" y2="-5"  stroke="black" />
<line x1="20" y1="-10" x2="25" y2="-10"  stroke="black" />
<text x="22" y="11" style="text-anchor:start" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="10">PIR</text>
`,schakelaar:`
<line x1="0" y1="0" x2="5" y2="0"  stroke="black" />
<line x1="5" y1="0" x2="35" y2="-10"  stroke="black" />
<line x1="35" y1="0" x2="40" y2="0"  stroke="black" />
`,schemerschakelaar:`
<line x1="0" y1="0" x2="5" y2="0"  stroke="black" />
<line x1="5" y1="0" x2="35" y2="-10"  stroke="black" />
<line x1="35" y1="0" x2="40" y2="0"  stroke="black" />
<use xlink:href="#arrow" x="14" y="-17" transform="rotate(90 14 -17)" />
<use xlink:href="#arrow" x="18" y="-17" transform="rotate(90 18 -17)" />
`,stoomoven:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
<path d="M 6 -2 A 7 5 0 0 1 13 -7 A 7 5 0 0 1 27 -7 A 7 5 0 0 1 33 -2" stroke="black" fill="none" />
<path d="M 6  5 A 7 5 0 0 1 13  0 A 7 5 0 0 1 27  0 A 7 5 0 0 1 33  5" stroke="black" fill="none" />
<path d="M 6 12 A 7 5 0 0 1 13  7 A 7 5 0 0 1 27  7 A 7 5 0 0 1 33 12" stroke="black" fill="none" />
`,contactdoos_aarding:`
<line x1="20" y1="-15" x2="20" y2="15"  stroke="black" stroke-width="2" />
`,contactdoos_kinderveilig:`
<line x1="35" y1="-20" x2="35" y2="-14.1"  stroke="black" stroke-width="2" />
<line x1="35" y1="20" x2="35" y2="14.1"  stroke="black" stroke-width="2" />
`,bel:`
<path d="M20 0 A15 15 0 0 1 0 15" stroke="black" fill="none" stroke-width="2" />
<path d="M20 0 A15 15 0 0 0 0 -15" stroke="black" fill="none" stroke-width="2" />
<line x1="0" y1="15" x2="0" y2="-15" stroke="black" stroke-width="2" />
`,boiler:`
<circle cx="20" cy="0" r="20" style="stroke:black; fill:url(#VerticalStripe);" />
`,boiler_accu:`
<circle cx="20" cy="0" r="20" style="stroke:black;fill:none" />
<circle cx="20" cy="0" r="15" style="stroke:black;fill:url(#VerticalStripe)" />
`,motor:`
<circle cx="20" cy="0" r="20" style="stroke:black;fill:none" />
<text x="20" y="6" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="16">M</text>
`,elektriciteitsmeter:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
<line x1="0" y1="-6" x2="40" y2="-6" stroke="black" stroke-width="1" />
<text x="20" y="10" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="12">kWh</text>
`,diepvriezer:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
<use xlink:href="#ster" x="10" y="0" />
<use xlink:href="#ster" x="20" y="0" />
<use xlink:href="#ster" x="30" y="0" />
`,zonnepaneel:`
<rect x="0" y="-20" width="50" height="40" fill="none" style="stroke:black" />
<line x1="0" y1="0" x2="50" y2="0" stroke="black" />
<use xlink:href="#arrow" x="5" y="-12" transform="rotate(45 5 -10)" />
<use xlink:href="#arrow" x="10" y="-14" transform="rotate(45 10 -14)" />
`,zonnepaneel_driehoek:`
<rect x="0" y="-20" width="50" height="40" fill="none" style="stroke:black" />
<line x1="0" y1="-20" x2="20" y2="0" stroke="black" />
<line x1="0" y1="20" x2="20" y2="0" stroke="black" />
`,drukknop_klein:`
<circle cx="8" cy="0" r="7" style="stroke:black;fill:none" />
<circle cx="8" cy="0" r="4" style="stroke:black;fill:none" />
`,draadloos_klein:`
<path d="M 10 -7 A 10 10 0 0 1 10 7" stroke="black" fill="none" /> 
<path d="M 7 -5 A 8 8 0 0 1 7 5" stroke="black" fill="none" /> 
<path d="M 4 -3 A 6 6 0 0 1 4 3" stroke="black" fill="none" /> 
`,detectie_klein:`
<path d="M 10 -7 A 10 10 0 0 1 10 7" stroke="black" fill="none" /> 
<path d="M 5 -7 A 10 10 0 0 1 5 7" stroke="black" fill="none" /> 
`,drukknop:`
<circle cx="12" cy="0" r="12" style="stroke:black;fill:none" />
<circle cx="12" cy="0" r="7" style="stroke:black;fill:none" />
`,teleruptor:`
<rect x="0" y="-13" width="40" height="26" fill="none" style="stroke:black" />
<line x1="8" y1="6" x2="16" y2="6"  stroke="black" />
<line x1="24" y1="6" x2="32" y2="6"  stroke="black" />
<line x1="16" y1="-6" x2="16" y2="6"  stroke="black" />
<line x1="24" y1="-6" x2="24" y2="6"  stroke="black" />
`,dimmer:`
<rect x="0" y="-13" width="40" height="26" fill="none" style="stroke:black" />
<line x1="10" y1="5" x2="30" y2="5"  stroke="black" />
<line x1="10" y1="5" x2="10" y2="-5"  stroke="black" />
<line x1="10" y1="-5" x2="30" y2="5"  stroke="black" />
`,relais:`
<rect x="0" y="-13" width="40" height="26" fill="none" style="stroke:black" />
<line x1="10" y1="-13" x2="30" y2="13"  stroke="black" />
`,minuterie:`
<rect x="0" y="-13" width="40" height="26" fill="none" style="stroke:black" />
<text x="20" y="6" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="16">t</text>
`,thermostaat:`
<rect x="0" y="-13" width="40" height="26" fill="none" style="stroke:black" />
<circle cx="20" cy="0" r="8" style="stroke:black;fill:none" />
<line x1="12" y1="0" x2="28" y2="0"  stroke="black" />
`,tijdschakelaar:`
<rect x="0" y="-13" width="40" height="26" fill="none" style="stroke:black" />
<circle cx="11" cy="0" r="8" style="stroke:black;fill:none" />
<line x1="10" y1="0"  x2="17" y2="0"  stroke="black" />
<line x1="11" y1="-6" x2="11" y2="1"  stroke="black" />
<line x1="21" y1="0"  x2="25" y2="0"  stroke="black" />
<line x1="25" y1="0"  x2="31" y2="-5"  stroke="black" />
<line x1="31" y1="0"  x2="36" y2="0"  stroke="black" />
`,tijdschakelaar_klein:`
<circle cx="8" cy="0" r="7" style="stroke:black;fill:none" />
<line x1="7" y1="0"  x2="13" y2="0"  stroke="black" />
<line x1="8" y1="-5" x2="8" y2="1"  stroke="black" />
`,droogkast:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
<circle cx="15" cy="-7.5" r="5" style="stroke:black;fill:none" />
<circle cx="25" cy="-7.5" r="5" style="stroke:black;fill:none" />
<circle cx="20" cy="7.5" r="3" style="stroke:black;fill:black" />
`,omvormer:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
<line x1="0" y1="20" x2="40" y2="-20" stroke="black" />
<use xlink:href="#sinus" x="5" y="-12" />"
<line x1="20" y1="10" x2="35" y2="10" stroke="black" />
<line x1="20" y1="13" x2="35" y2="13" stroke="black" stroke-dasharray="3" />
`,overspanningsbeveiliging:`
<rect x="0" y="-15" width="15" height="30" fill="none" style="stroke:black" />
<line x1="7.5" y1="-18" x2="7.5" y2="-5" stroke="black" />
<line x1="7.5" y1="-5" x2="4.5" y2="-9" stroke="black" />
<line x1="7.5" y1="-5" x2="10.5" y2="-9" stroke="black" />
<line x1="7.5" y1="18" x2="7.5" y2="5" stroke="black" />
<line x1="7.5" y1="5" x2="4.5" y2="9" stroke="black" />
<line x1="7.5" y1="5" x2="10.5" y2="9" stroke="black" />
`,koelkast:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
<use xlink:href="#ster" x="20" y="0" />"
`,kookfornuis:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
<circle cx="10" cy="10" r="3" style="stroke:black;fill:black" />
<circle cx="30" cy="10" r="3" style="stroke:black;fill:black" />
<circle cx="30" cy="-10" r="3" style="stroke:black;fill:black" />
`,microgolf:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
<use xlink:href="#sinus" x="10" y="-10" />"
<use xlink:href="#sinus" x="10" y="0" />"
<use xlink:href="#sinus" x="10" y="10" />"
`,oven:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
<line x1="0" y1="-5" x2="40" y2="-5" stroke="black" />
<circle cx="20" cy="7.5" r="3" style="stroke:black;fill:black" />
`,usblader:`
<rect x="0" y="-15" width="60" height="30" fill="none" style="stroke:black" />
<circle cx="12" cy="-5" r="5" style="stroke:black;fill:none" />
<circle cx="19" cy="-5" r="5" style="stroke:black;fill:none" />
<text x="15" y="8" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="8">AC/DC</text>
<text x="42" y="4" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="11">USB</text>
`,vaatwasmachine:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
<line x1="0" y1="-20" x2="14.34" y2="-5.66" style="stroke:black;fill:none" />
<line x1="40" y1="20" x2="25.66" y2="5.66" style="stroke:black;fill:none" />
<line x1="0" y1="20" x2="14.34" y2="5.66" style="stroke:black;fill:none" />
<line x1="40" y1="-20" x2="25.66" y2="-5.66" style="stroke:black;fill:none" />
<circle cx="20" cy="0" r="8" style="stroke:black;fill:none" />
`,ventilator:`
<rect x="0" y="-15" width="30" height="30" fill="none" style="stroke:black" />
<circle cx="10" cy="0" r="5" style="stroke:black;fill:none" />
<circle cx="20" cy="0" r="5" style="stroke:black;fill:none" />
`,transformator:`
<circle cx="8" cy="0" r="8" style="stroke:black;fill:none" />
<circle cx="20" cy="0" r="8" style="stroke:black;fill:none" />
`,verwarmingstoestel:`
<rect x="0" y="-15" width="50" height="30" fill="url(#VerticalStripe)" style="stroke:black" />
`,verwarmingstoestel_accu:`
<rect x="0" y="-15" width="50" height="30" fill="none" style="stroke:black" />
<rect x="5" y="-10" width="40" height="20" fill="url(#VerticalStripe)" style="stroke:black" />
`,verwarmingstoestel_accu_ventilator:`
<rect x="0" y="-15" width="70" height="30" fill="none" style="stroke:black" />
<rect x="5" y="-10" width="35" height="20" fill="url(#VerticalStripe)" style="stroke:black" />
<circle cx="50" cy="0" r="5" style="stroke:black;fill:none" />
<circle cx="60" cy="0" r="5" style="stroke:black;fill:none" />
`,verbruiker:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
`,wasmachine:`
<rect x="0" y="-20" width="40" height="40" fill="none" style="stroke:black" />
<circle cx="20" cy="0" r="3" style="stroke:black;fill:black" />
<circle cx="20" cy="0" r="15" style="stroke:black;fill:none" />
`,zekering_automatisch:`
<g transform="rotate(-20)">
<line x1="0" y1="-30" x2="0" y2="0"  stroke="black" />
<rect x="-4" y="-30" width="4" height="10" style="fill:black" />
</g>
`,zekering_automatisch_horizontaal:`
<g transform="rotate(-20)">
<line x1="0" y1="0" x2="30" y2="0"  stroke="black" />
<rect x="20" y="-4" height="4" width="10" style="fill:black" />
</g>
`,zekering_smelt:`
<rect x="-4" y="-30" width="8" height="30" style="stroke:black;fill:none" />
<line x1="0" y1="-30" x2="0" y2="0" stroke="black" />
`,zekering_smelt_horizontaal:`
<rect x="0" y="-4" height="8" width="30" style="stroke:black;fill:none" />
<line x1="0" y1="0" x2="30" y2="0" stroke="black" />
`,relais_kring:`
<rect x="-8" y="-30" width="16" height="30" style="stroke:black;fill:none" />
<line x1="8" y1="-22.5" x2="-8" y2="-7.5" stroke="black" />
`,overspanningsbeveiliging_inline:`
-> shift x -7.5  y -15
<rect x="-7.5" y="-30" width="15" height="30" fill="none" style="stroke:black" />
<line x1="0" y1="-30" x2="0" y2="-20" stroke="black" />
<line x1="0" y1="-20" x2="-3" y2="-24" stroke="black" />
<line x1="0" y1="-20" x2="3" y2="-24" stroke="black" />
<line x1="0" y1="0" x2="0" y2="-10" stroke="black" />
<line x1="0" y1="-10" x2="-3" y2="-6" stroke="black" />
<line x1="0" y1="-10" x2="3" y2="-6" stroke="black" />
`,zekering_empty:`
<g transform="rotate(-20)">
<line x1="0" y1="-30" x2="0" y2="0"  stroke="black" />
</g>
`,zekeringscheider:`
<g transform="rotate(-20)">
<line x1="0" y1="-30" x2="0" y2="0"  stroke="black" />
<rect x="-4" y="-23" width="8" height="18" style="fill:none;stroke:black" />
</g>
`,arrow:`
<line x1="0" y1="0" x2="8" y2="0" stroke="black" />
<line x1="8" y1="0" x2="5" y2="-1" stroke="black" />
<line x1="8" y1="0" x2="5" y2="1" stroke="black" />
`,gas_ventilator:`
<polygon points="-6,5.2 0,-5.2 6,5.2" fill="black" stroke="black" />
`,gas_atmosferisch:`
<polygon points="-6,5.2 0,-5.2 6,5.2" fill="white" stroke="black" />
`,bliksem:`
<line x1="0" y1="-5.2" x2="-3" y2="0" stroke="black"/>
<line x1="-3" y1="0" x2="3" y2="0" stroke="black"/>
<line x1="3" y1="0" x2="0" y2="5.2" stroke="black"/>
<line x1="0" y1="5.2" x2="0" y2="2.2" stroke="black"/>
<line x1="0" y1="5.2" x2="2.6" y2="3.7" stroke="black"/>
`,moving_man:`
<g transform="matrix(0.0152987,0,0,0.01530866,0,0)">
<path d="M 710.7,10.1 C 904.8,5.2 908.6,261.4 730.9,278.4 637.5,287.3 566.3,181.5 603.8,90.8 623.4,43.4 668.7,12.9 711.4,10.1 c 1.1,-0.1 2.8,26.1 1.7,26.2 -31.4,2 -74.8,32.1 -89.1,74.7 -26.8,79.9 47,156.6 125.1,139.2 123.9,-27.6 114.1,-218.5 -36.3,-214 -0.7,0 -3.2,-26 -2.1,-26.1 z" id="path4" stroke="black" stroke-width="10" />
<path d="m 545.3,225.9 c -67.8,-5 -133.2,0 -199.7,0 -20.7,13.6 -115,100.7 -121.1,121.1 -5.7,19.1 6.2,31.9 12.1,40.4 60.1,18.3 96.7,-60.4 133.2,-88.8 29.6,0 59.2,0 88.8,0 -59.2,78.9 -190.7,169.9 -58.5,264.3 -27.6,31.6 -55.1,63.2 -82.7,94.8 -46.9,-14.7 -165.6,-41.3 -199.7,-18.2 -7,21 -4.8,32.1 6.1,48.4 34.1,10.3 205.5,53.2 232,36.3 34.3,-37.7 68.6,-75.3 102.9,-113 32.3,27.6 64.6,55.2 96.9,82.7 -1,62.6 -14.6,249.9 24.2,266.3 10.2,3 19.1,0.5 28.2,-2 5.4,-7.4 10.8,-14.8 16.1,-22.2 6.9,-27 0.3,-272.6 -6.1,-282.5 -37.7,-32.9 -75.3,-65.9 -113,-98.9 1.3,-1.3 2.7,-2.7 4,-4 45.7,-48.4 91.5,-96.9 137.2,-145.3 20.2,19.5 40.4,39 60.5,58.5 16.7,35.8 152.2,25.4 179.6,6.1 2,-8.1 4,-16.1 6.1,-24.2 -16,-40.1 -71.7,-31.8 -127.1,-30.3 C 741.8,384.3 590.6,253 545.5,225.7 c -1.7,-1 14.9,-23.3 15.4,-22.4 -2.2,-3.5 126,97.7 134.4,107.4 9.4,9.1 55.2,51.5 82.1,78.4 68.5,-2 122,-6.5 137.2,46.4 4.9,17.1 1.9,37.1 -8.1,50.4 -18.8,25.3 -156,39.1 -197.7,18.2 -20.2,-20.2 -40.4,-40.4 -60.5,-60.5 -18.8,18.2 -37.7,36.3 -56.5,54.5 -16.8,18.2 -33.6,36.3 -50.4,54.5 32.9,28.9 65.9,57.8 98.9,86.8 11.2,17.9 18.9,272.3 8.1,306.7 -4.8,15.2 -19.9,32.9 -34.3,38.3 C 498.3,1028.1 527.8,798.3 529.4,706 505.9,686.5 482.3,667 458.8,647.5 427.9,676.7 402,732.8 362,750.4 333.5,762.9 140.3,728.4 113.8,712.1 100.1,703.6 89.3,686 85.6,667.7 59.7,543.2 281.5,646 321.3,617.4 334.7,601.3 348.2,585.1 361.7,569 266.4,454.2 335.5,414.9 402.1,326.9 c 0,-0.7 0,-1.3 0,-2 -8.1,0 -16.1,0 -24.2,0 -26.3,36.3 -124.9,147 -173.5,64.6 -35.9,-60.8 103.6,-172.2 141.1,-189.8 56.7,-3.8 167.5,-11 215.9,4 0.8,0.7 -14.9,22.6 -16.1,22.2 z" id="path6" stroke="black" stroke-width="10" />
</g>
`};let k=at;const rt=class rt{constructor(){this.kind="default",this.electroItemId=null,this.boxref=null,this.svg="",this.boxlabelref=null,this.adrestype=null,this.adres=null,this.adreslocation="rechts",this.page=1,this.posx=0,this.posy=0,this.sizex=0,this.sizey=0,this.rotate=0,this.scale=globalThis.SITPLANVIEW_DEFAULT_SCALE,this.labelposx=0,this.labelposy=0,this.labelfontsize=11,this.needsViewUpdate=!1,this.visible=!0,this.movable=!0,this.berekenAfbeeldingsRotatieEnSpiegeling=()=>{if(globalThis.structure.properties.legacySchakelaars==!1&&this.isEendraadschemaSymbool()){let s=globalThis.structure.getElectroItemById(this.electroItemId);if(s!=null&&s.props.type=="Schakelaars"&&(s.props.aantal_schakelaars==1||s.props.aantal_schakelaars==null)&&["enkelpolig","dubbelpolig","driepolig","dubbelaansteking","wissel_enkel","wissel_dubbel","kruis_enkel","dimschakelaar","dimschakelaar wissel","rolluikschakelaar"].includes(s.props.type_schakelaar))return[this.rotate,!1]}let e=this.rotate;for(;e<0;)e=e+360;e=e%360;let t=!1;return e>=90&&e<270&&(this.isEDSSymbolAndRotates360degrees()&&(t=!0),this.isEendraadschemaSymbool()&&(e=e+180)),[e,t]},this.id=li("SP_")}setscale(e){this.scale=e,this.needsViewUpdate=!0}getscale(){return this.scale}isEendraadschemaSymbool(){return this.electroItemId!=null?globalThis.structure.getElectroItemById(this.electroItemId)!=null:!1}isEDSSymbolAndRotates360degrees(){if(this.isEendraadschemaSymbool()){let e=globalThis.structure.getElectroItemById(this.electroItemId);if(e!=null){let t=e.getType();return rt.ROTATES_360_DEGREES_TYPES.has(t)}return!1}return!1}setAdres(e,t,s){this.adrestype=e,this.adreslocation=s,this.adrestype==="manueel"?this.adres=t:this.adres=null}setAdresLocation(e){this.adreslocation=e}getAdresType(){return this.adrestype}getAdres(){var t;if(!this.isEendraadschemaSymbool()){if(this.kind==="distanceLine"){const s=this.distanceLine,a=(s==null?void 0:s.distanceCm)!=null?s.distanceCm:(s==null?void 0:s.distanceMeters)!=null?s.distanceMeters*100:null;return a==null||!Number.isFinite(a)?"":`${a} cm`}return""}let e=globalThis.structure.getElectroItemById(this.electroItemId);return e==null?"":this.adrestype==="auto"?e.getReadableAdres():(t=this.adres)!=null?t:""}getAdresLocation(){return this.adreslocation}setElectroItemId(e){this.electroItemId=e}getElectroItemId(){return this.isEendraadschemaSymbool()?this.electroItemId:null}updateElectroItemSVG(e,t=void 0,s=void 0){this.isEendraadschemaSymbool()&&this.svg!==e&&(this.needsViewUpdate=!0,this.svg=e,t!=null&&(this.sizex=t),s!=null&&(this.sizey=s),(t==null||s==null)&&this.getSizeFromString())}getUnscaledSVGifNotElectroItem(){const e=()=>{if(this.svg==null)this.svg="";else{const t=this.svg.indexOf("<svg");t!==-1&&(this.svg=this.svg.substring(t))}};return this.isEendraadschemaSymbool()?"":(e(),this.svg)}getScaledSVG(e=!1){if(this.kind==="distanceLine"&&this.distanceLine){const a=this.distanceLine,r=[`<line x1="${a.x1}" y1="${a.y1}" x2="${a.x2}" y2="${a.y2}" stroke="black" stroke-width="2" vector-effect="non-scaling-stroke" />`,`<circle cx="${a.x1}" cy="${a.y1}" r="3" fill="black" />`,`<circle cx="${a.x2}" cy="${a.y2}" r="3" fill="black" />`].join("");this.svg!==r&&(this.svg=r,this.needsViewUpdate=!0)}if(this.isEendraadschemaSymbool()){let a=globalThis.structure.getElectroItemById(this.electroItemId);a!=null&&a.updateSituationPlanElement(this)}let t="",s="";if(e){t=`x="${this.posx-this.sizex/2*this.scale}" y="${this.posy-this.sizey/2*this.scale}"`;const[a,r]=this.berekenAfbeeldingsRotatieEnSpiegeling();return s=`transform="rotate(${a} ${this.posx} ${this.posy})${r?` scale(-1,1) translate(${-this.posx*2} 0)`:""}"`,`<g ${s}>
                    <svg ${t} width="${this.sizex*this.scale}px" height="${this.sizey*this.scale}px" viewBox="0 0 ${this.sizex} ${this.sizey}">${this.svg}</svg>
                    </g>`}else return`<svg class="svg-icon" width="${this.sizex*this.scale}px" height="${this.sizey*this.scale}px" viewBox="0 0 ${this.sizex} ${this.sizey}">${this.svg}</svg>`}changePage(e){this.page=e}getSizeFromString(){const s=new DOMParser().parseFromString(this.svg,"image/svg+xml").querySelector("svg");s?(this.sizey=parseInt(s.getAttribute("height")),this.sizex=parseInt(s.getAttribute("width"))):console.error("Invalid SVG string")}scaleSelectedBoxToPaperIfNeeded(e,t,s=1){const a=this.sizex,r=this.sizey,n=Math.min(s,e/a,t/r);this.scale=Math.floor(n*1e4)/1e4}importFromFile(e,t){const a=e.target.files[0];if(a){const r=new FileReader;a.name.toLowerCase(),a.type,r.onload=n=>{const o=n.target.result,c=new Image;c.src=o,c.onload=()=>{this.sizex=c.width,this.sizey=c.height,this.svg=`<svg width="${c.width}" height="${c.height}"><image href="${o}" width="${c.width}" height="${c.height}"/></svg>`,t()},c.onerror=()=>{alert("Het formaat van deze file wordt niet ondersteund.")}},r.readAsDataURL(a)}else alert("Geen bestand geselecteerd")}setVars(e){Object.assign(this,e)}toJsonObject(){return{kind:this.kind,distanceLine:this.distanceLine,visible:this.visible,page:this.page,posx:this.posx,posy:this.posy,sizex:this.sizex,sizey:this.sizey,labelposx:this.labelposx,labelposy:this.labelposy,labelfontsize:this.labelfontsize,adrestype:this.adrestype,adres:this.adres,adreslocation:this.adreslocation,rotate:this.rotate,scale:this.scale,movable:this.movable,svg:this.isEendraadschemaSymbool()?"":this.svg,electroItemId:this.electroItemId}}fromJsonObject(e){if(this.kind=e.kind!=null?e.kind:"default",this.distanceLine=e.distanceLine,this.visible=e.visible!=null?!!e.visible:!0,this.kind==="distanceLine"&&this.distanceLine){const t=this.distanceLine;t.distanceCm==null&&t.distanceMeters!=null&&Number.isFinite(t.distanceMeters)&&(t.distanceCm=t.distanceMeters*100)}this.page=e.page,this.posx=e.posx,this.posy=e.posy,this.sizex=e.sizex,this.sizey=e.sizey,this.labelposx=e.labelposx!=null?e.labelposx:this.posx+20,this.labelposy=e.labelposy!=null?e.labelposy:this.posy,this.labelfontsize=e.labelfontsize!=null?e.labelfontsize:11,this.adrestype=e.adrestype!=null?e.adrestype:"manueel",this.adres=e.adres,this.adreslocation=e.adreslocation!=null?e.adreslocation:"rechts",this.rotate=e.rotate!=null?e.rotate:0,this.scale=e.scale!=null?e.scale:globalThis.SITPLANVIEW_DEFAULT_SCALE,this.svg=e.svg,this.electroItemId=e.electroItemId,this.needsViewUpdate=!0,this.movable=e.movable!=null?e.movable:!0}setDistanceLineAbsolute(e,t,s=null){var d;const a=Math.min(e.x,t.x),r=Math.min(e.y,t.y),n=Math.max(e.x,t.x),o=Math.max(e.y,t.y),c=Math.max(1,n-a),l=Math.max(1,o-r);this.kind="distanceLine",this.rotate=0,this.setscale(1),this.sizex=c,this.sizey=l,this.posx=a+c/2,this.posy=r+l/2,this.labelfontsize=(d=this.labelfontsize)!=null?d:11,this.setAdresLocation("boven"),this.distanceLine={x1:e.x-a,y1:e.y-r,x2:t.x-a,y2:t.y-r,distanceCm:s},this.needsViewUpdate=!0}};rt.ROTATES_360_DEGREES_TYPES=new Set(["Contactdoos","Lichtpunt","Drukknop","Media","Schakelaars","Lichtcircuit","Bord","Bel"]);let Se=rt;class B extends ft{constructor(e){super(e),this.resetProps()}getLegacyKey(e,t){return typeof e!="undefined"&&e.length>t?e[t][2]:null}convertLegacyKeys(e){}resetProps(){super.resetProps()}getParent(){return super.getParent()}allowedChilds(){return["","Aansluiting","Domotica","Domotica module (verticaal)","Domotica gestuurde verbruiker","Leiding","Meerdere verbruikers","Splitsing","---","Batterij","Bel","Boiler","Contactdoos","Diepvriezer","Droogkast","Drukknop","Elektriciteitsmeter","Elektrische oven","EV lader","Ketel","Koelkast","Kookfornuis","Lichtcircuit","Lichtpunt","Media","Microgolfoven","Motor","Omvormer","Overspanningsbeveiliging","Schakelaars","Stoomoven","Transformator","USB lader","Vaatwasmachine","Ventilator","Verlenging","Verwarmingstoestel","Verbruiker","Vrije tekst","Warmtepomp/airco","Wasmachine","Zekering/differentieel","Zonnepaneel","---","Aansluitpunt","Aftakdoos","Zeldzame symbolen"]}getNumChildsWithKnownType(){let e=0;if(this.sourcelist!=null)for(let t=0;t<this.sourcelist.data.length;++t)this.sourcelist.data[t].parent===this.id&&this.sourcelist.active[t]&&this.sourcelist.data[t].getType()!=""&&!this.props.isAttribuut&&e++;return e}heeftKindMetGekendType(){return this.getNumChildsWithKnownType()>0}isVrijeTekstZonderKader(){return this.getType()=="Vrije tekst"?this.props.vrije_tekst_type=="zonder kader":!1}isChildOf(e){return this.parent!=0?this.getParent().getType()==e:!1}isAttribuut(){return this.props.isAttribuut}heeftVerbruikerAlsKind(){let e=this.getParent();if(e!=null&&e.getType()=="Meerdere verbruikers"){let t=this.sourcelist.getOrdinalById(this.id);if(t===null)return!1;let s=0;for(let a=0;a<this.sourcelist.data.length;++a)this.sourcelist.active[a]&&!this.sourcelist.data[a].isVrijeTekstZonderKader()&&this.sourcelist.data[a].parent==this.parent&&(s=a);return s>t}else if(this.sourcelist!=null){for(let t=0;t<this.sourcelist.data.length;++t)if(this.sourcelist.data[t].parent===this.id&&this.sourcelist.active[t]&&!this.sourcelist.data[t].isVrijeTekstZonderKader()&&this.sourcelist.data[t].getType()!=""&&this.sourcelist.data[t].getType()!=null)return!0}return!1}clone(e){this.parent=e.parent,this.indent=e.indent,this.collapsed=e.collapsed,this.sourcelist=e.sourcelist,this.props=Be(e.props)}getType(){return this.props.type}clearProps(){let e="auto",t="auto",s="";typeof this.props.autonr!="undefined"&&(e=this.props.autonr),typeof this.props.autoKringNaam!="undefined"&&(t=this.props.autoKringNaam),typeof this.props.nr!="undefined"&&(s=this.props.nr),this.props={},this.props.nr=s,e!==null&&(this.props.autonr=e),t!==null&&(this.props.autoKringNaam=t)}getMaxNumChilds(){let e=this.getParent();if(e==null)return 256;switch(e.getType()){case"Meerdere verbruikers":return 0;default:return 1}}getNumChilds(){let e=0;for(let t=0;t<this.sourcelist.data.length;++t)this.sourcelist.data[t].parent===this.id&&this.sourcelist.active[t]&&!this.sourcelist.data[t].isAttribuut()&&e++;return e}checkInsertChild(){return this.getMaxNumChilds()>this.getNumChilds()}checkInsertSibling(){let e=this.getParent();return e==null?!0:e.getMaxNumChilds()>e.getNumChilds()}toHTMLHeader(e){let t="";e=="move"?(t+="<b>ID: "+this.id+"</b>, ",t+='Moeder: <input id="id_parent_change_'+this.id+'" type="text" size="2" value="'+this.parent+'" onchange="HL_changeparent('+this.id+')"> ',t+=`<button class="button-lightblue" onclick="HLMoveUp(${this.id})">&#9650;</button>`,t+=`<button class="button-lightblue" onclick="HLMoveDown(${this.id})">&#9660;</button>`,this.checkInsertSibling()&&(t+=`<button class="button-lightblue" onclick="HLClone(${this.id})">Clone</button>`)):(this.checkInsertSibling()&&(t+=`<button class="button-insertBefore" onclick="HLInsertBefore(${this.id})"></button>`,t+=`<button class="button-insertAfter" onclick="HLInsertAfter(${this.id})"></button>`),this.checkInsertChild()&&(t+=`<button class="button-insertChild" onclick="HLInsertChild(${this.id})"></button>`)),t+=`<button class="button-delete-garbage-can" onclick="HLDelete(${this.id})"></button>`,t+="&nbsp;";let s=this.getParent(),a;return s==null?a=["","Aansluiting","Zekering/differentieel","Kring"]:a=this.getParent().allowedChilds(),t+=this.selectPropToHTML("type",a,175),t}toHTMLFooter(){return this.isExpandable()?` <button title="Meerdere elementen (bvb schakelaars) omzetten in indivuele elementen" style="background-color:lightblue;" onclick="HLExpand(${this.id})">Uitpakken</button>`:""}toHTML(e){return this.toHTMLHeader(e)}getnr(){let e=this.getParent();if(e!=null)switch(e.getType()){case"Kring":case"Domotica module (verticaal)":return this.props.nr?this.props.nr:"";default:return e.getnr()}else return""}getReadableAdres(){if(this.getType()=="Bord"){let e=this.props.naam;return e==null&&(e=""),e}else{let e=I(this.sourcelist.findKringName(this.id)),t=I(this.getnr());return e==""?t:t==""?e:e+"."+t}}nrToHtml(){var s;typeof this.props.autonr==null&&(this.props.autonr="manueel");let e="",t=this.getParent();return t!=null&&(t.getType()=="Kring"||t.getType()=="Domotica module (verticaal)"?e+=`Nr: ${this.selectPropToHTML("autonr",["auto","manueel"])}`+(this.props.autonr==="auto"?`<input type="text" id="HL_edit_${this.id}_nr" size="2" value="${(s=this.props.nr)!=null?s:""}" disabled />`:this.stringPropToHTML("nr",2))+", ":this.props.nr=""),e}addAddressToSVG(e,t=60,s=15,a=0){let r="";return/^\s*$/.test(this.props.adres)||(r='<text x="'+((e.xright-20)/2+21+a)+'" y="'+t+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10" font-style="italic">'+y(this.props.adres)+"</text>",e.ydown=e.ydown+s),r}toSVG(e=!1,t=!1){return new H}toSituationPlanElement(){return new Se}isExpandable(){return!1}expand(){this.isExpandable()}maxSituationPlanElements(){return 1}getSitPlanBoundaries(){return{clipleft:12,addright:0,cliptop:0,addbottom:0}}updateSituationPlanElement(e){let t=!1,s=e.rotate%360;s>=90&&s<270&&(t=!0),this.props.type=="Schakelaars"&&this.sourcelist.properties.legacySchakelaars==!1&&(this.props.aantal_schakelaars==1||this.props.aantal_schakelaars==null)&&(t=!1),k.clearSymbols();let a=this.toSVG(!0,t),r=a.xright+a.xleft+10,n=a.yup+a.ydown,o=this.getSitPlanBoundaries(),c=r-o.clipleft+o.addright,l=n-o.cliptop+o.addbottom;e.updateElectroItemSVG(`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" transform="scale(1,1)" viewBox="${o.clipleft} ${o.cliptop} ${r-o.clipleft+o.addright} ${n-o.cliptop+o.addbottom}" width="${c}" height="${l}">`+k.getNeededSymbols()+a.data+"</svg>",c,l)}}class pi extends B{convertLegacyKeys(e){switch(this.props.type=this.getLegacyKey(e,0),this.props.aantal_polen=this.getLegacyKey(e,4),this.props.bescherming=this.getLegacyKey(e,7),this.props.amperage=this.getLegacyKey(e,8),this.props.type_kabel_na_teller=this.getLegacyKey(e,9),this.props.nr=this.getLegacyKey(e,10),this.props.differentieel_delta_amperage=this.getLegacyKey(e,11),this.props.adres=this.getLegacyKey(e,15),this.props.differentieel_is_selectief=this.getLegacyKey(e,20),this.props.kortsluitvermogen=this.getLegacyKey(e,22),this.props.naam=this.getLegacyKey(e,23),this.props.type_kabel_voor_teller=this.getLegacyKey(e,24),this.props.huishoudelijk=!0,this.props.fase="",this.props.bescherming){case"differentieel":this.props.type_differentieel=this.getLegacyKey(e,17);break;case"automatisch":this.props.curve_automaat=this.getLegacyKey(e,17);break;case"differentieelautomaat":this.props.type_differentieel=this.getLegacyKey(e,17),this.props.curve_automaat=this.getLegacyKey(e,18);break}}resetProps(){this.clearProps(),this.props.type="Aansluiting",this.props.aantal_polen="2",this.props.bescherming="differentieel",this.props.amperage="40",this.props.type_kabel_na_teller="2x16",this.props.differentieel_delta_amperage="300",this.props.adres="",this.props.type_differentieel="",this.props.curve_automaat="",this.props.differentieel_is_selectief=!1,this.props.kortsluitvermogen="",this.props.naam="",this.props.type_kabel_voor_teller="",this.props.huishoudelijk=!0,this.props.fase="",this.props.normaalGesloten=!1,this.props.newPage=!1}allowedChilds(){return["","Bord","Kring","Splitsing"]}getMaxNumChilds(){return 256}overrideKeys(){if(this.props.curve_automaat==="E"&&(this.props.curve_automaat="U"),this.props.normaalGesloten==null&&(this.props.normaalGesloten=!1),this.props.newPage==null&&(this.props.newPage=!1),this.props.bescherming=="schakelaar"&&(this.props.bescherming="contact"),this.props.aantal_polen!==""&&(this.props.aantal_polen<1||this.props.aantal_polen>4)&&(this.props.aantal_polen="2"),this.props.normaalGesloten===!0&&!["contact","zekeringscheider"].includes(this.props.bescherming)&&(this.props.normaalGesloten=!1),this.getParent()!==null)this.props.newPage=!1;else{let e=this.sourcelist.getFirstChildId(0);e!==null&&this.id===e&&(this.props.newPage=!1)}typeof this.props.huishoudelijk=="undefined"&&(this.props.huishoudelijk=!0),["automatisch","differentieel","differentieelautomaat","smelt"].includes(this.props.bescherming)||(this.props.fase=""),["automatisch","differentieel","differentieelautomaat"].includes(this.props.bescherming)||(this.props.kortsluitvermogen="")}toHTML(e){this.overrideKeys();let t=this.toHTMLHeader(e);if(t+="&nbsp;Naam: "+this.stringPropToHTML("naam",5)+"<br>",this.getParent()!=null){const s=this.nrToHtml();t+=typeof s=="string"?s.substring(2):s}switch(t+="Bescherming: "+this.selectPropToHTML("bescherming",["automatisch","differentieel","differentieelautomaat","smelt","geen","---","contact","zekeringscheider","schemer"]),this.props.bescherming!="geen"&&(t+=this.selectPropToHTML("aantal_polen",["2","3","4","-","1",""])+this.stringPropToHTML("amperage",2)+"A"),this.props.bescherming){case"differentieel":t+=", Δ "+this.stringPropToHTML("differentieel_delta_amperage",3)+"mA, Type:"+this.selectPropToHTML("type_differentieel",["","A","B"])+", Kortsluitstroom: "+this.stringPropToHTML("kortsluitvermogen",3)+"kA, Selectief: "+this.checkboxPropToHTML("differentieel_is_selectief")+", Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break;case"automatisch":t+=", Curve:"+this.selectPropToHTML("curve_automaat",["","B","C","D","U"])+", Kortsluitstroom: "+this.stringPropToHTML("kortsluitvermogen",3)+"kA, Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break;case"differentieelautomaat":t+=", Δ "+this.stringPropToHTML("differentieel_delta_amperage",3)+"mA, Curve:"+this.selectPropToHTML("curve_automaat",["","B","C","D","U"])+", Type:"+this.selectPropToHTML("type_differentieel",["","A","B"])+", Kortsluitstroom: "+this.stringPropToHTML("kortsluitvermogen",3)+"kA, Selectief: "+this.checkboxPropToHTML("differentieel_is_selectief")+", Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break;case"smelt":t+=", Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break;case"contact":case"zekeringscheider":t+=", Normaal Gesloten: "+this.checkboxPropToHTML("normaalGesloten");break}if(t+=", Kabeltype na teller: "+this.stringPropToHTML("type_kabel_na_teller",10)+", Kabeltype v&oacute;&oacute;r teller: "+this.stringPropToHTML("type_kabel_voor_teller",10),this.props.kortsluitvermogen!=""&&["differentieel","automatisch","differentieelautomaat"].includes(this.props.bescherming)&&(t+=", Huishoudelijke installatie: "+this.checkboxPropToHTML("huishoudelijk")),this.getParent()==null){let s=this.sourcelist.getFirstChildId(0);s!==null&&this.id!==s&&(t+=", Start op nieuwe pagina: "+this.checkboxPropToHTML("newPage"))}return t+=", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=(l,d)=>{let h=l;return["L1","L2","L3"].includes(this.props.fase)&&(h=h+(this.props.huishoudelijk&&this.props.kortsluitvermogen!=""?1.3:1),d.data+='<text x="'+(d.xleft+15+11*(h-1))+'" y="'+(d.yup-10)+'" transform="rotate(-90 '+(d.xleft+15+11*(h-1))+","+(d.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.fase)+"</text>"),h};if(e){let l=new H;return k.addSymbol("elektriciteitsmeter"),l.xleft=1,l.xright=59,l.yup=25,l.ydown=25,l.data='<use xlink:href="#elektriciteitsmeter" x="21" y="25"></use>',l}let s=new H;k.addSymbol("zekering_automatisch"),k.addSymbol("zekering_empty"),k.addSymbol("zekering_smelt"),k.addSymbol("zekeringscheider"),k.addSymbol("arrow"),k.addSymbol("elektriciteitsmeter");let a="";this.props.aantal_polen!==""&&(a=`${y(this.props.aantal_polen)}P`);let r="";I(this.props.amperage)!==""&&(r=`${y(this.props.amperage)}A`);let n="";a!==""&&r!==""?n=`${a} - ${r}`:a!==""?n=a:r!==""&&(n=r);let o=0;this.props.type_kabel_voor_teller!=""&&(o+=50),s=this.sourcelist.toSVG(this.id,"vertical",150+o),s.data+='<line x1="'+s.xleft+'" x2="'+s.xleft+'" y1="'+s.yup+'" y2="'+(s.yup+20)+'" stroke="black" />',s.yup+=20;let c=1;switch(this.props.bescherming){case"automatisch":if(c=I(n)!==""?1:0,s.yup+=30,s.data+='<use xlink:href="#zekering_automatisch" x="'+s.xleft+'" y="'+s.yup+'" /><text x="'+(s.xleft+15)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+n+"</text>",(this.props.curve_automaat=="B"||this.props.curve_automaat=="C"||this.props.curve_automaat=="D"||this.props.curve_automaat=="U")&&(++c,s.data+='<text x="'+(s.xleft+15+11*(c-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(c-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Curve "+this.props.curve_automaat)+"</text>"),this.props.kortsluitvermogen!="")if(this.props.huishoudelijk){c=c+1.3,s.data+='<text x="'+(s.xleft+15+11*(c-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(c-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+ie(this.props.kortsluitvermogen)*1e3)+"</text>";let l=ee(y(""+ie(this.props.kortsluitvermogen)*1e3))+6;s.data+='<rect x="'+(s.xleft+15+11*(c-2)+1)+'" y="'+(s.yup-10-l/2)+'" width="'+11*1.2+'" height="'+l+'" fill="none" stroke="black" />'}else c=c+1,s.data+='<text x="'+(s.xleft+15+11*(c-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(c-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+this.props.kortsluitvermogen)+"kA</text>";c=t.bind(this)(c,s),s.xright=Math.max(s.xright,20+11*(c-1));break;case"differentieel":if(this.props.differentieel_is_selectief&&(s.data+='<line x1="'+s.xleft+'" x2="'+s.xleft+'" y1="'+s.yup+'" y2="'+(s.yup+30)+'" stroke="black" /><rect x="'+(s.xleft+7)+'" y="'+s.yup+'" width="16" height="16" stroke="black" fill="white" /><text x="'+(s.xleft+19)+'" y="'+(s.yup+8)+'" transform="rotate(-90 '+(s.xleft+19)+","+(s.yup+8)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">S</text>',s.yup+=23),c=1+(I(n)!==""?1:0),s.yup+=30,s.data+='<use xlink:href="#zekering_automatisch" x="'+s.xleft+'" y="'+s.yup+'" /><text x="'+(s.xleft+15)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">Δ'+y(this.props.differentieel_delta_amperage+"mA")+'</text><text x="'+(s.xleft+26)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+26)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+n+"</text>",(this.props.type_differentieel=="A"||this.props.type_differentieel=="B")&&(++c,s.data+='<text x="'+(s.xleft+15+11*(c-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(c-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Type "+this.props.type_differentieel)+"</text>"),this.props.kortsluitvermogen!="")if(this.props.huishoudelijk){c=c+1.3,s.data+='<text x="'+(s.xleft+15+11*(c-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(c-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+ie(this.props.kortsluitvermogen)*1e3)+"</text>";let l=ee(y(""+ie(this.props.kortsluitvermogen)*1e3))+6;s.data+='<rect x="'+(s.xleft+15+11*(c-2)+1)+'" y="'+(s.yup-10-l/2)+'" width="'+11*1.2+'" height="'+l+'" fill="none" stroke="black" />'}else c=c+1,s.data+='<text x="'+(s.xleft+15+11*(c-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(c-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+this.props.kortsluitvermogen)+"kA</text>";c=t.bind(this)(c,s),s.xright=Math.max(s.xright,20+11*(c-1));break;case"differentieelautomaat":if(this.props.differentieel_is_selectief&&(s.data+='<line x1="'+s.xleft+'" x2="'+s.xleft+'" y1="'+s.yup+'" y2="'+(s.yup+30)+'" stroke="black" /><rect x="'+(s.xleft+7)+'" y="'+s.yup+'" width="16" height="16" stroke="black" fill="white" /><text x="'+(s.xleft+19)+'" y="'+(s.yup+8)+'" transform="rotate(-90 '+(s.xleft+19)+","+(s.yup+8)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">S</text>',s.yup+=23),c=1+(I(n)!==""?1:0),s.yup+=30,s.data+='<use xlink:href="#zekering_automatisch" x="'+s.xleft+'" y="'+s.yup+'" /><text x="'+(s.xleft+15)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">Δ'+y(this.props.differentieel_delta_amperage+"mA")+'</text><text x="'+(s.xleft+26)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+26)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+n+"</text>",(this.props.curve_automaat=="B"||this.props.curve_automaat=="C"||this.props.curve_automaat=="D"||this.props.curve_automaat=="U")&&(++c,s.data+='<text x="'+(s.xleft+15+11*(c-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(c-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Curve "+this.props.curve_automaat)+"</text>"),(this.props.type_differentieel=="A"||this.props.type_differentieel=="B")&&(++c,s.data+='<text x="'+(s.xleft+15+11*(c-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(c-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Type "+this.props.type_differentieel)+"</text>"),this.props.kortsluitvermogen!="")if(this.props.huishoudelijk){c=c+1.3,s.data+='<text x="'+(s.xleft+15+11*(c-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(c-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+ie(this.props.kortsluitvermogen)*1e3)+"</text>";let l=ee(y(""+ie(this.props.kortsluitvermogen)*1e3))+6;s.data+='<rect x="'+(s.xleft+15+11*(c-2)+1)+'" y="'+(s.yup-10-l/2)+'" width="'+11*1.2+'" height="'+l+'" fill="none" stroke="black" />'}else c=c+1,s.data+='<text x="'+(s.xleft+15+11*(c-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(c-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+this.props.kortsluitvermogen)+"kA</text>";c=t.bind(this)(c,s),s.xright=Math.max(s.xright,20+11*(c-1));break;case"contact":case"zekeringscheider":s.yup+=30,s.data+=`<use xlink:href="${this.props.bescherming=="contact"?"#zekering_empty":"#zekeringscheider"}" x="${s.xleft}" y="${s.yup}" /><text x="${s.xleft+15}" y="${s.yup-10}" transform="rotate(-90 ${s.xleft+15},${s.yup-10})" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">${n}</text>`,this.props.normaalGesloten&&(s.data+=`<line x1="${s.xleft}" x2="${s.xleft}" y1="${s.yup-25.5}" y2="${s.yup-30}" stroke="black" /><line x1="${s.xleft-12}" x2="${s.xleft+.5}" y1="${s.yup-25}" y2="${s.yup-25}" stroke="black" />`);break;case"schemer":s.yup+=30,s.data+='<use xlink:href="#zekering_empty" x="'+s.xleft+'" y="'+s.yup+'" /><text x="'+(s.xleft+15)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+n+'</text><use xlink:href="#arrow" x="'+(s.xleft-18)+'" y="'+(s.yup-15)+'" /><use xlink:href="#arrow" x="'+(s.xleft-18)+'" y="'+(s.yup-12)+'" />';break;case"smelt":c=I(n)!==""?1:0,s.yup+=30,s.data+='<use xlink:href="#zekering_smelt" x="'+s.xleft+'" y="'+s.yup+'" /><text x="'+(s.xleft+15)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+n+"</text>",c=t.bind(this)(c,s),s.xright=Math.max(s.xright,20+11*(c-1));break;case"geen":s.yup+=0;break}return s.data+='<line x1="1" y1="'+(s.yup+25)+'" x2="'+(21+o)+'" y2="'+(s.yup+25)+'" stroke="black"></line>',this.props.type_kabel_voor_teller!=""&&(s.data+='<text x="55" y="'+(s.yup+40)+'" style="text-anchor:end" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.type_kabel_voor_teller)+"</text>"),s.data+='<use xlink:href="#elektriciteitsmeter" x="'+(21+o)+'" y="'+(s.yup+25)+'"></use>',s.data+='<line x1="'+(61+o)+'" y1="'+(s.yup+25)+'" x2="'+s.xleft+'" y2="'+(s.yup+25)+'" stroke="black"></line><line x1="'+s.xleft+'" y1="'+s.yup+'" x2="'+s.xleft+'" y2="'+(s.yup+25)+'" stroke="black"></line>',s.data+='<text x="'+(85+o)+'" y="'+(s.yup+40)+'" style="text-anchor:left" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.type_kabel_na_teller)+"</text>",s.yup+=25,s.ydown=25,/^\s*$/.test(this.props.adres)||(s.data+='<text x="'+(41+o)+'" y="'+(s.yup+s.ydown+10)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10" font-style="italic">'+y(this.props.adres)+"</text>",s.ydown+=15),s.data+='<text x="'+(s.xleft+-6)+'" y="'+(s.yup-10)+'" style="text-anchor:end" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="12">'+y(this.props.naam)+"</text>",s.xright=s.xright+s.xleft-1,s.xleft=1,this.props.newPage&&(s.data=`<svg newPage="true" x="0" y="0" width="${s.xleft+s.xright}" height="${s.yup+s.ydown}">`+s.data+"</svg>"),s}}class ui extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Aansluitpunt",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("aansluitpunt"),t.xleft=1,t.xright=29,t.yup=25,t.ydown=25,t.data+=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#aansluitpunt" x="21" y="25"></use>',t.data+=e?"":this.addAddressToSVG(t,45,0),t}}class gi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Aardingsonderbreker",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("aardingsonderbreker"),t.xleft=1,t.xright=59,t.yup=10,t.ydown=10,t.data='<use xlink:href="#aardingsonderbreker" x="21" y="10"></use>',t.data+=e?"":this.addAddressToSVG(t,60,15),t}}class Gt extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Aftakdoos",this.props.adres=""}allowedChilds(){return["","Aansluiting","Domotica","Domotica module (verticaal)","Domotica gestuurde verbruiker","Leiding","Meerdere verbruikers","Splitsing","---","Batterij","Bel","Boiler","Contactdoos","Diepvriezer","Droogkast","Drukknop","Elektriciteitsmeter","Elektrische oven","EV lader","Ketel","Koelkast","Kookfornuis","Lichtcircuit","Lichtpunt","Media","Microgolfoven","Motor","Omvormer","Overspanningsbeveiliging","Schakelaars","Stoomoven","Transformator","USB lader","Vaatwasmachine","Ventilator","Verlenging","Verwarmingstoestel","Verbruiker","Vrije tekst","Warmtepomp/airco","Wasmachine","Zekering/differentieel","Zonnepaneel","---","Aansluitpunt","Aftakdoos","Zeldzame symbolen"]}getMaxNumChilds(){return 256}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;if(e)return k.addSymbol("aftakdoos"),t.yup=25,t.ydown=25,t.xleft=1,t.xright=49,t.data+='<use xlink:href="#aftakdoos" x="21" y="25"></use>',t;k.addSymbol("aftakdoos"),t=this.sourcelist.toSVG(this.id,"vertical");let s=Math.max(t.yup+t.ydown,50);t.yup=s/2,t.ydown=t.yup,t.firstChildydown=null,t.lastChildyup=null;let a=0;this.getNumChilds(),s>150?a=20:s>100&&(a=10),t.data=`<svg x="${50+a}" y="0">${t.data}</svg>`,t.xleft=1,t.xright+=50+a;for(let r=0;r<t.connectorPos.length;r++){if(t.connectorPos[r]==null)continue;let n={x:36,y:t.yup},o={x:51+a,y:s-t.connectorPos[r]},l=15/Math.sqrt(Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2));t.data+=`<line x1="${n.x+l*(o.x-n.x)}" y1="${n.y+l*(o.y-n.y)}" x2="${o.x}" y2="${o.y}" stroke="black" stroke-linecap="round"></line>`}if(t.data+=`<line x1="1" y1="${t.yup}" x2="21" y2="${t.yup}" stroke="black"></line><use xlink:href="#aftakdoos" x="21" y="${t.yup}"></use>`,!/^\s*$/.test(this.props.adres)){const n=s/2+30,o=10,c=2,d=ee(y(this.props.adres),o,"")+c*2,h=o+c*2;t.data+=`<rect x="${35-d/2}" y="${n-h/2-4}" width="${d}" height="${h}" fill="white" />`,t.data+='<text x="35" y="'+n+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+this.props.adres+"</text>",t.ydown=Math.max(t.ydown,40)}return t}}class fi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Batterij",this.props.adres="",this.props.symbool="standaard"}overrideKeys(){this.props.symbool==null&&(this.props.symbool="standaard")}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Symbool: "+this.selectPropToHTML("symbool",["standaard","blokbatterij"]),t+=", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;switch(t.xleft=1,t.yup=25,t.ydown=25,this.props.symbool){case"standaard":k.addSymbol("batterij_nieuw"),t.xright=49,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#batterij_nieuw" x="21" y="25"></use>';break;default:k.addSymbol("batterij"),t.xright=59,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#batterij" x="21" y="25"></use>'}return t.data+=e?"":this.addAddressToSVG(t,55,10),t}}class mi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Bel",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(){let e=new H;return k.addSymbol("bel"),e.xleft=1,e.xright=40,e.yup=25,e.ydown=25,e.data='<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line><use xlink:href="#bel" x="21" y="25"></use>',e.data+=this.addAddressToSVG(e,60,15),e}getSitPlanBoundaries(){return{clipleft:0,addright:0,cliptop:0,addbottom:0}}}class yi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.heeft_accumulatie=this.getLegacyKey(e,3),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Boiler",this.props.heeft_accumulatie=!1,this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Accumulatie: "+this.checkboxPropToHTML("heeft_accumulatie"),t+=", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;switch(t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,t.data=e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>',this.props.heeft_accumulatie){case!1:k.addSymbol("VerticalStripe"),k.addSymbol("boiler"),t.data+='<use xlink:href="#boiler" x="21" y="25"></use>';break;case!0:k.addSymbol("VerticalStripe"),k.addSymbol("boiler_accu"),t.data+='<use xlink:href="#boiler_accu" x="21" y="25"></use>';break}return t.data+=e?"":this.addAddressToSVG(t,60),t}}class yt extends B{erBestaatEenBordUpstream(){let e=this.getParent();for(;e!=null&&e.id!=0;){if(e.props.type==="Bord")return!0;e=e.getParent()}return!1}convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.is_geaard=this.getLegacyKey(e,1),this.props.naam=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Bord",this.erBestaatEenBordUpstream()?this.props.is_geaard=!1:this.props.is_geaard=!0,this.props.naam="",this.props.adres=""}allowedChilds(){return["","Kring","Vrije ruimte"]}getMaxNumChilds(){return 256}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;Naam: "+this.stringPropToHTML("naam",5)+", Geaard: "+this.checkboxPropToHTML("is_geaard"),t}toSitPlanSVG(e=!1){let t=60,s=(t-60)/2,a=new H;a.xleft=0,a.xright=31,a.yup=0,a.ydown=t,a.data+=`<rect y="5" x="8" height="${t-10}" width="24" stroke="black" stroke-width="1" fill="none" />`,a.data+=`<line y1="${t/2}" x1="0" y2="${t/2}" x2="8" stroke="black" stroke-width="1" />`;for(let r=0;r<5;r++)a.data+=`<line y1="${10+s+r*10}" x1="32" y2="${10+s+r*10}" x2="40" stroke="black" stroke-width="1" />`;return a}toSVG(e=!1,t=!1){let s;if(e)return this.toSitPlanSVG(t);s=this.sourcelist.toSVG(this.id,"horizontal"),s.yup==0&&(s.yup=2),s.xright+=10;let a=Math.max(30,ee(y(this.props.naam),10,'font-weight="bold"')+13),r=a+(this.props.is_geaard?70:0);if(this.isChildOf("Aansluiting")){let n=145;this.getParent().props.type_kabel_voor_teller!=""&&(n=n+50);let o=Math.max(0,n-r);a=a+o,r=r+o}if(s.xleft<=r&&(s.xright=s.xleft+s.xright-r,s.xleft=r),s.xright<=10&&(s.xright=10),s.ydown=Math.max(s.ydown,1),s.data+='<line x1="4" x2="'+(s.xleft+s.xright-6)+'" y1="'+s.yup+'" y2="'+s.yup+'" stroke="black" stroke-width="3" />',this.isChildOf("Kring")){const n=this.getParent();n!==null&&n.getNumChilds()>1&&(s.ydown+=10,s.data+=`<line x1="${s.xleft}" x2="${s.xleft}" y1="${s.yup+1}" y2="${s.yup+11}" stroke="black" stroke-width="1" />`)}return this.props.naam!==""&&(s.data+='<text x="5" y="'+(s.yup+13)+'" style="text-anchor:start" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="10">'+y(this.props.naam)+"</text>"),this.props.is_geaard&&(s.data+='<line x1="'+(a+10)+'" y1="'+(s.yup+0)+'" x2="'+(a+10)+'" y2="'+(s.yup+10)+'" stroke="black" /><line x1="'+(a+10)+'" y1="'+(s.yup+15)+'" x2="'+(a+10)+'" y2="'+(s.yup+25)+'" stroke="black" /><line x1="'+(a+10)+'" y1="'+(s.yup+30)+'" x2="'+(a+10)+'" y2="'+(s.yup+40)+'" stroke="black" /><line x1="'+(a+5)+'" y1="'+(s.yup+10)+'" x2="'+(a+15)+'" y2="'+(s.yup+10)+'" stroke="black" /><line x1="'+(a+5)+'" y1="'+(s.yup+15)+'" x2="'+(a+15)+'" y2="'+(s.yup+15)+'" stroke="black" /><line x1="'+(a+5)+'" y1="'+(s.yup+25)+'" x2="'+(a+15)+'" y2="'+(s.yup+25)+'" stroke="black" /><line x1="'+(a+5)+'" y1="'+(s.yup+30)+'" x2="'+(a+15)+'" y2="'+(s.yup+30)+'" stroke="black" /><line x1="'+(a+0)+'" y1="'+(s.yup+40)+'" x2="'+(a+20)+'" y2="'+(s.yup+40)+'" stroke="black" /><line x1="'+(a+2.5)+'" y1="'+(s.yup+43)+'" x2="'+(a+17.5)+'" y2="'+(s.yup+43)+'" stroke="black" /><line x1="'+(a+5)+'" y1="'+(s.yup+46)+'" x2="'+(a+15)+'" y2="'+(s.yup+46)+'" stroke="black" />'),s}getSitPlanBoundaries(){return{clipleft:0,addright:0,cliptop:0,addbottom:0}}}class bi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.is_geaard=this.getLegacyKey(e,1),this.props.is_kinderveilig=this.getLegacyKey(e,2),this.props.aantal=this.getLegacyKey(e,4),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15),this.props.aantal_fases_indien_meerfasig=this.getLegacyKey(e,16),this.props.heeft_ingebouwde_schakelaar=this.getLegacyKey(e,19),this.props.is_halfwaterdicht=this.getLegacyKey(e,20),this.props.is_meerfasig=this.getLegacyKey(e,21),this.props.heeft_nul_indien_meerfasig=this.getLegacyKey(e,25),this.props.in_verdeelbord=this.getLegacyKey(e,26)}resetProps(){this.clearProps(),this.props.type="Contactdoos",this.props.is_geaard=!0,this.props.is_kinderveilig=!0,this.props.aantal="1",this.props.adres="",this.props.aantal_fases_indien_meerfasig="3",this.props.heeft_ingebouwde_schakelaar=!1,this.props.is_halfwaterdicht=!1,this.props.is_meerfasig=!1,this.props.heeft_nul_indien_meerfasig=!1,this.props.in_verdeelbord=!1}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Geaard: "+this.checkboxPropToHTML("is_geaard")+", Kinderveiligheid: "+this.checkboxPropToHTML("is_kinderveilig")+" Halfwaterdicht: "+this.checkboxPropToHTML("is_halfwaterdicht")+", Meerfasig: "+this.checkboxPropToHTML("is_meerfasig")+", ",this.props.is_meerfasig&&(t+="Aantal fasen: "+this.selectPropToHTML("aantal_fases_indien_meerfasig",["1","2","3"])+", Met nul: "+this.checkboxPropToHTML("heeft_nul_indien_meerfasig")+", "),t+="Ingebouwde schakelaar: "+this.checkboxPropToHTML("heeft_ingebouwde_schakelaar")+", Aantal: "+this.selectPropToHTML("aantal",["1","2","3","4","5","6"])+", In verdeelbord: "+this.checkboxPropToHTML("in_verdeelbord")+", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1,t=!1){let s=new H;k.addSymbol("contactdoos"),k.addSymbol("contactdoos_aarding"),k.addSymbol("contactdoos_kinderveilig"),s.xleft=1,s.xright=20,s.yup=25,s.ydown=25;var a=1;if(this.props.is_meerfasig){switch(s.data+='<line x1="1" y1="25" x2="35" y2="25" stroke="black" />',this.props.aantal_fases_indien_meerfasig){case"1":s.data+='<line x1="21" y1="35" x2="27" y2="15" stroke="black" />';break;case"2":s.data+='<line x1="16.5" y1="35" x2="22.5" y2="15" stroke="black" /><line x1="22.5" y1="35" x2="28.5" y2="15" stroke="black" />';break;case"3":s.data+='<line x1="15" y1="35" x2="21" y2="15" stroke="black" /><line x1="21" y1="35" x2="27" y2="15" stroke="black" /><line x1="27" y1="35" x2="33" y2="15" stroke="black" />';break;default:s.data+='<line x1="21" y1="35" x2="27" y2="15" stroke="black" />';break}this.props.heeft_nul_indien_meerfasig&&(s.data+='<line x1="39" y1="35" x2="45" y2="15" stroke="black" /><circle cx="39" cy="35" r="2" fill="black" stroke="black" />'),a+=34,s.xright+=34}this.props.heeft_ingebouwde_schakelaar&&(s.data+='<line x1="'+(a+0)+'" y1="25" x2="'+(a+11)+'" y2="25" stroke="black" /><line x1="'+(a+30)+'" y1="25" x2="'+(a+20)+'" y2="5" stroke="black" /><line x1="'+(a+20)+'" y1="5" x2="'+(a+15)+'" y2="7.5" stroke="black" /><line x1="'+(a+22)+'" y1="9" x2="'+(a+17)+'" y2="11.5" stroke="black" />',a+=10,s.xright+=10);for(let r=0;r<this.props.aantal;++r)s.data+='<use xlink:href="#contactdoos" x="'+a+'" y="25"></use>',this.props.is_geaard&&(s.data+='<use xlink:href="#contactdoos_aarding" x="'+a+'" y="25"></use>'),this.props.is_kinderveilig&&(s.data+='<use xlink:href="#contactdoos_kinderveilig" x="'+a+'" y="25"></use>'),a+=20,s.xright+=20;if(this.props.is_halfwaterdicht){let r=25+this.props.heeft_ingebouwde_schakelaar*10+this.props.is_meerfasig*34,n='text-anchor:middle" font-family="Arial, Helvetica, sans-serif';if(t==!1?s.data+='<text x="'+ +r+'" y="8" style="'+n+'" font-size="10">h</text>':s.data+='<text transform="scale(-1,1) translate('+-r*2+',0)" x="'+ +r+'" y="8" style="'+n+'" font-size="10">h</text>',this.props.in_verdeelbord){let o={x:s.xright-this.props.aantal*20-3-this.props.heeft_ingebouwde_schakelaar*12,y:3},c={width:this.props.aantal*20+6+this.props.heeft_ingebouwde_schakelaar*12,height:44};s.data+=`<line x1="${o.x}" y1="${o.y}" x2="${o.x}" y2="${o.y+c.height}" style="stroke:black" /><line x1="${o.x}" y1="${o.y+c.height}" x2="${o.x+c.width}" y2="${o.y+c.height}" style="stroke:black" /><line x1="${o.x+c.width}" y1="${o.y}" x2="${o.x+c.width}" y2="${o.y+c.height}" style="stroke:black" /><line x1="${o.x}" y1="${o.y}" x2="${r-3}" y2="${o.y}" style="stroke:black" /><line x1="${r+3}" y1="${o.y}" x2="${o.x+c.width}" y2="${o.y}" style="stroke:black" /><line x1="${17+(s.xright-20+3)}" y1="3" x2="${17+(s.xright-20+3)}" y2="47" fill="none" style="stroke:black" />`}}else this.props.in_verdeelbord&&(s.data+='<rect x="'+(s.xright-this.props.aantal*20-3-this.props.heeft_ingebouwde_schakelaar*12)+'" y="3" width="'+(this.props.aantal*20+6+this.props.heeft_ingebouwde_schakelaar*12)+'" height="44" fill="none" style="stroke:black" /><line x1="'+(17+(s.xright-20+3))+'" y1="3" x2="'+(17+(s.xright-20+3))+'" y2="47" fill="none" style="stroke:black" />');return this.heeftVerbruikerAlsKind()&&!e&&(s.data+='<line x1="'+a+'" y1="25" x2="'+(a+21)+'" y2="25" stroke="black" />'),s.data+=e?"":this.addAddressToSVG(s,60,15),s}getSitPlanBoundaries(){return{clipleft:0,addright:0,cliptop:0,addbottom:0}}}class Qe extends B{convertLegacyKeys(e){}resetProps(){this.clearProps(),this.props.type="Container"}toHTML(e){return""}toSVG(e=!1){let t=new H;return t.xleft=0,t.xright=0,t.yup=0,t.ydown=0,t.data="",t}}class ki extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Diepvriezer",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("ster"),k.addSymbol("diepvriezer"),t.xleft=1,t.xright=60,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#diepvriezer" x="21" y="25"></use>',t.data+=e?"":this.addAddressToSVG(t,60,15),t}}class xi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.tekst=this.getLegacyKey(e,15),this.props.adres=this.getLegacyKey(e,23)}resetProps(){this.clearProps(),this.props.type="Domotica",this.props.tekst="Domotica",this.props.adres="",this.props.nr=""}allowedChilds(){return["","Kring"]}getMaxNumChilds(){return 256}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+'Tekst (nieuwe lijn = "|"): '+this.stringPropToHTML("tekst",30)+", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(){let e;var t=y(this.props.tekst).split("|");e=this.sourcelist.toSVG(this.id,"horizontal");let s=80;for(let o of t)s=Math.max(s,ee(y(o),10,'font-weight="bold"')+15);s+=20,e.xright+e.xleft<=s&&(e.xright=s-e.xleft);let a=15*Math.max(t.length-2,0);e.yup=Math.max(e.yup+20,25)+a/2,e.ydown=Math.max(e.ydown,25)+a/2;let r=e.xleft+e.xright-20;e.data+='<rect x="20" width="'+r+'" y="'+(e.yup-20-a/2)+'" height="'+(40+a)+'" stroke="black" stroke-width="2" fill="white" />',e.data+='<line x1="1" x2="20" y1="'+e.yup+'" y2="'+e.yup+'" stroke="black" />';let n='<text style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10" font-weight="bold" ';for(let o=0;o<t.length;o++){let c=e.yup+3-a/2-(t.length>1?7.5:0)+15*o;e.data+=n+' x="'+(21+r/2)+'" y="'+c+'">'+t[o]+"</text>"}return e.xright=e.xleft+e.xright-1,e.xleft=1,/^\s*$/.test(this.props.adres)||(e.data+='<text x="'+((e.xright-20)/2+21)+'" y="'+(e.yup+e.ydown+10)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10" font-style="italic">'+y(this.props.adres)+"</text>",e.ydown+=15),e}}class wi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.type_externe_sturing=this.getLegacyKey(e,5),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15),this.props.is_draadloos=this.getLegacyKey(e,19),this.props.heeft_lokale_drukknop=this.getLegacyKey(e,20),this.props.is_geprogrammeerd=this.getLegacyKey(e,21),this.props.heeft_detectie=this.getLegacyKey(e,25),this.props.heeft_externe_sturing=this.getLegacyKey(e,26)}resetProps(){this.clearProps(),this.props.type="Domotica gestuurde verbruiker",this.props.type_externe_sturing="drukknop",this.props.adres="",this.props.is_draadloos=!0,this.props.heeft_lokale_drukknop=!0,this.props.is_geprogrammeerd=!0,this.props.heeft_detectie=!1,this.props.heeft_externe_sturing=!1}allowedChilds(){return["","Batterij","Bel","Boiler","Contactdoos","Diepvriezer","Droogkast","Drukknop","Elektrische oven","EV lader","Ketel","Koelkast","Kookfornuis","Lichtcircuit","Lichtpunt","Media","Microgolfoven","Motor","Omvormer","Overspanningsbeveiliging","Schakelaars","Stoomoven","Transformator","USB lader","Vaatwasmachine","Ventilator","Verlenging","Verwarmingstoestel","Verbruiker","Vrije tekst","Warmtepomp/airco","Wasmachine","Zonnepaneel","---","Aansluitpunt","Aftakdoos","Zeldzame symbolen"]}getMaxNumChilds(){return 1}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Draadloos: "+this.checkboxPropToHTML("is_draadloos")+", Lokale Drukknop: "+this.checkboxPropToHTML("heeft_lokale_drukknop")+", Geprogrammeerd: "+this.checkboxPropToHTML("is_geprogrammeerd")+", Detectie: "+this.checkboxPropToHTML("heeft_detectie")+", Externe sturing: "+this.checkboxPropToHTML("heeft_externe_sturing"),this.props.heeft_externe_sturing&&(t+=", Externe sturing: "+this.selectPropToHTML("type_externe_sturing",["drukknop","schakelaar"])),t+=", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;k.addSymbol("draadloos_klein"),k.addSymbol("drukknop_klein"),k.addSymbol("tijdschakelaar_klein"),k.addSymbol("detectie_klein"),k.addSymbol("schakelaar_klein");let s=0;for(let a=0;a<this.sourcelist.length;a++)if(this.isActief()&&this.sourcelist.data[a].parent==this.id&&!this.sourcelist.data[a].isAttribuut())switch(s++,s){case 1:t=this.sourcelist.toSVG(this.sourcelist.data[a].id,"horizontal",35,!0);break}if(t.yup+t.ydown<50&&(t.yup=25,t.ydown=25),t.xleft+t.xright<56&&(t.xleft=1,t.xright=55),t.data='<svg x="26" y="25">'+t.data+"</svg>",t.data+='<rect x="21" y="5" width="'+(t.xleft+t.xright+12)+'" height="'+(t.yup+t.ydown+20)+'" stroke="black" fill="none" />',t.data+='<line x1="21" x2="'+(21+t.xleft+t.xright+12)+'" y1="25" y2="25" stroke="black" />',t.xright+=33,t.yup+=25,t.ydown+=5,t.data+='<line x1="'+t.xleft+'" x2="'+(t.xleft+20)+'" y1="'+t.yup+'" y2="'+t.yup+'" stroke="black" />',this.props.is_draadloos&&(t.data+='<use xlink:href="#draadloos_klein" x="22" y="15"></use>'),this.props.heeft_lokale_drukknop&&(t.data+='<use xlink:href="#drukknop_klein" x="38" y="15"></use>'),this.props.is_geprogrammeerd&&(t.data+='<use xlink:href="#tijdschakelaar_klein" x="54" y="15"></use>'),this.props.heeft_detectie&&(t.data+='<use xlink:href="#detectie_klein" x="70" y="15"></use>'),this.props.heeft_externe_sturing)switch(this.props.type_externe_sturing){case"schakelaar":t.data='<svg x="0" y="20">'+t.data+'</svg><use xlink:href="#schakelaar_klein" x="78" y="18"></use><line x1="78" y1="21" x2="78" y2="25" stroke="black" />',t.yup+=20;break;case"drukknop":default:t.data='<svg x="0" y="20">'+t.data+'</svg><use xlink:href="#drukknop_klein" x="70" y="14"></use><line x1="78" y1="21" x2="78" y2="25" stroke="black" />',t.yup+=20}return e==!1&&(/^\s*$/.test(this.props.adres)||(t.data+='<text x="'+((t.xright-20)/2+21+0)+'" y="'+(t.ydown+t.yup+10)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10" font-style="italic">'+y(this.props.adres)+"</text>",t.ydown+=15)),t}}class vi extends B{convertLegacyKeys(e){}resetProps(){this.clearProps(),this.props.type="Domotica module (verticaal)",this.props.nr="",this.props.tekst="Domotica"}allowedChilds(){return["","Aansluiting","Domotica","Domotica module (verticaal)","Domotica gestuurde verbruiker","Leiding","Meerdere verbruikers","Splitsing","---","Batterij","Bel","Boiler","Contactdoos","Diepvriezer","Droogkast","Drukknop","Elektriciteitsmeter","Elektrische oven","EV lader","Ketel","Koelkast","Kookfornuis","Lichtcircuit","Lichtpunt","Media","Microgolfoven","Motor","Omvormer","Overspanningsbeveiliging","Schakelaars","Stoomoven","Transformator","USB lader","Vaatwasmachine","Ventilator","Verlenging","Verwarmingstoestel","Verbruiker","Vrije tekst","Warmtepomp/airco","Wasmachine","Zekering/differentieel","Zonnepaneel","---","Aansluitpunt","Aftakdoos","Zeldzame symbolen"]}getMaxNumChilds(){return 256}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Tekst: "+this.stringPropToHTML("tekst",10),t}toSVG(){let e=new H;e=this.sourcelist.toSVG(this.id,"vertical");let t=e.yup+e.ydown,s=t;return s<50&&(s=50),s=Math.max(s,ee(y(this.props.tekst),10,'font-weight="bold"')+25),e.yup=s/2,e.ydown=e.yup,e.data='<svg x="60" y="'+(s-t)+'">'+e.data+"</svg>",e.xleft=1,e.xright+=60,e.data+='<rect x="21" width="40" y="5" height="'+(s-10)+'" stroke="black" stroke-width="2" fill="white" />',e.data+='<line x1="1" x2="21" y1="'+e.yup+'" y2="'+e.yup+'" stroke="black" />',e.data+='<text x="44" y="'+e.yup+'" transform="rotate(90 44,'+e.yup+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="10">'+y(this.props.tekst)+"</text>",e}}class _i extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Droogkast",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("droogkast"),t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#droogkast" x="21" y="25"></use>',t.data+=e?"":this.addAddressToSVG(t,60,15),t}}class Ft extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.aantal=this.getLegacyKey(e,4),this.props.nr=this.getLegacyKey(e,10),this.props.aantal_knoppen_per_armatuur=this.getLegacyKey(e,13),this.props.adres=this.getLegacyKey(e,15),this.props.type_knop=this.getLegacyKey(e,16),this.props.is_afgeschermd=this.getLegacyKey(e,19),this.props.is_halfwaterdicht=this.getLegacyKey(e,20),this.props.heeft_verklikkerlampje=this.getLegacyKey(e,21)}resetProps(){this.clearProps(),this.props.type="Drukknop",this.props.aantal="1",this.props.aantal_knoppen_per_armatuur="1",this.props.adres="",this.props.type_knop="standaard",this.props.is_afgeschermd=!1,this.props.is_halfwaterdicht=!1,this.props.heeft_verklikkerlampje=!1}maxSituationPlanElements(){return this.props.aantal}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Type: "+this.selectPropToHTML("type_knop",["standaard","dimmer","rolluik"])+", Verklikkerlampje: "+this.checkboxPropToHTML("heeft_verklikkerlampje")+", Halfwaterdicht: "+this.checkboxPropToHTML("is_halfwaterdicht")+", Afgeschermd: "+this.checkboxPropToHTML("is_afgeschermd")+", Aantal armaturen: "+this.selectPropToHTML("aantal",["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"])+", Aantal knoppen per armatuur: "+this.selectPropToHTML("aantal_knoppen_per_armatuur",["1","2","3","4","5","6","7","8"])+", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1,t=!1){let s=new H;k.addSymbol("drukknop"),s.xleft=1,s.xright=43,s.yup=25,s.ydown=25;var a=this.props.aantal;s.data+=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#drukknop" x="21" y="25"></use>',this.props.heeft_verklikkerlampje&&(s.data+='<line x1="28" y1="20" x2="38" y2="30" stroke="black"></line><line x1="28" y1="30" x2="38" y2="20" stroke="black"></line>'),this.props.is_afgeschermd&&(s.data+='<line x1="26" y1="10" x2="40" y2="10" stroke="black"></line><line x1="26" y1="10" x2="26" y2="15" stroke="black"></line><line x1="40" y1="10" x2="40" y2="15" stroke="black"></line><line x1="22" y1="15" x2="26" y2="15" stroke="black"></line><line x1="40" y1="15" x2="44" y2="15" stroke="black"></line>');var r="";if(this.props.is_halfwaterdicht&&(r+="h"),a>1&&!e&&(r!=""&&(r+=", "),r+="x"+a),r!=""){let n='style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10"';t==!1?s.data+='<text x="33" y="49" '+n+">"+y(r)+"</text>":s.data+='<text transform="scale(-1,1) translate(-66,0)" x="33" y="49" '+n+">"+y(r)+"</text>"}if(this.props.aantal_knoppen_per_armatuur>1){let n='style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10"';t==!1?s.data+='<text x="44" y="13" '+n+">"+y(this.props.aantal_knoppen_per_armatuur)+"</text>":s.data+='<text transform="scale(-1,1) translate(-88,0)" x="44" y="13" '+n+">"+y(this.props.aantal_knoppen_per_armatuur)+"</text>",s.data+='<line x1="39" y1="19" x2="44" y2="14" stroke="black" />'}switch(this.props.type_knop){case"dimmer":s.data+='<polygon points="18,20 18,13 28,20" fill="black" stroke="black" />';break;case"rolluik":s.data+='<polygon points="18,12 22,12 20,9" fill="black" stroke="black" /><polygon points="18,15 22,15 20,18" fill="black" stroke="black" />';break}return r!=""?s.data+=e?"":this.addAddressToSVG(s,65,20):s.data+=e?"":this.addAddressToSVG(s,49,5),s}}class Ti extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Elektriciteitsmeter",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("elektriciteitsmeter"),t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#elektriciteitsmeter" x="21" y="25"></use>',t.data+=e?"":this.addAddressToSVG(t,60,15),t}}class Si extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Elektrische oven",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("oven"),t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#oven" x="21" y="25"></use>',t.data+=e?"":this.addAddressToSVG(t,60,15),t}}class Li extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="EV lader",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("EVlader"),t.xleft=1,t.xright=60,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#EVlader" x="21" y="25"></use>',t.data+=e?"":this.addAddressToSVG(t,60,15),t}}class Ei extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.aantal=this.getLegacyKey(e,4),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15),this.props.keteltype=this.getLegacyKey(e,16),this.props.energiebron=this.getLegacyKey(e,17),this.props.warmtefunctie=this.getLegacyKey(e,18)}resetProps(){this.clearProps(),this.props.type="Ketel",this.props.aantal="1",this.props.adres="",this.props.keteltype="",this.props.energiebron="",this.props.warmtefunctie=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Type: "+this.selectPropToHTML("keteltype",["","Met boiler","Met tapspiraal","Warmtekrachtkoppeling","Warmtewisselaar"]),t+=", Energiebron: "+this.selectPropToHTML("energiebron",["","Elektriciteit","Gas (atmosferisch)","Gas (ventilator)","Vaste brandstof","Vloeibare brandstof"]),t+=", Warmte functie: "+this.selectPropToHTML("warmtefunctie",["","Koelend","Verwarmend","Verwarmend en koelend"]),t+=", Aantal: "+this.selectPropToHTML("aantal",["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"]),t+=", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;k.addSymbol("verbruiker"),k.addSymbol("gas_ventilator"),k.addSymbol("gas_atmosferisch"),k.addSymbol("bliksem");var s=0;switch(this.props.aantal>1&&(s=15,t.data+='<text x="41" y="12" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">x'+y(this.props.aantal)+"</text>"),t.xleft=1,t.xright=59,t.yup=25+s,t.ydown=25,t.data+=(e?"":'<line x1="1" y1="'+(s+25)+'" x2="21" y2="'+(s+25)+'" stroke="black"></line>')+'<use xlink:href="#verbruiker" x="21" y="'+(s+25)+'"></use>',this.props.keteltype){case"Met tapspiraal":t.data+='<line x1="21" y1="'+(s+15)+'" x2="61" y2="'+(s+7)+'" stroke="black" /><line x1="21" y1="'+(s+15)+'" x2="61" y2="'+(s+23)+'" stroke="black" />';break;case"Met boiler":t.data+='<rect x="31" y="'+(s+10)+'" width="20" height="10" stroke="black" fill="white" />';break;case"Warmtewisselaar":t.data+='<line x1="26" y1="'+(s+0)+'" x2="26" y2="'+(s+5)+'" stroke="black" /><line x1="56" y1="'+(s+0)+'" x2="56" y2="'+(s+5)+'" stroke="black" /><line x1="26" y1="'+(s+5)+'" x2="33.5" y2="'+(s+23)+'" stroke="black" /><line x1="56" y1="'+(s+5)+'" x2="48.5" y2="'+(s+23)+'" stroke="black" /><line x1="33.5" y1="'+(s+23)+'" x2="41" y2="'+(s+14)+'" stroke="black" /><line x1="48.5" y1="'+(s+23)+'" x2="41" y2="'+(s+14)+'" stroke="black" />';break;case"Warmtekrachtkoppeling":t.data+='<circle cx="41" cy="'+(s+16)+'" r="7" style="stroke:black;fill:none" /><text x="41" y="'+(s+17)+'" style="text-anchor:middle;dominant-baseline:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">G</text>';break}var a=41,r=41;if(this.props.energiebron!=""&&this.props.warmtefunctie!="")var a=31,r=51;switch(this.props.energiebron){case"Gas (ventilator)":t.data+='<use xlink:href="#gas_ventilator" x="'+a+'" y="'+(s+35)+'"/>';break;case"Gas (atmosferisch)":t.data+='<use xlink:href="#gas_atmosferisch" x="'+a+'" y="'+(s+35)+'"/>';break;case"Elektriciteit":t.data+='<use xlink:href="#bliksem" x="'+a+'" y="'+(s+35)+'"/>';break;case"Vaste brandstof":t.data+='<rect x="'+(a-6)+'" y="'+(s+29)+'" width="12" height="12" style="stroke:black;fill:black" />';break;case"Vloeibare brandstof":t.data+='<circle cx="'+a+'" cy="'+(s+35)+'" r="6" style="stroke:black;fill:black" />';break}switch(this.props.warmtefunctie){case"Verwarmend":t.data+='<text x="'+(r-1)+'" y="'+(s+36)+'" style="text-anchor:middle;dominant-baseline:middle" font-family="Arial, Helvetica, sans-serif" font-size="12">+</text>';break;case"Koelend":t.data+='<text x="'+(r-1)+'" y="'+(s+36)+'" style="text-anchor:middle;dominant-baseline:middle" font-family="Arial, Helvetica, sans-serif" font-size="12">-</text>';break;case"Verwarmend en koelend":t.data+='<text x="'+(r-1)+'" y="'+(s+36)+'" style="text-anchor:middle;dominant-baseline:middle" font-family="Arial, Helvetica, sans-serif" font-size="12">+/-</text>';break}return t.data+=e?"":this.addAddressToSVG(t,60+s,15),t}}class Ii extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Koelkast",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("ster"),k.addSymbol("koelkast"),t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#koelkast" x="21" y="25"></use>',t.data+=this.addAddressToSVG(t,60,15),t}}class Ai extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Kookfornuis",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("kookfornuis"),t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#kookfornuis" x="21" y="25"></use>',t.data+=e?"":this.addAddressToSVG(t,60,15),t}}class us extends B{convertLegacyKeys(e){switch(this.props.type=this.getLegacyKey(e,0),this.props.aantal_polen=this.getLegacyKey(e,4),this.props.bescherming=this.getLegacyKey(e,7),this.props.amperage=this.getLegacyKey(e,8),this.props.type_kabel=this.getLegacyKey(e,9),this.props.naam=this.getLegacyKey(e,10),this.props.differentieel_delta_amperage=this.getLegacyKey(e,11),this.props.kabel_is_aanwezig=this.getLegacyKey(e,12),this.props.tekst=this.getLegacyKey(e,15),this.props.kabel_locatie=this.getLegacyKey(e,16),this.props.kabel_is_in_buis=this.getLegacyKey(e,19),this.props.differentieel_is_selectief=this.getLegacyKey(e,20),this.props.kortsluitvermogen=this.getLegacyKey(e,22),this.props.huishoudelijk=!0,this.props.fase="",this.props.bescherming){case"differentieel":this.props.type_differentieel=this.getLegacyKey(e,17);break;case"automatisch":this.props.curve_automaat=this.getLegacyKey(e,17);break;case"differentieelautomaat":this.props.type_differentieel=this.getLegacyKey(e,17),this.props.curve_automaat=this.getLegacyKey(e,18);break}}resetProps(){this.clearProps(),this.props.type="Kring",this.props.nr="",this.props.aantal_polen="2",this.props.bescherming="automatisch",this.props.amperage="20",this.props.type_kabel="XVB Cca 3G2,5",this.props.differentieel_delta_amperage="300",this.props.tekst="",this.props.kabel_locatie="N/A",this.props.type_differentieel="",this.props.curve_automaat="",this.props.kabel_is_in_buis=!1,this.props.differentieel_is_selectief=!1,this.props.kortsluitvermogen="",this.props.huishoudelijk=!0,this.props.fase="",this.props.normaalGesloten=!1,this.props.sturing="",this.props.adres="",this.props.newPage=!1;let e=this.getParent();if(e==null)this.props.kabel_is_aanwezig=!0,this.props.naam="";else switch(e.getType()){case"Bord":this.props.bescherming="automatisch",this.props.naam="---",this.props.kabel_is_aanwezig=!0;break;case"Splitsing":this.props.bescherming="geen",this.props.naam="",this.props.kabel_is_aanwezig=!1;break;case"Kring":this.props.type_kabel="",this.props.naam="",this.props.kabel_is_aanwezig=!0;break;case"Domotica":this.props.bescherming="geen",this.props.naam="",this.props.kabel_is_aanwezig=!0;break;default:this.props.bescherming="automatisch",this.props.naam="",this.props.kabel_is_aanwezig=!0;break}}allowedChilds(){return["","Aansluiting","Bord","Domotica","Domotica module (verticaal)","Domotica gestuurde verbruiker","Kring","Meerdere verbruikers","Splitsing","---","Batterij","Bel","Boiler","Contactdoos","Diepvriezer","Droogkast","Drukknop","Elektriciteitsmeter","Elektrische oven","EV lader","Ketel","Koelkast","Kookfornuis","Lichtcircuit","Lichtpunt","Media","Microgolfoven","Motor","Omvormer","Overspanningsbeveiliging","Schakelaars","Stoomoven","Transformator","USB lader","Vaatwasmachine","Ventilator","Verlenging","Verwarmingstoestel","Verbruiker","Vrije tekst","Warmtepomp/airco","Wasmachine","Zekering/differentieel","Zonnepaneel","---","Aansluitpunt","Aftakdoos","Zeldzame symbolen"]}getMaxNumChilds(){return 256}overrideKeys(){if(this.props.curve_automaat==="E"&&(this.props.curve_automaat="U"),this.props.sturing==null&&(this.props.sturing=""),this.props.normaalGesloten==null&&(this.props.normaalGesloten=!1),this.props.newPage==null&&(this.props.newPage=!1),this.props.bescherming=="schakelaar"&&(this.props.bescherming="contact"),this.props.aantal_polen!==""&&(this.props.aantal_polen<1||this.props.aantal_polen>4)&&(this.props.aantal_polen="2"),this.props.normaalGesloten===!0&&!["contact","zekeringscheider"].includes(this.props.bescherming)&&(this.props.normaalGesloten=!1),this.props.bescherming!=="contact"&&(this.props.sturing=""),this.getParent()!==null)this.props.newPage=!1;else{let e=this.sourcelist.getFirstChildId(0);e!==null&&this.id===e&&(this.props.newPage=!1)}this.props.kabel_locatie=="Luchtleiding"&&(this.props.kabel_is_in_buis=!1),this.props.bescherming!="differentieel"&&this.props.bescherming!="differentieelautomaat"&&(this.props.differentieel_is_selectief=!1),typeof this.props.huishoudelijk=="undefined"&&(this.props.huishoudelijk=!0),["automatisch","differentieel","differentieelautomaat","smelt"].includes(this.props.bescherming)||(this.props.fase=""),["automatisch","differentieel","differentieelautomaat"].includes(this.props.bescherming)||(this.props.kortsluitvermogen="")}toHTML(e){var s;this.overrideKeys();let t=this.toHTMLHeader(e);switch(t+=`&nbsp;Naam: ${this.selectPropToHTML("autoKringNaam",["auto","manueel"])}`+(this.props.autoKringNaam==="auto"?`<input type="text" id="HL_edit_${this.id}_naam" size="5" style="font-weight: bold; background-color:#FFFFE0;" value="${(s=this.props.naam)!=null?s:""}" disabled /><br>`:`${this.stringPropToHTML("naam",5)}<br>`),t+="Bescherming: "+this.selectPropToHTML("bescherming",["automatisch","differentieel","differentieelautomaat","smelt","geen","---","contact","zekeringscheider","relais","schemer","overspanningsbeveiliging"]),this.props.bescherming!="geen"&&this.props.bescherming!="relais"&&(t+=this.selectPropToHTML("aantal_polen",["2","3","4","-","1",""])+this.stringPropToHTML("amperage",2)+"A"),this.props.bescherming){case"differentieel":t+=", Δ "+this.stringPropToHTML("differentieel_delta_amperage",3)+"mA, Type:"+this.selectPropToHTML("type_differentieel",["","A","B"])+", Kortsluitstroom: "+this.stringPropToHTML("kortsluitvermogen",3)+"kA, Selectief: "+this.checkboxPropToHTML("differentieel_is_selectief")+", Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break;case"automatisch":t+=", Curve:"+this.selectPropToHTML("curve_automaat",["","B","C","D","U"])+", Kortsluitstroom: "+this.stringPropToHTML("kortsluitvermogen",3)+"kA, Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break;case"differentieelautomaat":t+=", Δ "+this.stringPropToHTML("differentieel_delta_amperage",3)+"mA, Curve:"+this.selectPropToHTML("curve_automaat",["","B","C","D","U"])+", Type:"+this.selectPropToHTML("type_differentieel",["","A","B"])+", Kortsluitstroom: "+this.stringPropToHTML("kortsluitvermogen",3)+"kA, Selectief: "+this.checkboxPropToHTML("differentieel_is_selectief")+", Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break;case"smelt":t+=", Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break;case"contact":t+=", Normaal Gesloten: "+this.checkboxPropToHTML("normaalGesloten"),t+=", Sturing: "+this.selectPropToHTML("sturing",["","spoel"]);break;case"zekeringscheider":t+=", Normaal Gesloten: "+this.checkboxPropToHTML("normaalGesloten");break}if(t+=", Kabel: "+this.checkboxPropToHTML("kabel_is_aanwezig"),this.props.kabel_is_aanwezig&&(t+=", Type: "+this.stringPropToHTML("type_kabel",10)+", Plaatsing: "+this.selectPropToHTML("kabel_locatie",["N/A","Ondergronds","Luchtleiding","In wand","Op wand"]),this.props.kabel_locatie!="Luchtleiding"&&(t+=", In buis: "+this.checkboxPropToHTML("kabel_is_in_buis"))),this.props.kortsluitvermogen!=""&&["differentieel","automatisch","differentieelautomaat"].includes(this.props.bescherming)&&(t+=", Huishoudelijke installatie: "+this.checkboxPropToHTML("huishoudelijk")),t+=", Tekst: "+this.stringPropToHTML("tekst",10),this.getParent()==null){let a=this.sourcelist.getFirstChildId(0);a!==null&&this.id!==a&&(t+=", Start op nieuwe pagina: "+this.checkboxPropToHTML("newPage"))}return t+=", Adres: "+this.stringPropToHTML("adres",5),t}toSVG(){let e=(p,u)=>{let g=p;return["L1","L2","L3"].includes(this.props.fase)&&(g++,u.data+='<text x="'+(u.xleft+15+11*(g-1))+'" y="'+(u.yup-10)+'" transform="rotate(-90 '+(u.xleft+15+11*(g-1))+","+(u.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.fase)+"</text>"),g},t=(p,u)=>{let g=p;return this.props.adres&&I(this.props.adres)!=""&&(g++,u.data+='<text x="'+(u.xleft+15+11*(g-1))+'" y="'+(u.yup-10)+'" transform="rotate(-90 '+(u.xleft+15+11*(g-1))+","+(u.yup-10)+')" style="text-anchor:middle;font-style:italic;" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.adres)+"</text>"),g},s=new H;k.addSymbol("zekering_automatisch"),k.addSymbol("zekering_empty"),k.addSymbol("zekering_smelt"),k.addSymbol("zekeringscheider"),k.addSymbol("overspanningsbeveiliging_inline"),k.addSymbol("arrow"),k.addSymbol("relais_kring");let a=0;this.props.kabel_is_aanwezig&&(this.props.kabel_is_in_buis||mt(["Ondergronds","In wand","Op wand"],this.props.kabel_locatie))&&(a=1);let r=25+20*a;this.props.naam.length>2&&(r=Math.max(r,ee(y(this.props.naam),12,'font-weight="bold"')+20)),this.props.bescherming==="contact"&&this.props.sturing==="spoel"&&(r+=25);let n="";this.props.aantal_polen!==""&&(n=`${y(this.props.aantal_polen)}P`);let o="";I(this.props.amperage)!==""&&(o=`${y(this.props.amperage)}A`);let c="";if(n!==""&&o!==""?c=`${n} - ${o}`:n!==""?c=n:o!==""&&(c=o),s=this.sourcelist.toSVG(this.id,"vertical",r),this.props.kabel_is_aanwezig){if(s.data+='<line x1="'+s.xleft+'" x2="'+s.xleft+'" y1="'+s.yup+'" y2="'+(s.yup+100)+'" stroke="black" /><text x="'+(s.xleft+15)+'" y="'+(s.yup+80)+'" transform="rotate(-90 '+(s.xleft+15)+","+(s.yup+80)+')" style="text-anchor:start" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.type_kabel)+"</text>",this.props.kabel_locatie=="Luchtleiding"&&(s.data+='<circle cx="'+s.xleft+'" cy="'+(s.yup+20)+'" r="4" style="stroke:black;fill:none" />'),a)switch(this.props.kabel_is_in_buis&&this.props.kabel_locatie!="Luchtleiding"&&(s.data+='<circle cx="'+(s.xleft-10)+'" cy="'+(s.yup+40)+'" r="4" style="stroke:black;fill:none" />'),this.props.kabel_locatie){case"Ondergronds":s.data+='<line x1="'+(s.xleft-13)+'" x2="'+(s.xleft-13)+'" y1="'+(s.yup+60)+'" y2="'+(s.yup+80)+'" style="stroke:black" /><line x1="'+(s.xleft-10)+'" x2="'+(s.xleft-10)+'" y1="'+(s.yup+62)+'" y2="'+(s.yup+78)+'" style="stroke:black" /><line x1="'+(s.xleft-7)+'" x2="'+(s.xleft-7)+'" y1="'+(s.yup+64)+'" y2="'+(s.yup+76)+'" style="stroke:black" />';break;case"In wand":s.data+='<line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-15)+'" y1="'+(s.yup+10)+'" y2="'+(s.yup+30)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+10)+'" y2="'+(s.yup+10)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+20)+'" y2="'+(s.yup+20)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+30)+'" y2="'+(s.yup+30)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-15)+'" y1="'+(s.yup+65)+'" y2="'+(s.yup+85)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+85)+'" y2="'+(s.yup+85)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+65)+'" y2="'+(s.yup+65)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+75)+'" y2="'+(s.yup+75)+'" style="stroke:black" />';break;case"Op wand":s.data+='<line x1="'+(s.xleft-5)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+10)+'" y2="'+(s.yup+30)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+10)+'" y2="'+(s.yup+10)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+20)+'" y2="'+(s.yup+20)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+30)+'" y2="'+(s.yup+30)+'" style="stroke:black" /><line x1="'+(s.xleft-5)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+65)+'" y2="'+(s.yup+85)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+85)+'" y2="'+(s.yup+85)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+65)+'" y2="'+(s.yup+65)+'" style="stroke:black" /><line x1="'+(s.xleft-15)+'" x2="'+(s.xleft-5)+'" y1="'+(s.yup+75)+'" y2="'+(s.yup+75)+'" style="stroke:black" />';break}s.yup+=100}else s.data+='<line x1="'+s.xleft+'" x2="'+s.xleft+'" y1="'+s.yup+'" y2="'+(s.yup+20)+'" stroke="black" />',s.yup+=20;this.props.differentieel_is_selectief&&(s.data+='<line x1="'+s.xleft+'" x2="'+s.xleft+'" y1="'+s.yup+'" y2="'+(s.yup+30)+'" stroke="black" /><rect x="'+(s.xleft+7)+'" y="'+s.yup+'" width="16" height="16" stroke="black" fill="white" /><text x="'+(s.xleft+19)+'" y="'+(s.yup+8)+'" transform="rotate(-90 '+(s.xleft+19)+","+(s.yup+8)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">S</text>',s.yup+=23);let l=-6,d=1;switch(this.props.bescherming){case"automatisch":if(d=I(c)!==""?1:0,s.yup+=30,s.data+='<use xlink:href="#zekering_automatisch" x="'+s.xleft+'" y="'+s.yup+'" /><text x="'+(s.xleft+15)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+c+"</text>",(this.props.curve_automaat=="B"||this.props.curve_automaat=="C"||this.props.curve_automaat=="D"||this.props.curve_automaat=="U")&&(++d,s.data+='<text x="'+(s.xleft+15+11*(d-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(d-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Curve "+this.props.curve_automaat)+"</text>"),this.props.kortsluitvermogen!="")if(this.props.huishoudelijk){d=d+1.3,s.data+='<text x="'+(s.xleft+15+11*(d-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(d-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+ie(this.props.kortsluitvermogen)*1e3)+"</text>";let p=ee(y(""+ie(this.props.kortsluitvermogen)*1e3))+6;s.data+='<rect x="'+(s.xleft+15+11*(d-2)+1)+'" y="'+(s.yup-10-p/2)+'" width="'+11*1.2+'" height="'+p+'" fill="none" stroke="black" />',d=d+.3}else d=d+1,s.data+='<text x="'+(s.xleft+15+11*(d-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(d-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+this.props.kortsluitvermogen)+"kA</text>";d=t.bind(this)(d,s),d=e.bind(this)(d,s),s.xright=Math.max(s.xright,20+11*(d-1));break;case"differentieel":if(d=1+(I(c)!==""?1:0),s.yup+=30,s.data+='<use xlink:href="#zekering_automatisch" x="'+s.xleft+'" y="'+s.yup+'" /><text x="'+(s.xleft+15)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">Δ'+y(this.props.differentieel_delta_amperage+"mA")+'</text><text x="'+(s.xleft+26)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+26)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+c+"</text>",(this.props.type_differentieel=="A"||this.props.type_differentieel=="B")&&(++d,s.data+='<text x="'+(s.xleft+15+11*(d-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(d-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Type "+this.props.type_differentieel)+"</text>"),this.props.kortsluitvermogen!="")if(this.props.huishoudelijk){d=d+1.3,s.data+='<text x="'+(s.xleft+15+11*(d-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(d-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+ie(this.props.kortsluitvermogen)*1e3)+"</text>";let p=ee(y(""+ie(this.props.kortsluitvermogen)*1e3))+6;s.data+='<rect x="'+(s.xleft+15+11*(d-2)+1)+'" y="'+(s.yup-10-p/2)+'" width="'+11*1.2+'" height="'+p+'" fill="none" stroke="black" />',d=d+.3}else d=d+1,s.data+='<text x="'+(s.xleft+15+11*(d-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(d-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+this.props.kortsluitvermogen)+"kA</text>";d=t.bind(this)(d,s),d=e.bind(this)(d,s),s.xright=Math.max(s.xright,20+11*(d-1));break;case"differentieelautomaat":if(d=1+(I(c)!==""?1:0),s.yup+=30,s.data+='<use xlink:href="#zekering_automatisch" x="'+s.xleft+'" y="'+s.yup+'" /><text x="'+(s.xleft+15)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">Δ'+y(this.props.differentieel_delta_amperage+"mA")+'</text><text x="'+(s.xleft+26)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+26)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+c+"</text>",(this.props.curve_automaat=="B"||this.props.curve_automaat=="C"||this.props.curve_automaat=="D"||this.props.curve_automaat=="U")&&(++d,s.data+='<text x="'+(s.xleft+15+11*(d-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(d-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Curve "+this.props.curve_automaat)+"</text>"),(this.props.type_differentieel=="A"||this.props.type_differentieel=="B")&&(++d,s.data+='<text x="'+(s.xleft+15+11*(d-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(d-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Type "+this.props.type_differentieel)+"</text>"),this.props.kortsluitvermogen!="")if(this.props.huishoudelijk){d=d+1.3,s.data+='<text x="'+(s.xleft+15+11*(d-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(d-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+ie(this.props.kortsluitvermogen)*1e3)+"</text>";let p=ee(y(""+ie(this.props.kortsluitvermogen)*1e3))+6;s.data+='<rect x="'+(s.xleft+15+11*(d-2)+1)+'" y="'+(s.yup-10-p/2)+'" width="'+11*1.2+'" height="'+p+'" fill="none" stroke="black" />',d=d+.3}else d=d+1,s.data+='<text x="'+(s.xleft+15+11*(d-1))+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+11*(d-1))+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+this.props.kortsluitvermogen)+"kA</text>";d=t.bind(this)(d,s),d=e.bind(this)(d,s),s.xright=Math.max(s.xright,20+11*(d-1));break;case"contact":case"zekeringscheider":d=0+(I(c)!==""?1:0),s.yup+=30,this.props.sturing==="spoel"&&(s.data+=`<rect x="${s.xleft-25}" y="${s.yup-25}" width="10" height="24" stroke="black" fill="none" />`,s.data+=`<line x1="${s.xleft-25}" x2="${s.xleft-15}" y1="${s.yup-9}" y2="${s.yup-17}" stroke="black" />`,s.data+=`<line x1="${s.xleft-15}" x2="${s.xleft-5}" y1="${s.yup-13}" y2="${s.yup-13}" stroke="black" stroke-dasharray="1,1" />`,l=-30),s.data+=`<use xlink:href="${this.props.bescherming=="contact"?"#zekering_empty":"#zekeringscheider"}" x="${s.xleft}" y="${s.yup}" /><text x="${s.xleft+15}" y="${s.yup-10}" transform="rotate(-90 ${s.xleft+15},${s.yup-10})" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">${c}</text>`,this.props.normaalGesloten&&(s.data+=`<line x1="${s.xleft}" x2="${s.xleft}" y1="${s.yup-25.5}" y2="${s.yup-30}" stroke="black" /><line x1="${s.xleft-12}" x2="${s.xleft+.5}" y1="${s.yup-25}" y2="${s.yup-25}" stroke="black" />`),d=t.bind(this)(d,s),s.xright=Math.max(s.xright,20+11*(d-1));break;case"overspanningsbeveiliging":d=5/11+(I(c)!==""?1:0),s.yup+=30,s.data+='<use xlink:href="#overspanningsbeveiliging_inline" x="'+s.xleft+'" y="'+s.yup+'" /><text x="'+(s.xleft+20)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+20)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+c+"</text>",d=t.bind(this)(d,s),s.xright=Math.max(s.xright,20+11*(d-1)),l=-11;break;case"schemer":d=0+(I(c)!==""?1:0),s.yup+=30,s.data+='<use xlink:href="#zekering_empty" x="'+s.xleft+'" y="'+s.yup+'" /><text x="'+(s.xleft+15)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+c+'</text><use xlink:href="#arrow" x="'+(s.xleft-18)+'" y="'+(s.yup-15)+'" /><use xlink:href="#arrow" x="'+(s.xleft-18)+'" y="'+(s.yup-12)+'" />',d=t.bind(this)(d,s),s.xright=Math.max(s.xright,20+11*(d-1));break;case"relais":d=.6,s.yup+=30,s.data+='<use xlink:href="#relais_kring" x="'+s.xleft+'" y="'+s.yup+'" />',l=-11,d=t.bind(this)(d,s),s.xright=Math.max(s.xright,20+11*(d-1));break;case"smelt":d=2/11+(I(c)!==""?1:0),s.yup+=30,s.data+='<use xlink:href="#zekering_smelt" x="'+s.xleft+'" y="'+s.yup+'" /><text x="'+(s.xleft+15+2)+'" y="'+(s.yup-10)+'" transform="rotate(-90 '+(s.xleft+15+2)+","+(s.yup-10)+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+c+"</text>",d=e.bind(this)(d,s),d=t.bind(this)(d,s),s.xright=Math.max(s.xright,20+11*(d-1));break;case"geen":s.yup+=0;break}let h=s.yup-40;return this.props.bescherming=="geen"&&(h+=25),s.data+='<text x="'+(s.xleft-6-20*a)+'" y="'+h+'" transform="rotate(-90 '+(s.xleft-6-20*a)+","+h+')" style="text-anchor:start" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="12">'+y(this.props.tekst)+"</text>",s.data+='<text x="'+(s.xleft+l)+'" y="'+(s.yup+3)+'" style="text-anchor:end" font-family="Arial, Helvetica, sans-serif" font-weight="bold" font-size="12">'+y(this.props.naam)+"</text>",s.data+='<line x1="'+s.xleft+'" x2="'+s.xleft+'" y1="'+s.yup+'" y2="'+(s.yup+15)+'" stroke="black" />',s.yup+=15,s.yup<=0&&(s.xleft=20,s.xright=20,s.yup=50,s.ydown=0),this.props.newPage&&(s.data=`<svg newPage="true" x="0" y="0" width="${s.xleft+s.xright}" height="${s.yup+s.ydown}">`+s.data+"</svg>"),s}}class Pi extends B{convertLegacyKeys(e){}resetProps(){this.clearProps(),this.props.type="Leiding",this.props.type_kabel="XVB Cca 3G2,5",this.props.kabel_locatie="N/A",this.props.kabel_is_in_buis=!1,this.props.adres=""}overrideKeys(){this.props.kabel_locatie=="Luchtleiding"&&(this.props.kabel_is_in_buis=!1)}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Type: "+this.stringPropToHTML("type_kabel",10)+", Plaatsing: "+this.selectPropToHTML("kabel_locatie",["N/A","Ondergronds","Luchtleiding","In wand","Op wand"]),this.props.kabel_locatie!="Luchtleiding"&&(t+=", In buis: "+this.checkboxPropToHTML("kabel_is_in_buis")),t}toSVG(){this.overrideKeys();let e=new H,t=100;switch(e.xleft=1,e.xright=t-1,e.yup=25,e.ydown=25,e.data+='<line x1="1" y1="25" x2="'+(t+1)+'" y2="25" stroke="black" />',this.props.kabel_locatie=="Luchtleiding"&&(e.data+='<circle cx="80" cy="25" r="4" style="stroke:black;fill:none" />'),this.props.kabel_is_in_buis&&this.props.kabel_locatie!="Luchtleiding"&&(e.data+='<circle cx="65" cy="15" r="4" style="stroke:black;fill:none" />'),this.props.kabel_locatie){case"Ondergronds":e.data+='<line y1="12" y2="12" x1="45" x2="25" style="stroke:black" /><line y1="15" y2="15" x1="43" x2="27" style="stroke:black" /><line y1="18" y2="18" x1="41" x2="29" style="stroke:black" />';break;case"In wand":e.data+='<line y1="10" y2="10" x1="95" x2="75" style="stroke:black" /><line y1="10" y2="20" x1="95" x2="95" style="stroke:black" /><line y1="10" y2="20" x1="85" x2="85" style="stroke:black" /><line y1="10" y2="20" x1="75" x2="75" style="stroke:black" /><line y1="10" y2="10" x1="40" x2="20" style="stroke:black" /><line y1="10" y2="20" x1="20" x2="20" style="stroke:black" /><line y1="10" y2="20" x1="40" x2="40" style="stroke:black" /><line y1="10" y2="20" x1="30" x2="30" style="stroke:black" />';break;case"Op wand":e.data+='<line y1="20" y2="20" x1="95" x2="75" style="stroke:black" /><line y1="10" y2="20" x1="95" x2="95" style="stroke:black" /><line y1="10" y2="20" x1="85" x2="85" style="stroke:black" /><line y1="10" y2="20" x1="75" x2="75" style="stroke:black" /><line y1="20" y2="20" x1="40" x2="20" style="stroke:black" /><line y1="10" y2="20" x1="20" x2="20" style="stroke:black" /><line y1="10" y2="20" x1="40" x2="40" style="stroke:black" /><line y1="10" y2="20" x1="30" x2="30" style="stroke:black" />';break}return e.data+='<text x="15" y="39" style="text-anchor:start" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.type_kabel)+"</text>",e.data+=`
`,e}}class gs extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.aantal=this.getLegacyKey(e,4),this.props.nr=this.getLegacyKey(e,10),this.props.aantal_buizen_indien_TL=this.getLegacyKey(e,13),this.props.adres=this.getLegacyKey(e,15),this.props.type_lamp=this.getLegacyKey(e,16),this.props.type_noodverlichting=this.getLegacyKey(e,17),this.props.is_wandlamp=this.getLegacyKey(e,19),this.props.is_halfwaterdicht=this.getLegacyKey(e,20),this.props.heeft_ingebouwde_schakelaar=this.getLegacyKey(e,21)}overrideKeys(){this.props.type_lamp==null&&this.props.type_lamp==""&&(this.props.type_lamp="standaard")}resetProps(){this.clearProps(),this.props.type="Lichtpunt",this.props.aantal="1",this.props.aantal_buizen_indien_TL="1",this.props.adres="",this.props.type_lamp="standaard",this.props.type_noodverlichting="Geen",this.props.is_wandlamp=!1,this.props.is_halfwaterdicht=!1,this.props.heeft_ingebouwde_schakelaar=!1}maxSituationPlanElements(){return this.props.aantal}toHTML(e){this.overrideKeys();let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Type: "+this.selectPropToHTML("type_lamp",["standaard","TL","spot","led"])+", ",this.props.type_lamp=="TL"&&(t+="Aantal buizen: "+this.selectPropToHTML("aantal_buizen_indien_TL",["1","2","3","4"])+", "),t+="Aantal lampen: "+this.selectPropToHTML("aantal",["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"])+", Wandlamp: "+this.checkboxPropToHTML("is_wandlamp")+", Halfwaterdicht: "+this.checkboxPropToHTML("is_halfwaterdicht")+", Ingebouwde schakelaar: "+this.checkboxPropToHTML("heeft_ingebouwde_schakelaar")+", Noodverlichting: "+this.selectPropToHTML("type_noodverlichting",["Geen","Centraal","Decentraal"])+", Adres/tekst: "+this.stringPropToHTML("adres",5),t}getSitPlanBoundaries(){let e=0,t=0,s=0,a=0;switch(this.props.type_lamp){case"led":e=14;break;case"TL":e=20,+this.props.aantal_buizen_indien_TL>3&&(s=-1,a=1);break;case"spot":e=17;break;case"standaard":default:e=10;break}return{clipleft:e,addright:t,cliptop:s,addbottom:a}}toSVG(e=!1,t=!1){let s=new H;s.xleft=1,s.xright=20,s.yup=25,s.ydown=25,s.data=e?"":'<line x1="1" x2="30" y1="25" y2="25" stroke="black" />';let a="";switch(this.props.is_halfwaterdicht?(a="h",parseInt(this.props.aantal)>1&&!e&&(a+=", x"+this.props.aantal)):parseInt(this.props.aantal)>1&&!e&&(a="x"+this.props.aantal),this.props.type_lamp){case"led":k.addSymbol("led"),s.data+='<use xlink:href="#led" x="30" y="25" />',this.props.is_wandlamp&&(s.data+='<line x1="30" y1="35" x2="42" y2="35" stroke="black" />'),this.props.heeft_ingebouwde_schakelaar&&(s.data+='<line x1="42" y1="25" x2="45.75" y2="17.5" stroke="black" /><line x1="45.75" y1="17.5" x2="48.25" y2="18.75" stroke="black" />');var l,r,d=6.5;if(a==""?(l=36,r=36):(l=20,a.length>2&&(this.props.type_noodverlichting=="Centraal"||this.props.type_noodverlichting=="Decentraal")?r=40:r=36),a!=""){let h='style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="7"';t==!1?s.data+=`<text x="${r}" y="10" ${h}>${y(a)}</text>`:s.data+=`<text transform="scale(-1,1) translate(${-2*r},0)" x="${r}" y="10" ${h}>${y(a)}</text>`}switch(this.props.type_noodverlichting){case"Centraal":s.data+='<circle cx="'+l+'" cy="'+d+'" r="2.5" style="stroke:black;fill:black" /><line x1="'+(l-5.6)+'" y1="'+(d-5.6)+'" x2="'+(l+5.6)+'" y2="'+(d+5.6)+'" style="stroke:black;fill:black" /><line x1="'+(l+5.6)+'" y1="'+(d-5.6)+'" x2="'+(l-5.6)+'" y2="'+(d+5.6)+'" style="stroke:black;fill:black" />';break;case"Decentraal":s.data+='<rect x="'+(l-5.6)+'" y="'+(d-5.6)+'" width="11.2" height="11.2" fill="white" stroke="black" /><circle cx="'+l+'" cy="'+d+'" r="2.5" style="stroke:black;fill:black" />';break}s.xright=42,s.data+=e?"":this.addAddressToSVG(s,50,5,2);break;case"spot":k.addSymbol("spot"),s.data+='<use xlink:href="#spot" x="30" y="25" />',this.props.is_wandlamp&&(s.data+='<line x1="30" y1="38" x2="46" y2="38" stroke="black" />'),this.props.heeft_ingebouwde_schakelaar&&(s.data+='<line x1="46" y1="25" x2="49.75" y2="17.5" stroke="black" /><line x1="49.75" y1="17.5" x2="52.25" y2="18.75" stroke="black" />');var l,r,d=6.5;if(a==""?(l=40,r=40):(l=24,a.length>2&&(this.props.type_noodverlichting=="Centraal"||this.props.type_noodverlichting=="Decentraal")?r=44:r=40),a!=""){let h='style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="7"';t==!1?s.data+=`<text x="${r}" y="10" ${h}>${y(a)}</text>`:s.data+=`<text transform="scale(-1,1) translate(${-2*r},0)" x="${r}" y="10" ${h}>${y(a)}</text>`}switch(this.props.type_noodverlichting){case"Centraal":s.data+='<circle cx="'+l+'" cy="'+d+'" r="2.5" style="stroke:black;fill:black" /><line x1="'+(l-5.6)+'" y1="'+(d-5.6)+'" x2="'+(l+5.6)+'" y2="'+(d+5.6)+'" style="stroke:black;fill:black" /><line x1="'+(l+5.6)+'" y1="'+(d-5.6)+'" x2="'+(l-5.6)+'" y2="'+(d+5.6)+'" style="stroke:black;fill:black" />';break;case"Decentraal":s.data+='<rect x="'+(l-5.6)+'" y="'+(d-5.6)+'" width="11.2" height="11.2" fill="white" stroke="black" /><circle cx="'+l+'" cy="'+d+'" r="2.5" style="stroke:black;fill:black" /><line x1="'+(l-5.6)+'" y1="'+(d-5.6)+'" x2="'+(l+5.6)+'" y2="'+(d+5.6)+'" style="stroke:black;fill:black" /><line x1="'+(l+5.6)+'" y1="'+(d-5.6)+'" x2="'+(l-5.6)+'" y2="'+(d+5.6)+'" style="stroke:black;fill:black" />';break}s.xright=45,s.data+=e?"":this.addAddressToSVG(s,52,7,4);break;case"TL":var n=this.props.aantal_buizen_indien_TL,o=25-n*3.5,c=25+n*3.5;s.data+='<line x1="30" y1="'+o+'" x2="30" y2="'+c+'" stroke="black" stroke-width="2" /><line x1="90" y1="'+o+'" x2="90" y2="'+c+'" stroke="black" stroke-width="2" />';for(let h=0;h<n;h++)s.data+='<line x1="30" y1="'+(o+h*7+3.5)+'" x2="90" y2="'+(o+h*7+3.5)+'" stroke="black" stroke-width="2" />';if(this.props.is_wandlamp&&(s.data+='<line x1="50" y1="'+(27+n*3.5)+'" x2="70" y2="'+(27+n*3.5)+'" stroke="black" />'),a!=""){let h='style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10"';t==!1?s.data+=`<text x="60" y="${25-n*3.5}" ${h}>${y(a)}</text>`:s.data+=`<text transform="scale(-1,1) translate(-120,0)" x="60" y="${25-n*3.5}" ${h}>${y(a)}</text>`}this.props.heeft_ingebouwde_schakelaar&&(s.data+='<line x1="77.5" y1="'+(29-n*3.5)+'" x2="85" y2="'+(14-n*3.5)+'" stroke="black" /><line x1="85" y1="'+(14-n*3.5)+'" x2="90" y2="'+(16.5-n*3.5)+'" stroke="black" />');var l,d=25-n*3.5-5;switch(a==""?l=60:l=39,this.props.type_noodverlichting){case"Centraal":s.data+='<circle cx="'+l+'" cy="'+d+'" r="2.5" style="stroke:black;fill:black" /><line x1="'+(l-5.6)+'" y1="'+(d-5.6)+'" x2="'+(l+5.6)+'" y2="'+(d+5.6)+'" style="stroke:black;fill:black" /><line x1="'+(l+5.6)+'" y1="'+(d-5.6)+'" x2="'+(l-5.6)+'" y2="'+(d+5.6)+'" style="stroke:black;fill:black" />';break;case"Decentraal":s.data+='<rect x="'+(l-5.6)+'" y="'+(d-5.6)+'" width="11.2" height="11.2" fill="white" stroke="black" /><circle cx="'+l+'" cy="'+d+'" r="2.5" style="stroke:black;fill:black" /><line x1="'+(l-5.6)+'" y1="'+(d-5.6)+'" x2="'+(l+5.6)+'" y2="'+(d+5.6)+'" style="stroke:black;fill:black" /><line x1="'+(l+5.6)+'" y1="'+(d-5.6)+'" x2="'+(l-5.6)+'" y2="'+(d+5.6)+'" style="stroke:black;fill:black" />';break}s.xright=90,s.data+=e?"":this.addAddressToSVG(s,c+13,Math.max(0,c-25-5),2);break;default:switch(this.props.type_noodverlichting){case"Centraal":k.addSymbol("lamp"),s.data+='<use xlink:href="#lamp" x="30" y="25" /><circle cx="30" cy="25" r="5" style="stroke:black;fill:black" />',this.heeftVerbruikerAlsKind()&&!e&&(s.data+='<line x1="30" y1="25" x2="41" y2="25" stroke="black" />');break;case"Decentraal":k.addSymbol("noodlamp_decentraal"),s.data+='<use xlink:href="#noodlamp_decentraal" x="30" y="25" />',this.props.heeft_ingebouwde_schakelaar&&(s.data+='<line x1="37" y1="18" x2="40" y2="15" stroke="black" stroke-width="2" />');break;default:k.addSymbol("lamp"),s.data+='<use xlink:href="#lamp" x="30" y="25" />',this.heeftVerbruikerAlsKind()&&!e&&(s.data+='<line x1="30" y1="25" x2="41" y2="25" stroke="black" />');break}if(a!=""){let h='style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10"';t==!1?s.data+=`<text x="30" y="10" ${h}>${y(a)}</text>`:s.data+=`<text transform="scale(-1,1) translate(-60,0)" x="30" y="10" ${h}>${y(a)}</text>`}this.props.is_wandlamp&&(s.data+='<line x1="20" y1="40" x2="40" y2="40" stroke="black" />'),this.props.heeft_ingebouwde_schakelaar&&(s.data+='<line x1="40" y1="15" x2="45" y2="20" stroke="black" stroke-width="2" />'),s.xright=39,s.data+=e?"":this.addAddressToSVG(s,54,10,-1);break}return s.data+=`
`,s}}class Mi extends B{convertLegacyKeys(e){}resetProps(){this.clearProps(),this.props.type="Media",this.props.adres="",this.props.aantal=1,this.props.symbool=""}overrideKeys(){["luidspreker","intercom"].includes(this.props.symbool)?(this.props.aantal<1&&(this.props.aantal=1),this.props.aantal>20&&(this.props.aantal=20)):this.props.aantal=1}toHTML(e){this.overrideKeys();let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Symbool: "+this.selectPropToHTML("symbool",["","luidspreker","intercom"]),["luidspreker","intercom"].includes(this.props.symbool)&&(t+=", Aantal: "+this.selectPropToHTML("aantal",["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"])),t+=", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;k.addSymbol("luidspreker");let s=0;if(this.props.aantal>1&&!e&&["luidspreker","intercom"].includes(this.props.symbool))switch(this.props.symbool){case"luidspreker":s=15,t.data+='<text x="31" y="12" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">x'+y(this.props.aantal)+"</text>";break;case"intercom":s=5,t.data+='<text x="36" y="12" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">x'+y(this.props.aantal)+"</text>";break}switch(t.xleft=1,t.xright=59,t.yup=25+s,t.ydown=25,this.props.symbool){case"luidspreker":t.data+=e?"":'<line x1="1" y1="'+(25+s)+'" x2="21" y2="'+(25+s)+'" stroke="black" />',t.data+='<use xlink:href="#luidspreker" x="21" y="'+(25+s)+'" />',t.xright=36,t.data+=e?"":this.addAddressToSVG(t,60+s,15,0);break;case"intercom":t.data+=e?"":'<line x1="1" y1="'+(25+s)+'" x2="21" y2="'+(25+s)+'" stroke="black" />',t.data+=`<rect x="21" y="${15+s}" width="30" height="20" stroke="black" fill="none" />`,t.data+=`<rect x="36" y="${20+s}" width="4" height="10" stroke="black" fill="none" />`,t.data+=`<line x1="40" y1="${20+s}" x2="51" y2="${15+s}" stroke="black" />`,t.data+=`<line x1="40" y1="${30+s}" x2="51" y2="${35+s}" stroke="black" />`,t.data+=`<line x1="46" y1="${25+s}" x2="56" y2="${25+s}" stroke="black" stroke-width="2" />`,t.data+=`<line x1="46" y1="${25+s}" x2="48" y2="${23+s}" stroke="black" stroke-width="1" stroke-linecap="round" />`,t.data+=`<line x1="46" y1="${25+s}" x2="48" y2="${27+s}" stroke="black" stroke-width="1" stroke-linecap="round" />`,t.data+=`<line x1="56" y1="${25+s}" x2="54" y2="${23+s}" stroke="black" stroke-width="1" stroke-linecap="round" />`,t.data+=`<line x1="56" y1="${25+s}" x2="54" y2="${27+s}" stroke="black" stroke-width="1" stroke-linecap="round" />`,t.xright=54,t.data+=e?"":this.addAddressToSVG(t,50+s,5,-3);break;default:t.data+=e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>',t.xright=19;break}return t}getSitPlanBoundaries(){let e=12,t=0,s=0,a=0;switch(this.props.symbool){case"luidspreker":break;case"intercom":t=-5,s=5,a=-5;break}return{clipleft:e,addright:t,cliptop:s,addbottom:a}}}class Ci extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Meerdere verbruikers",this.props.adres=""}allowedChilds(){return["","Domotica","Domotica gestuurde verbruiker","Splitsing","---","Batterij","Bel","Boiler","Contactdoos","Diepvriezer","Droogkast","Drukknop","Elektriciteitsmeter","Elektrische oven","EV lader","Ketel","Koelkast","Kookfornuis","Lichtcircuit","Lichtpunt","Omvormer","Overspanningsbeveiliging","Media","Microgolfoven","Motor","Schakelaars","Stoomoven","Transformator","USB lader","Vaatwasmachine","Ventilator","Verlenging","Verwarmingstoestel","Verbruiker","Vrije tekst","Warmtepomp/airco","Wasmachine","Zekering/differentieel","Zonnepaneel","---","Aansluitpunt","Aftakdoos","Zeldzame symbolen"]}getMaxNumChilds(){return 256}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(){let e;return e=this.sourcelist.toSVG(this.id,"horizontal"),e.ydown=Math.max(e.ydown,25),e.yup=Math.max(e.yup,25),e.xleft=Math.max(e.xleft,1),!/^\s*$/.test(this.props.adres)&&this.heeftKindMetGekendType()&&(e.data+='<text x="'+((e.xright-20)/2+21)+'" y="'+(e.yup+e.ydown+10)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10" font-style="italic">'+y(this.props.adres)+"</text>",e.ydown+=15),e}}class Hi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Microgolfoven",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("sinus"),k.addSymbol("microgolf"),t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#microgolf" x="21" y="25"></use>',t.data+=this.addAddressToSVG(t,60,15),t}}class Bi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Motor",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("motor"),t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#motor" x="21" y="25"></use>',t.data+=this.addAddressToSVG(t,60,15),t}}class Wt extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Omvormer",this.props.adres="",this.props.inkring=!1,this.props.micro=!1}allowedChilds(){return["","Aansluiting","Domotica","Domotica module (verticaal)","Domotica gestuurde verbruiker","Leiding","Meerdere verbruikers","Splitsing","---","Batterij","Bel","Boiler","Contactdoos","Diepvriezer","Droogkast","Drukknop","Elektriciteitsmeter","Elektrische oven","EV lader","Ketel","Koelkast","Kookfornuis","Lichtcircuit","Lichtpunt","Media","Microgolfoven","Motor","Omvormer","Overspanningsbeveiliging","Schakelaars","Stoomoven","Transformator","USB lader","Vaatwasmachine","Ventilator","Verlenging","Verwarmingstoestel","Verbruiker","Vrije tekst","Warmtepomp/airco","Wasmachine","Zekering/differentieel","Zonnepaneel","---","Aansluitpunt","Aftakdoos","Zeldzame symbolen"]}getMaxNumChilds(){return 256}overrideKeys(){let e;this.props.tekst==null&&(this.props.tekst=""),this.props.inkring==null&&(this.props.inkring=!1),this.props.micro==null&&(this.props.micro=!1),(e=this.getParent())!=null&&e.getType()!="Kring"&&(this.props.inkring=!1),this.props.micro&&this.getNumChilds()>1&&(this.props.micro=!1)}toHTML(e){this.overrideKeys();let t=this.toHTMLHeader(e),s;return t+="&nbsp;"+this.nrToHtml(),(s=this.getParent())!=null&&s.getType()=="Kring"&&(t+="In kring: "+this.checkboxPropToHTML("inkring")+", "),this.getNumChilds()<=1&&(t+="Micro: "+this.checkboxPropToHTML("micro")+", "),t+="Tekst: "+this.stringPropToHTML("tekst",10)+", ",t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;if(e)return k.addSymbol("sinus"),k.addSymbol("omvormer"),t.yup=25,t.ydown=25,t.xleft=1,t.xright=59,t.data+='<use xlink:href="#omvormer" x="21" y="25"></use>',t;const s=y(this.props.tekst);k.addSymbol("sinusVerticaal"),t=this.sourcelist.toSVG(this.id,"vertical");let a=t.yup+t.ydown,r=a;r<60&&(r=60),r=Math.max(r,ee(y(s),10,"")+25);let n=Math.max(0,a/2-t.firstChildydown),o=Math.max(0,a/2-t.lastChildyup),c=r;this.getNumChilds()<=1&&n<20&&o<20&&(c=Math.max(60,ee(y(s),10,"")+25)),t.yup=r/2,t.ydown=t.yup,t.firstChildydown=null,t.lastChildyup=null,t.data='<svg x="70" y="'+(r-a)/2+'">'+t.data+"</svg>",t.xleft=1,t.xright+=70;const l=this.props.micro?"1":"2";if(t.data+='<rect x="21" width="50" y="'+(5+(r-c)/2)+'" height="'+(c-10)+'" stroke="black" stroke-width="'+l+'" fill="white" />',t.data+=`<line x1="21" y1="${5+(r-c)/2}" x2="71" y2="${5+(r-c)/2+(c-10)}" stroke="black" />`,this.props.inkring?t.data+=`<line x1="1" x2="21" y1="${t.yup-5}" y2="${t.yup-5}" stroke="black" /><line x1="1" x2="21" y1="${t.yup+5}" y2="${t.yup+5}" stroke="black" />`:t.data+=`<line x1="1" x2="21" y1="${t.yup}" y2="${t.yup}" stroke="black" />`,I(s)!==""){const h=t.yup,p=10,u=2,b=ee(y(s),p,"")+u*2,_=p+u*2;t.data+=`<rect x="${45-_/2}" y="${h-b/2}" width="${_}" height="${b}" fill="white" />`,t.data+='<text x="49" y="'+h+'" transform="rotate(90 49,'+h+')" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+s+"</text>"}return t.data+=`<use xlink:href="#sinusVerticaal" x="30" y="${5+r/2+c/2-10-10}" /><line x1="66" y1="${12+(r-c)/2}" x2="66" y2="${27+(r-c)/2}" stroke="black" stroke-dasharray="3" /><line x1="62" y1="${12+(r-c)/2}" x2="62" y2="${27+(r-c)/2}" stroke="black" />`,t.data+=this.addAddressToSVG(t,r+10,15,(70-t.xright)/2-1),t}}class zi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Overspanningsbeveiliging",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("overspanningsbeveiliging"),t.xleft=1,t.xright=34,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#overspanningsbeveiliging" x="21" y="25"></use>',t.data+=e?"":this.addAddressToSVG(t,55,10),t}}class X{constructor(e,t=!1,s=!1,a=!1,r=!1,n=!1,o="",c=1){this.sitplan=!1,this.mirrortext=!1,this.type=e,this.halfwaterdicht=t,this.verklikkerlamp=s,this.signalisatielamp=a,this.trekschakelaar=r,this.normaalGesloten=n,this.sturing=o,this.aantal=c}schakelaarAttributentoSVGString(e,t=!1){k.addSymbol("signalisatielamp");let s="";if(this.signalisatielamp&&(s+='<use xlink:href="#signalisatielamp" x="'+(e-10)+'" y="25" />'),this.halfwaterdicht){let a='style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10"';this.mirrortext==!1?s+=`<text x="${e}" y="10" ${a}>h</text>`:s+=`<text transform="scale(-1,1) translate(${-2*e},0)" x="${e}" y="10" ${a}>h</text>`}if(this.verklikkerlamp&&(s+='<line x1="'+(e-3)+'" x2="'+(e+3)+'" y1="22" y2="28" stroke="black" /><line x1="'+(e-3)+'" x2="'+(e+3)+'" y1="28" y2="22" stroke="black" />'),this.trekschakelaar)switch(t){case!1:s+='<line x1="'+(e+10.5)+'" x2="'+(e+10.5)+'" y1="5" y2="15" stroke="black" /><line x1="'+(e+10.5)+'" x2="'+(e+8.5)+'" y1="15" y2="11" stroke="black" /><line x1="'+(e+10.5)+'" x2="'+(e+12.5)+'" y1="15" y2="11" stroke="black" />';break;case!0:s+='<line x1="'+(e+8.5)+'" x2="'+(e+8.5)+'" y1="9" y2="19" stroke="black" /><line x1="'+(e+8.5)+'" x2="'+(e+6.5)+'" y1="19" y2="15" stroke="black" /><line x1="'+(e+8.5)+'" x2="'+(e+10.5)+'" y1="19" y2="15" stroke="black" />';break}return s}enkeltoDrawReturnObj(e){let t="",s=e+30;return k.addSymbol("schakelaar_enkel"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#schakelaar_enkel" x="'+s+'" y="25" />'+this.schakelaarAttributentoSVGString(s),{endx:s,str:t,lowerbound:null}}dubbeltoDrawReturnObj(e){let t="",s=e+30;return k.addSymbol("schakelaar_dubbel"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#schakelaar_dubbel" x="'+s+'" y="25" />'+this.schakelaarAttributentoSVGString(s,!0),{endx:s,str:t,lowerbound:null}}driepoligtoDrawReturnObj(e){let t="",s=e+30;return k.addSymbol("schakelaar_trippel"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#schakelaar_trippel" x="'+s+'" y="25" />'+this.schakelaarAttributentoSVGString(s,!0),{endx:s,str:t,lowerbound:null}}dubbelaanstekingtoDrawReturnObj(e){let t="",s=e+30;return k.addSymbol("schakelaar_dubbelaansteking"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#schakelaar_dubbelaansteking" x="'+s+'" y="25" />'+this.schakelaarAttributentoSVGString(s),{endx:s,str:t,lowerbound:null}}wissel_enkeltoDrawReturnObj(e){let t="",s=e+30;return k.addSymbol("schakelaar_wissel_enkel"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#schakelaar_wissel_enkel" x="'+s+'" y="25" />'+this.schakelaarAttributentoSVGString(s),{endx:s,str:t,lowerbound:null}}wissel_dubbeltoDrawReturnObj(e){let t="",s=e+30;return k.addSymbol("schakelaar_wissel_dubbel"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#schakelaar_wissel_dubbel" x="'+s+'" y="25" />'+this.schakelaarAttributentoSVGString(s,!0),{endx:s,str:t,lowerbound:null}}kruis_enkeltoDrawReturnObj(e){let t="",s=e+30;return k.addSymbol("schakelaar_kruis_enkel"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#schakelaar_kruis_enkel" x="'+s+'" y="25" />'+this.schakelaarAttributentoSVGString(s),{endx:s,str:t,lowerbound:null}}dimschakelaartoDrawReturnObj(e){let t="",s=e+30;return k.addSymbol("schakelaar_enkel_dim"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#schakelaar_enkel_dim" x="'+s+'" y="25" />'+this.schakelaarAttributentoSVGString(s),{endx:s,str:t,lowerbound:null}}dimschakelaarWisseltoDrawReturnObj(e){let t="",s=e+30;return k.addSymbol("schakelaar_wissel_dim"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#schakelaar_wissel_dim" x="'+s+'" y="25" />'+this.schakelaarAttributentoSVGString(s),{endx:s,str:t,lowerbound:null}}bewegingsschakelaartoDrawReturnObj(e){let t="",s=e+20;return k.addSymbol("relais"),k.addSymbol("moving_man"),k.addSymbol("detectie_klein"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#relais" x="'+s+'" y="16" /><use xlink:href="#moving_man" x="'+(s+1.5)+'" y="11" /><use xlink:href="#detectie_klein" x="'+(s+23)+'" y="13"></use><line x1="'+s+'" x2="'+s+'" y1="29" y2="43" fill="none" style="stroke:black" /><line x1="'+(s+40)+'" x2="'+(s+40)+'" y1="29" y2="43" fill="none" style="stroke:black" /><line x1="'+s+'" x2="'+(s+40)+'" y1="43" y2="43" fill="none" style="stroke:black" />',{endx:s,str:t,lowerbound:null}}rolluikschakelaartoDrawReturnObj(e){let t="",s=e+30;if(k.addSymbol("schakelaar_rolluik"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#schakelaar_rolluik" x="'+s+'" y="25" />',this.halfwaterdicht){let a='style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10"';this.mirrortext==!1?t+=`<text x="${s}" y="10" ${a}>h</text>`:t+=`<text transform="scale(-1,1) translate(${-2*s},0)" x="${s}" y="10" ${a}>h</text>`}return{endx:s,str:t,lowerbound:null}}magneetcontacttoDrawReturnObj(e){let t="",s=e+20;if(k.addSymbol("magneetcontact"),this.aantal>1){let a='style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10"';this.mirrortext==!1?t+=`<text x="31" y="10" ${a}>x${y(this.aantal)}</text>`:t+=`<text transform="scale(-1,1) translate(-62,0)" x="31" y="10" ${a}>x${y(this.aantal)}</text>`}return t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#magneetcontact" x="'+s+'" y="25" />',{endx:s,str:t,lowerbound:null}}contacttoDrawReturnObj(e){let t="",s=e+20;return k.addSymbol("schakelaar"),t+='<line x1="'+e+'" x2="'+s+'" y1="25" y2="25" stroke="black" /><use xlink:href="#schakelaar" x="'+s+'" y="25" />',this.normaalGesloten&&(t+='<line x1="'+(s+32.5)+'" x2="'+(s+35)+'" y1="25" y2="25" stroke="black" /><line x1="'+(s+32)+'" x2="'+(s+32)+'" y1="13" y2="25.5" stroke="black" />'),this.sturing==="spoel"&&(t+='<rect x="'+(s+8)+'" y="1" width="24" height="10" stroke="black" fill="none" />',t+='<line x1="'+(s+16)+'" x2="'+(s+24)+'" y1="1" y2="11" stroke="black" />',t+='<line x1="'+(s+20)+'" x2="'+(s+20)+'" y1="11" y2="20" stroke="black" stroke-dasharray="1,1" />'),{endx:s,str:t,lowerbound:null}}defaulttoDrawReturnObj(e,t){let s="",a=e+20;return k.addSymbol(t.substring(1)),s+='<line x1="'+e+'" x2="'+a+'" y1="25" y2="25" stroke="black" /><use xlink:href="'+t+'" x="'+a+'" y="25" />',{endx:a,str:s,lowerbound:null}}extraPlaatsRechts(){return this.type=="enkel"||this.type=="dubbel"||this.type=="driepolig"||this.type=="dubbelaansteking"||this.type=="wissel_enkel"||this.type=="wissel_dubbel"||this.type=="kruis_enkel"||this.type=="dimschakelaar"||this.type=="dimschakelaar_wissel"?10:this.type=="rolluikschakelaar"?7:0}toSVGString(e,t,s=!1,a=!1){let r="",n,o=20;switch(this.sitplan=s,this.mirrortext=a,this.type){case"enkel":({endx:n,str:r}=this.enkeltoDrawReturnObj(e)),n+=5;break;case"dubbel":({endx:n,str:r}=this.dubbeltoDrawReturnObj(e)),n+=5;break;case"driepolig":({endx:n,str:r}=this.driepoligtoDrawReturnObj(e)),n+=5;break;case"dubbelaansteking":({endx:n,str:r}=this.dubbelaanstekingtoDrawReturnObj(e)),n+=5;break;case"wissel_enkel":({endx:n,str:r}=this.wissel_enkeltoDrawReturnObj(e)),n+=5,o=Math.max(o,35);break;case"wissel_dubbel":({endx:n,str:r}=this.wissel_dubbeltoDrawReturnObj(e)),n+=5,o=Math.max(o,35);break;case"kruis_enkel":({endx:n,str:r}=this.kruis_enkeltoDrawReturnObj(e)),n+=5,o=Math.max(o,35);break;case"dimschakelaar":({endx:n,str:r}=this.dimschakelaartoDrawReturnObj(e)),n+=5;break;case"dimschakelaar_wissel":({endx:n,str:r}=this.dimschakelaarWisseltoDrawReturnObj(e)),n+=5,o=Math.max(o,35);break;case"bewegingsschakelaar":({endx:n,str:r}=this.bewegingsschakelaartoDrawReturnObj(e)),n+=40,o=Math.max(o,30);break;case"rolluikschakelaar":({endx:n,str:r}=this.rolluikschakelaartoDrawReturnObj(e)),n+=8,o=Math.max(o,25);break;case"magneetcontact":({endx:n,str:r}=this.magneetcontacttoDrawReturnObj(e)),n+=20,o=Math.max(o,25);break;case"contact":({endx:n,str:r}=this.contacttoDrawReturnObj(e)),n+=40;break;case"schemerschakelaar":k.addSymbol("arrow"),{endx:n,str:r}=this.defaulttoDrawReturnObj(e,"#schemerschakelaar"),n+=40;break;case"teleruptor":({endx:n,str:r}=this.defaulttoDrawReturnObj(e,"#teleruptor")),n+=40,o=Math.max(o,30);break;case"dimmer":({endx:n,str:r}=this.defaulttoDrawReturnObj(e,"#dimmer")),n+=40,o=Math.max(o,30);break;case"relais":({endx:n,str:r}=this.defaulttoDrawReturnObj(e,"#relais")),n+=40,o=Math.max(o,30);break;case"minuterie":({endx:n,str:r}=this.defaulttoDrawReturnObj(e,"#minuterie")),n+=40,o=Math.max(o,30);break;case"thermostaat":({endx:n,str:r}=this.defaulttoDrawReturnObj(e,"#thermostaat")),n+=40,o=Math.max(o,30);break;case"tijdschakelaar":({endx:n,str:r}=this.defaulttoDrawReturnObj(e,"#tijdschakelaar")),n+=40,o=Math.max(o,30);break;default:n=30}return{endx:n,str:r,lowerbound:o}}}class _e extends B{constructor(e){super(e)}convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.aantal_schakelaars=this.getLegacyKey(e,4),this.props.type_schakelaar=this.getLegacyKey(e,5),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15),this.props.heeft_signalisatielampje=this.getLegacyKey(e,19),this.props.is_halfwaterdicht=this.getLegacyKey(e,20),this.props.heeft_verklikkerlampje=this.getLegacyKey(e,21),this.props.is_trekschakelaar=this.getLegacyKey(e,25)}resetProps(){this.clearProps(),this.props.type="Schakelaars",this.props.aantal_schakelaars="1",this.props.type_schakelaar="enkelpolig",this.props.adres="",this.props.heeft_signalisatielampje=!1,this.props.is_halfwaterdicht=!1,this.props.heeft_verklikkerlampje=!1,this.props.is_trekschakelaar=!1,this.props.normaalGesloten=!1,this.props.sturing=""}kanHalfwaterdichtZijn(){return this.props.type_schakelaar=="enkelpolig"||this.props.type_schakelaar=="dubbelpolig"||this.props.type_schakelaar=="driepolig"||this.props.type_schakelaar=="kruis_enkel"||this.props.type_schakelaar=="dubbelaansteking"||this.props.type_schakelaar=="wissel_enkel"||this.props.type_schakelaar=="wissel_dubbel"||this.props.type_schakelaar=="dubbel"||this.props.type_schakelaar=="dimschakelaar"||this.props.type_schakelaar=="dimschakelaar wissel"||this.props.type_schakelaar=="rolluikschakelaar"}kanVerklikkerlampjeHebben(){return this.props.type_schakelaar=="enkelpolig"||this.props.type_schakelaar=="dubbelpolig"||this.props.type_schakelaar=="driepolig"||this.props.type_schakelaar=="kruis_enkel"||this.props.type_schakelaar=="dubbelaansteking"||this.props.type_schakelaar=="wissel_enkel"||this.props.type_schakelaar=="wissel_dubbel"||this.props.type_schakelaar=="dubbel"||this.props.type_schakelaar=="dimschakelaar"||this.props.type_schakelaar=="dimschakelaar wissel"}kanSignalisatielampjeHebben(){return this.kanVerklikkerlampjeHebben()}kanTrekschakelaarHebben(){return this.props.type_schakelaar=="enkelpolig"||this.props.type_schakelaar=="dubbelpolig"||this.props.type_schakelaar=="driepolig"||this.props.type_schakelaar=="kruis_enkel"||this.props.type_schakelaar=="dubbelaansteking"||this.props.type_schakelaar=="wissel_enkel"||this.props.type_schakelaar=="wissel_dubbel"||this.props.type_schakelaar=="dubbel"}overrideKeys(){switch(this.props.sturing==null&&(this.props.sturing=""),this.props.normaalGesloten==null&&(this.props.normaalGesloten=!1),this.props.type_schakelaar=="schakelaar"&&(this.props.type_schakelaar="contact"),this.props.type_schakelaar){case"enkelpolig":this.props.aantal_schakelaars=String(Math.min(Number(this.props.aantal_schakelaars),5));break;case"dubbelpolig":this.props.aantal_schakelaars=String(Math.min(Number(this.props.aantal_schakelaars),2));break;case"magneetcontact":this.props.aantal_schakelaars=String(Math.min(Number(this.props.aantal_schakelaars),20));break;default:this.props.aantal_schakelaars="1";break}this.kanHalfwaterdichtZijn||(this.props.is_halfwaterdicht=!1),this.kanVerklikkerlampjeHebben||(this.props.heeft_verklikkerlampje=!1),this.kanSignalisatielampjeHebben||(this.props.heeft_signalisatielampje=!1),this.kanTrekschakelaarHebben||(this.props.is_trekschakelaar=!1),this.props.normaalGesloten===!0&&this.props.type_schakelaar!=="contact"&&(this.props.normaalGesloten=!1),this.props.type_schakelaar!=="contact"&&(this.props.sturing="")}toHTML(e){this.overrideKeys();let t=this.toHTMLHeader(e);switch(t+="&nbsp;"+this.nrToHtml(),t+=this.selectPropToHTML("type_schakelaar",["enkelpolig","dubbelpolig","driepolig","dubbelaansteking","wissel_enkel","wissel_dubbel","kruis_enkel","---","contact","dimschakelaar","dimschakelaar wissel","bewegingsschakelaar","schemerschakelaar","---","teleruptor","relais","dimmer","tijdschakelaar","minuterie","thermostaat","rolluikschakelaar","---","magneetcontact"]),this.kanHalfwaterdichtZijn()&&(t+=", Halfwaterdicht: "+this.checkboxPropToHTML("is_halfwaterdicht")),this.kanVerklikkerlampjeHebben()&&(t+=", Verklikkerlampje: "+this.checkboxPropToHTML("heeft_verklikkerlampje")),this.kanSignalisatielampjeHebben()&&(t+=", Signalisatielampje: "+this.checkboxPropToHTML("heeft_signalisatielampje")),this.kanTrekschakelaarHebben()&&(t+=", Trekschakelaar: "+this.checkboxPropToHTML("is_trekschakelaar")),this.props.type_schakelaar){case"enkelpolig":t+=", Aantal schakelaars: "+this.selectPropToHTML("aantal_schakelaars",["1","2","3","4","5"]);break;case"dubbelpolig":t+=", Aantal schakelaars: "+this.selectPropToHTML("aantal_schakelaars",["1","2"]);break;case"magneetcontact":t+=", Aantal schakelaars: "+this.selectPropToHTML("aantal_schakelaars",["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"]);break;case"contact":t+=", Normaal Gesloten: "+this.checkboxPropToHTML("normaalGesloten"),t+=", Sturing: "+this.selectPropToHTML("sturing",["","spoel"]);break}return t+=", Adres/tekst: "+this.stringPropToHTML("adres",5),t+=this.toHTMLFooter(),t}bouwSchakelaarKeten(e){switch(this.props.type_schakelaar){case"wissel_enkel":e.push(new X("wissel_enkel",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar));break;case"wissel_dubbel":e.push(new X("wissel_dubbel",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar));break;case"kruis_enkel":e.push(new X("kruis_enkel",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar));break;case"teleruptor":e.push(new X("teleruptor"));break;case"bewegingsschakelaar":e.push(new X("bewegingsschakelaar"));break;case"schemerschakelaar":e.push(new X("schemerschakelaar"));break;case"contact":e.push(new X("contact",!1,!1,!1,!1,this.props.normaalGesloten,this.props.sturing));break;case"dimmer":e.push(new X("dimmer"));break;case"relais":e.push(new X("relais"));break;case"minuterie":e.push(new X("minuterie"));break;case"thermostaat":e.push(new X("thermostaat"));break;case"tijdschakelaar":e.push(new X("tijdschakelaar"));break;case"magneetcontact":e.push(new X("magneetcontact",!1,!1,!1,!1,this.props.aantal_schakelaars));break;case"rolluikschakelaar":e.push(new X("rolluikschakelaar",this.props.is_halfwaterdicht));break;case"dubbelaansteking":e.push(new X("dubbelaansteking",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar));break;case"dimschakelaar":e.push(new X("dimschakelaar",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,!1));break;case"dimschakelaar wissel":e.push(new X("dimschakelaar_wissel",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,!1));break;case"enkelpolig":if(Number(this.props.aantal_schakelaars)==1&&e.push(new X("enkel",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar)),Number(this.props.aantal_schakelaars)>1){e.push(new X("wissel_enkel",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar));for(let t=2;t<Number(this.props.aantal_schakelaars);++t)e.push(new X("kruis_enkel",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar));e.push(new X("wissel_enkel",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar))}break;case"dubbelpolig":Number(this.props.aantal_schakelaars)==1&&e.push(new X("dubbel",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar)),Number(this.props.aantal_schakelaars)>1&&(e.push(new X("wissel_dubbel",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar)),e.push(new X("wissel_dubbel",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar)));break;case"driepolig":e.push(new X("driepolig",this.props.is_halfwaterdicht,this.props.heeft_verklikkerlampje,this.props.heeft_signalisatielampje,this.props.is_trekschakelaar));break}}isExpandable(){switch(this.props.type_schakelaar){case"enkelpolig":case"dubbelpolig":return Number(this.props.aantal_schakelaars)>1;default:return!1}}expand(){switch(this.props.type_schakelaar){case"enkelpolig":if(Number(this.props.aantal_schakelaars)>1){let e=Math.floor(this.props.aantal_schakelaars/2),t=new _e(this.sourcelist);Object.assign(t.props,this.props),t.props.aantal_schakelaars=1,t.props.type_schakelaar="wissel_enkel",t.props.adres="",this.sourcelist.insertItemBeforeId(t,this.id);let s=t;for(let a=0;a<Number(this.props.aantal_schakelaars)-2;++a){let r=new _e(this.sourcelist);Object.assign(r.props,this.props),r.props.aantal_schakelaars=1,r.props.type_schakelaar="kruis_enkel",e==a+1?r.props.adres=this.props.adres:r.props.adres="",this.getParent().props.type==="Meerdere verbruikers"?this.sourcelist.insertItemBeforeId(r,this.id):(this.sourcelist.insertChildAfterId(r,s.id),s=r)}e==Number(this.props.aantal_schakelaars)-1?this.props.adres=this.props.adres:this.props.adres="",this.props.aantal_schakelaars=1,this.props.type_schakelaar="wissel_enkel",this.getParent().props.type==="Meerdere verbruikers"?this.parent=this.getParent().id:this.parent=s.id}break;case"dubbelpolig":if(Number(this.props.aantal_schakelaars)>1){let e=new _e(this.sourcelist);Object.assign(e.props,this.props),e.props.aantal_schakelaars=1,e.props.type_schakelaar="wissel_dubbel",e.props.adres="",this.sourcelist.insertItemBeforeId(e,this.id),this.props.aantal_schakelaars=1,this.props.type_schakelaar="wissel_dubbel",this.getParent().props.type=="Meerdere verbruikers"?this.parent=this.getParent().id:this.parent=e.id}break}}toSVG(e=!1,t=!1){let s=new H,a=[];this.bouwSchakelaarKeten(a);var r=20,n=1;for(let o=0;o<a.length;o++){let c=o==a.length-1&&!this.heeftVerbruikerAlsKind(),l;if({endx:n,str:l,lowerbound:r}=a[o].toSVGString(n,c,e,t),e&&this.sourcelist.properties.legacySchakelaars==!1&&o==0&&a.length==1&&l.startsWith("<line")){let d=l.indexOf(">");l=l.substring(d+1)}s.data+=l}if(!this.heeftVerbruikerAlsKind()||e){let o=a[a.length-1].extraPlaatsRechts();e&&(o=Math.max(0,o-5)),n+=o}return s.xleft=1,s.xright=n-2,s.yup=25,s.ydown=25,this.props.type_schakelaar==="contact"&&this.props.sturing==="spoel"&&(s.data=`<svg xmlns="http://www.w3.org/2000/svg" x="0" y="5" width="${s.xleft+s.xright}" height="${s.yup+s.ydown}" >`+s.data+"</svg>",s.yup+=5,r+=5),s.data+=e?"":this.addAddressToSVG(s,25+r,Math.max(0,r-20)),s}}class Ki extends _e{resetProps(){super.resetProps(),this.props.type="Lichtcircuit",this.props.aantal_lichtpunten="1"}convertLegacyKeys(e){super.convertLegacyKeys(e),this.props.aantal_lichtpunten=this.getLegacyKey(e,13)}toHTML(e){this.overrideKeys();let t=this.toHTMLHeader(e);switch(t+="&nbsp;"+this.nrToHtml(),t+=this.selectPropToHTML("type_schakelaar",["enkelpolig","dubbelpolig","driepolig","dubbelaansteking","wissel_enkel","wissel_dubbel","kruis_enkel","---","contact","dimschakelaar","dimschakelaar wissel","bewegingsschakelaar","schemerschakelaar","---","teleruptor","relais","dimmer","tijdschakelaar","minuterie","thermostaat","rolluikschakelaar"]),this.kanHalfwaterdichtZijn()&&(t+=", Halfwaterdicht: "+this.checkboxPropToHTML("is_halfwaterdicht")),this.kanVerklikkerlampjeHebben()&&(t+=", Verklikkerlampje: "+this.checkboxPropToHTML("heeft_verklikkerlampje")),this.kanSignalisatielampjeHebben()&&(t+=", Signalisatielampje: "+this.checkboxPropToHTML("heeft_signalisatielampje")),this.kanTrekschakelaarHebben()&&(t+=", Trekschakelaar: "+this.checkboxPropToHTML("is_trekschakelaar")),this.props.type_schakelaar){case"enkelpolig":this.props.aantal_schakelaars==0?t+=", Aantal schakelaars: "+this.selectPropToHTML("aantal_schakelaars",["0","1","2","3","4","5"])+'<span style="color: red;"> Compatibiliteitsmodus, kies aantal schakelaars verschillend van 0 of gebruik element lichtpunt</span>':t+=", Aantal schakelaars: "+this.selectPropToHTML("aantal_schakelaars",["1","2","3","4","5"]);break;case"dubbelpolig":this.props.aantal_schakelaars==0?t+=", Aantal schakelaars: "+this.selectPropToHTML("aantal_schakelaars",["0","1","2"])+'<span style="color: red;"> Compatibiliteitsmodus, kies aantal schakelaars verschillend van 0 of gebruik element lichtpunt</span>':t+=", Aantal schakelaars: "+this.selectPropToHTML("aantal_schakelaars",["1","2"]);break;case"contact":t+=", Normaal Gesloten: "+this.checkboxPropToHTML("normaalGesloten"),t+=", Sturing: "+this.selectPropToHTML("sturing",["","spoel"]);break}return t+=", Aantal lichtpunten: "+this.selectPropToHTML("aantal_lichtpunten",["0","1","2","3","4","5","6","7","8","9","10"]),t+=", Adres/tekst: "+this.stringPropToHTML("adres",5),t+=this.toHTMLFooter(),t}countExpandableElements(){let e=this.props.aantal_lichtpunten=="0"?0:1;switch(this.props.type_schakelaar){case"enkelpolig":case"dubbelpolig":e+=+this.props.aantal_schakelaars;break;default:e+=1}return e}isExpandable(){return this.countExpandableElements()>1}expand(){let e=new _e(this.sourcelist);const r=this.props,{type:t,aantal_lichtpunten:s}=r,a=ae(r,["type","aantal_lichtpunten"]);if(Object.assign(e.props,a),e.props.adres=this.props.adres,+this.props.aantal_lichtpunten>0){this.sourcelist.insertItemBeforeId(e,this.id);let n=new gs(this.sourcelist);n.props.aantal=this.props.aantal_lichtpunten,n.props.is_halfwaterdicht=this.props.is_halfwaterdicht,n.id=this.id,this.getParent().props.type=="Meerdere verbruikers"?n.parent=this.getParent().id:n.parent=e.id;let o=this.sourcelist.getOrdinalById(this.id);o!==null&&(this.sourcelist.data[o]=n)}else{e.id=this.id,e.parent=this.getParent().id;let n=this.sourcelist.getOrdinalById(this.id);n!==null&&(this.sourcelist.data[n]=e)}e.expand()}toSVG(e=!1,t=!1){let s=new H,a=[];this.bouwSchakelaarKeten(a);var r=20,n=1,o;for(let c=0;c<a.length;c++){let l=c==a.length-1&&!this.heeftVerbruikerAlsKind(),d;({endx:n,str:d,lowerbound:r}=a[c].toSVGString(n,l,e,t)),s.data+=d}if(this.props.aantal_lichtpunten>=1){o=n+29,k.addSymbol("lamp"),s.data+='<line x1="'+n+'" x2="'+o+'" y1="25" y2="25" stroke="black" /><use xlink:href="#lamp" x="'+o+'" y="25" />';let c="";if(this.props.is_halfwaterdicht?(c="h",parseInt(this.props.aantal_lichtpunten)>1&&(c+=", x"+this.props.aantal_lichtpunten)):parseInt(this.props.aantal_lichtpunten)>1&&(c="x"+this.props.aantal_lichtpunten),c!=""){let l='style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10"';t==!1?s.data+=`<text x="${o}" y="10" ${l}>${y(c)}</text>`:s.data+=`<text transform="scale(-1,1) translate(${-2*o},0)" x="${o}" y="10" ${l}>${y(c)}</text>`}o++,this.heeftVerbruikerAlsKind()&&(s.data+='<line x1="'+o+'" y1="25" x2="'+(o+10)+'" y2="25" stroke="black" />'),n=o+10,r=Math.max(r,29)}else if((!this.heeftVerbruikerAlsKind()||e)&&a.length>0){let c=a[a.length-1].extraPlaatsRechts();e&&(c=Math.max(0,c-5)),n+=c}return s.xleft=1,s.xright=n-2,s.yup=25,s.ydown=25,this.props.type_schakelaar==="contact"&&this.props.sturing==="spoel"&&(s.data=`<svg xmlns="http://www.w3.org/2000/svg" x="0" y="5" width="${s.xleft+s.xright}" height="${s.yup+s.ydown}" >`+s.data+"</svg>",s.yup+=5,r+=5),s.data+=e?"":this.addAddressToSVG(s,25+r,Math.max(0,r-20)),s}}class Ni extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Splitsing",this.props.adres=""}allowedChilds(){return["","Kring"]}getMaxNumChilds(){return 256}toHTML(e,t){return this.toHTMLHeader(e)}toSVG(){let e;e=this.sourcelist.toSVG(this.id,"horizontal");let t=this.getParent();if(t.getType()=="Aansluiting"||t.getType()=="Kring"){if(e.data+='<line x1="'+e.xleft+'" x2="'+(e.xleft+e.xrightmin)+'" y1="'+e.yup+'" y2="'+e.yup+'" stroke="black" />',this.isChildOf("Kring")){const s=this.getParent();s!==null&&s.getNumChilds()>1&&(e.ydown+=10,e.data+=`<line x1="${e.xleft}" x2="${e.xleft}" y1="${e.yup+0}" y2="${e.yup+10}" stroke="black" stroke-width="1" />`)}}else e.xleft+e.xright<=0&&(e.xrightmin=15),e.yup<25&&(e.yup=25),e.ydown<25&&(e.ydown=25),e.data+='<line x1="1" x2="'+(e.xleft+e.xrightmin)+'" y1="'+e.yup+'" y2="'+e.yup+'" stroke="black" />',e.xright=e.xright+e.xleft,e.xleft=1;return e}}class Oi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Stoomoven",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("stoomoven"),t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#stoomoven" x="21" y="25"></use>',t.data+=e?"":this.addAddressToSVG(t,60,15),t}}class Vi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.voltage=this.getLegacyKey(e,14),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Transformator",this.props.voltage="230V/24V",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Voltage: "+this.stringPropToHTML("voltage",8)+", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("transformator"),t.xleft=1,t.xright=47,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#transformator" x="21" y="25"></use><text x="35" y="44" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.voltage)+"</text>",t.data+=e?"":this.addAddressToSVG(t,58,15),t}}class Di extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.aantal=this.getLegacyKey(e,4),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="USB lader",this.props.aantal="1",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Aantal: "+this.selectPropToHTML("aantal",["1","2","3","4","5","6","7","8","9","10"]),t+=", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;k.addSymbol("usblader");var s=0;return this.props.aantal>1&&(s=12,t.data+='<text x="51" y="14" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">x'+y(this.props.aantal)+"</text>"),t.xleft=1,t.xright=79,t.yup=25+s,t.ydown=25,t.data+=(e?"":'<line x1="1" y1="'+(s+25)+'" x2="21" y2="'+(s+25)+'" stroke="black"></line>')+'<use xlink:href="#usblader" x="21" y="'+(s+25)+'"></use>',t.data+=e?"":this.addAddressToSVG(t,55+s,10),t}}class $i extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Vaatwasmachine",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+="Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("vaatwasmachine"),t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#vaatwasmachine" x="21" y="25"></use>',t.data+=e?"":this.addAddressToSVG(t,60,15),t}}class ji extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Ventilator",this.props.adres="",this.props.ventilatortype="ventilator"}overrideKeys(){this.props.ventilatortype||(this.props.ventilatortype="ventilator")}toHTML(e){this.overrideKeys();let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml(),t+=this.selectPropToHTML("ventilatortype",["ventilator","afzuigkap"]),t+=", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("ventilator"),t.xleft=1,t.xright=49,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#ventilator" x="21" y="25"></use>',this.props.ventilatortype==="afzuigkap"&&(t.data+='<line x1="21" y1="7" x2="36" y2="5" stroke="black" stroke-linecap="round"></line>',t.data+='<line x1="51" y1="7" x2="36" y2="5" stroke="black" stroke-linecap="round"></line>'),t.data+=e?"":this.addAddressToSVG(t,55,10),t}}class Ri extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.tekst=this.getLegacyKey(e,15),this.props.horizontale_uitlijning=this.getLegacyKey(e,17),this.props.heeft_automatische_breedte=this.getLegacyKey(e,18),this.props.is_vet=this.getLegacyKey(e,19),this.props.is_cursief=this.getLegacyKey(e,20),this.props.breedte=this.getLegacyKey(e,22),this.props.adres=this.getLegacyKey(e,23)}resetProps(){this.clearProps(),this.props.type="Verbruiker",this.props.tekst="",this.props.horizontale_uitlijning="centreer",this.props.heeft_automatische_breedte="automatisch",this.props.breedte="",this.props.is_vet=!1,this.props.is_cursief=!1,this.props.adres=""}overrideKeys(){this.props.heeft_automatische_breedte!="automatisch"&&(this.props.heeft_automatische_breedte="handmatig"),this.adjustTextWidthIfAuto()}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+'Tekst (nieuwe lijn = "|"): '+this.stringPropToHTML("tekst",30)+", Breedte: "+this.selectPropToHTML("heeft_automatische_breedte",["automatisch","handmatig"]),this.props.heeft_automatische_breedte!="automatisch"&&(t+=" "+this.stringPropToHTML("breedte",3)),t+=", Vet: "+this.checkboxPropToHTML("is_vet")+", Cursief: "+this.checkboxPropToHTML("is_cursief")+", Horizontale alignering: "+this.selectPropToHTML("horizontale_uitlijning",["links","centreer","rechts"])+", Adres/tekst: "+this.stringPropToHTML("adres",2),t}adjustTextWidthIfAuto(){if(this.props.heeft_automatische_breedte==="automatisch"){var e="";this.props.is_vet&&(e+=' font-weight="bold"'),this.props.is_cursief&&(e+=' font-style="italic"');var t=y(this.props.tekst).split("|"),s=40;for(let a=0;a<t.length;a++)s=Math.round(Math.max(s,ee(t[a],10,e)+10));this.props.breedte=String(s)}}toSVG(e=!1){let t=new H;var s=y(this.props.tekst).split("|");this.adjustTextWidthIfAuto();var a=isNaN(Number(this.props.breedte))||this.props.breedte===""?40:Math.max(Number(this.props.breedte)*1,1),r=15*Math.max(s.length-2,0);t.xleft=1,t.xright=20+a,t.yup=25+r/2,t.ydown=25+r/2;var n="";this.props.is_vet&&(n+=' font-weight="bold"'),this.props.is_cursief&&(n+=' font-style="italic"');var o;switch(this.props.horizontale_uitlijning){case"links":o='<text style="text-anchor:start" font-family="Arial, Helvetica, sans-serif" font-size="10" x="25" ';break;case"rechts":o='<text style="text-anchor:end" font-family="Arial, Helvetica, sans-serif" font-size="10" x="'+(20+a-4)+'" ';break;default:o='<text style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10" x="'+(21+a/2)+'" ';break}for(let l=0;l<s.length;l++){var c=28-7.5*Math.min(1,s.length-1)+15*l;t.data+=o+' y="'+c+'"'+n+">"+s[l]+"</text>"}return t.data+=(e?"":'<line x1="1" y1="'+(25+r/2)+'" x2="21" y2="'+(25+r/2)+'" stroke="black" />')+'<rect x="21" y="5" width="'+a+'" height="'+(40+r)+'" fill="none" style="stroke:black" />'+this.addAddressToSVG(t,60+r,15,a/2-(t.xright-20)/2),t}}class Ui extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.breedte=this.getLegacyKey(e,22),this.props.adres=this.getLegacyKey(e,23)}resetProps(){this.clearProps(),this.props.type="Verlenging",this.props.breedte="40",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Breedte: "+this.stringPropToHTML("breedte",3)+", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(){let e=new H;var t;return isNaN(Number(this.props.breedte))||+(this.props.breedte=="")?t=40:t=Math.max(Number(this.props.breedte)*1,0),e.xleft=1,e.xright=t-1,e.yup=25,e.ydown=25,e.data+='<line x1="1" y1="25" x2="'+(t+1)+'" y2="25" stroke="black" />',e.data+=this.addAddressToSVG(e,40,0,t/2-e.xright/2-10),e.data+=`
`,e}}class Gi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.heeft_accumulatie=this.getLegacyKey(e,3),this.props.heeft_ventilator=this.getLegacyKey(e,6),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Verwarmingstoestel",this.props.heeft_accumulatie=!1,this.props.heeft_ventilator=!1,this.props.adres=""}overrideKeys(){this.props.heeft_accumulatie||(this.props.heeft_ventilator=!1)}toHTML(e){this.overrideKeys;let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Accumulatie: "+this.checkboxPropToHTML("heeft_accumulatie")+(this.props.heeft_accumulatie?", Ventilator: "+this.checkboxPropToHTML("heeft_ventilator"):"")+", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;switch(t.xleft=1,t.xright=69,t.yup=25,t.ydown=25,t.data=e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>',this.props.heeft_accumulatie){case!1:k.addSymbol("VerticalStripe"),k.addSymbol("verwarmingstoestel"),t.data+='<use xlink:href="#verwarmingstoestel" x="21" y="25"></use>';break;case!0:switch(this.props.heeft_ventilator){case!1:k.addSymbol("VerticalStripe"),k.addSymbol("verwarmingstoestel_accu"),t.data+='<use xlink:href="#verwarmingstoestel_accu" x="21" y="25"></use>';break;case!0:k.addSymbol("VerticalStripe"),k.addSymbol("verwarmingstoestel_accu_ventilator"),t.data+='<use xlink:href="#verwarmingstoestel_accu_ventilator" x="21" y="25"></use>',t.xright=89;break}break}return t.data+=e?"":this.addAddressToSVG(t,55,10),t}}class Fi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.breedte=this.getLegacyKey(e,22)}resetProps(){this.clearProps(),this.props.type="Vrije ruimte",this.props.breedte=25}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;Breedte: "+this.stringPropToHTML("breedte",3),t}getMaxNumChilds(){return 0}toSVG(){let e=new H,t=Number(this.props.breedte);return isNaN(t)&&(t=25),e.yup=0,e.ydown=0,e.xleft=0,e.xright=t,e.data="",e}}class Wi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.tekst=this.getLegacyKey(e,15),this.props.vrije_tekst_type=this.getLegacyKey(e,16),this.props.horizontale_uitlijning=this.getLegacyKey(e,17),this.props.heeft_automatische_breedte=this.getLegacyKey(e,18),this.props.is_vet=this.getLegacyKey(e,19),this.props.is_cursief=this.getLegacyKey(e,20),this.props.breedte=this.getLegacyKey(e,22),this.props.adres=this.getLegacyKey(e,23)}resetProps(){this.clearProps(),this.props.type="Vrije tekst",this.props.tekst="",this.props.vrije_tekst_type="zonder kader",this.props.horizontale_uitlijning="links",this.props.heeft_automatische_breedte="automatisch",this.props.breedte="",this.props.is_vet=!1,this.props.is_cursief=!1,this.props.adres=""}overrideKeys(){this.props.vrije_tekst_type!="verbruiker"&&(this.props.vrije_tekst_type="zonder kader"),this.props.heeft_automatische_breedte!="automatisch"&&(this.props.heeft_automatische_breedte="handmatig"),this.heeftVerbruikerAlsKind()&&(this.props.vrije_tekst_type="verbruiker"),this.adjustTextWidthIfAuto()}toHTML(e){this.overrideKeys();let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+'Tekst (nieuwe lijn = "|"): '+this.stringPropToHTML("tekst",30)+", Breedte: "+this.selectPropToHTML("heeft_automatische_breedte",["automatisch","handmatig"]),this.props.heeft_automatische_breedte!="automatisch"&&(t+=" "+this.stringPropToHTML("breedte",3)),t+=", Vet: "+this.checkboxPropToHTML("is_vet")+", Cursief: "+this.checkboxPropToHTML("is_cursief")+", Horizontale alignering: "+this.selectPropToHTML("horizontale_uitlijning",["links","centreer","rechts"])+", Type: "+this.selectPropToHTML("vrije_tekst_type",this.heeftVerbruikerAlsKind()?["verbruiker"]:["verbruiker","zonder kader"]),this.props.vrije_tekst_type!="zonder kader"&&(t+=", Adres/tekst: "+this.stringPropToHTML("adres",5)),t}adjustTextWidthIfAuto(){if(this.props.heeft_automatische_breedte==="automatisch"){var e="";this.props.is_vet&&(e+=' font-weight="bold"'),this.props.is_cursief&&(e+=' font-style="italic"');var t=y(this.props.tekst).split("|"),s=40;for(let a=0;a<t.length;a++)s=Math.round(Math.max(s,ee(t[a],10,e)+10));this.props.breedte=String(s)}}toSVG(e=!1){let t=new H;var s=y(this.props.tekst).split("|");this.adjustTextWidthIfAuto();var a=isNaN(Number(this.props.breedte))||this.props.breedte===""?40:Math.max(Number(this.props.breedte)*1,1),r=15*Math.max(s.length-2,0),n;this.props.vrije_tekst_type==="zonder kader"?this.getParent().getType()==="Kring"?n=10:this.getParent().getType()==="Contactdoos"?n=0:n=5:n=20,t.xleft=1,t.xright=n+a,t.yup=25+r/2,t.ydown=25+r/2;var o="";this.props.is_vet&&(o+=' font-weight="bold"'),this.props.is_cursief&&(o+=' font-style="italic"');var c;switch(this.props.horizontale_uitlijning){case"links":c='<text style="text-anchor:start" font-family="Arial, Helvetica, sans-serif" font-size="10" x="'+(n+5)+'" ';break;case"rechts":c='<text style="text-anchor:end" font-family="Arial, Helvetica, sans-serif" font-size="10" x="'+(n+a-4)+'" ';break;default:c='<text style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10" x="'+(n+1+a/2)+'" ';break}for(let l=0;l<s.length;l++){let d=28-7.5*Math.min(1,s.length-1)+15*l;t.data+=c+' y="'+d+'"'+o+">"+s[l]+"</text>"}switch(this.props.vrije_tekst_type){case"zonder kader":break;default:t.data+=(e?"":'<line x1="1" y1="'+(25+r/2)+'" x2="21" y2="'+(25+r/2)+'" stroke="black" />')+'<rect x="21" y="5" width="'+a+'" height="'+(40+r)+'" fill="none" style="stroke:black" />'+this.addAddressToSVG(t,60+r,15,a/2-(t.xright-20)/2);break}return t}getSitPlanBoundaries(){switch(this.props.vrije_tekst_type){case"zonder kader":return{clipleft:0,addright:-8,cliptop:10,addbottom:-10};default:return{clipleft:12,addright:0,cliptop:0,addbottom:0}}}}class qi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.aantal=this.getLegacyKey(e,4),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15),this.props.warmtefunctie=this.getLegacyKey(e,18)}resetProps(){this.clearProps(),this.props.type="Warmtepomp/airco",this.props.aantal="1",this.props.adres="",this.props.warmtefunctie="Koelend"}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Warmte functie: "+this.selectPropToHTML("warmtefunctie",["","Koelend","Verwarmend","Verwarmend en koelend"])+", Aantal: "+this.selectPropToHTML("aantal",["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"])+", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;k.addSymbol("verbruiker"),k.addSymbol("bliksem");var s=0;this.props.aantal>1&&(s=15,t.data+='<text x="41" y="12" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">x'+y(this.props.aantal)+"</text>"),t.xleft=1,t.xright=59,t.yup=25+s,t.ydown=25,t.data+=(e?"":'<line x1="1" y1="'+(s+25)+'" x2="21" y2="'+(s+25)+'" stroke="black"></line>')+'<use xlink:href="#verbruiker" x="21" y="'+(s+25)+'"></use><line x1="26" y1="'+(s+0)+'" x2="26" y2="'+(s+5)+'" stroke="black" /><line x1="56" y1="'+(s+0)+'" x2="56" y2="'+(s+5)+'" stroke="black" /><line x1="26" y1="'+(s+5)+'" x2="33.5" y2="'+(s+23)+'" stroke="black" /><line x1="56" y1="'+(s+5)+'" x2="48.5" y2="'+(s+23)+'" stroke="black" /><line x1="33.5" y1="'+(s+23)+'" x2="41" y2="'+(s+14)+'" stroke="black" /><line x1="48.5" y1="'+(s+23)+'" x2="41" y2="'+(s+14)+'" stroke="black" />';var a=41,r=41;if(this.props.warmtefunctie!="")var a=31,r=51;switch(t.data+='<use xlink:href="#bliksem" x="'+a+'" y="'+(s+35)+'"/>',this.props.warmtefunctie){case"Verwarmend":t.data+='<text x="'+(r-1)+'" y="'+(s+36)+'" style="text-anchor:middle;dominant-baseline:middle" font-family="Arial, Helvetica, sans-serif" font-size="12">+</text>';break;case"Koelend":t.data+='<text x="'+(r-1)+'" y="'+(s+36)+'" style="text-anchor:middle;dominant-baseline:middle" font-family="Arial, Helvetica, sans-serif" font-size="12">-</text>';break;case"Verwarmend en koelend":t.data+='<text x="'+(r-1)+'" y="'+(s+36)+'" style="text-anchor:middle;dominant-baseline:middle" font-family="Arial, Helvetica, sans-serif" font-size="12">+/-</text>';break}return t.data+=e?"":this.addAddressToSVG(t,60+s,15),t}}class Ji extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Wasmachine",this.props.adres=""}toHTML(e){let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;return k.addSymbol("wasmachine"),t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,t.data=(e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>')+'<use xlink:href="#wasmachine" x="21" y="25"></use>',t.data+=this.addAddressToSVG(t,60,15),t}}class Zi extends B{convertLegacyKeys(e){}resetProps(){this.clearProps(),this.props.type="Zekering/differentieel",this.props.nr="",this.props.aantal_polen="2",this.props.bescherming="automatisch",this.props.amperage="20",this.props.differentieel_delta_amperage="300",this.props.type_differentieel="",this.props.curve_automaat="",this.props.differentieel_is_selectief=!1,this.props.kortsluitvermogen="",this.props.huishoudelijk=!0,this.props.fase="",this.props.newPage=!1}overrideKeys(){if(this.props.curve_automaat==="E"&&(this.props.curve_automaat="U"),this.props.newPage==null&&(this.props.newPage=!1),(this.props.aantal_polen<1||this.props.aantal_polen>4)&&(this.props.aantal_polen="2"),this.props.bescherming!="differentieel"&&this.props.bescherming!="differentieelautomaat"&&(this.props.differentieel_is_selectief=!1),this.isChildOf("Kring")||(this.props.nr=""),this.getParent()!==null)this.props.newPage=!1;else{let e=this.sourcelist.getFirstChildId(0);e!==null&&this.id===e&&(this.props.newPage=!1)}typeof this.props.huishoudelijk=="undefined"&&(this.props.huishoudelijk=!0),["automatisch","differentieel","differentieelautomaat","smelt"].includes(this.props.bescherming)||(this.props.fase=""),["automatisch","differentieel","differentieelautomaat"].includes(this.props.bescherming)||(this.props.kortsluitvermogen="")}toHTML(e){this.overrideKeys();let t=this.toHTMLHeader(e);switch(t+="&nbsp;",this.isChildOf("Kring")&&(t=t+this.nrToHtml()),t=t+this.selectPropToHTML("bescherming",["automatisch","differentieel","differentieelautomaat","smelt"]),this.props.bescherming!="geen"&&(t+=this.selectPropToHTML("aantal_polen",["2","3","4","-","1"])+this.stringPropToHTML("amperage",2)+"A"),this.props.bescherming){case"differentieel":t+=", Δ "+this.stringPropToHTML("differentieel_delta_amperage",3)+"mA, Type:"+this.selectPropToHTML("type_differentieel",["","A","B"])+", Kortsluitstroom: "+this.stringPropToHTML("kortsluitvermogen",3)+"kA, Selectief: "+this.checkboxPropToHTML("differentieel_is_selectief")+", Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break;case"automatisch":t+=", Curve:"+this.selectPropToHTML("curve_automaat",["","B","C","D","U"])+", Kortsluitstroom: "+this.stringPropToHTML("kortsluitvermogen",3)+"kA, Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break;case"differentieelautomaat":t+=", Δ "+this.stringPropToHTML("differentieel_delta_amperage",3)+"mA, Curve:"+this.selectPropToHTML("curve_automaat",["","B","C","D","U"])+", Type:"+this.selectPropToHTML("type_differentieel",["","A","B"])+", Kortsluitstroom: "+this.stringPropToHTML("kortsluitvermogen",3)+"kA, Selectief: "+this.checkboxPropToHTML("differentieel_is_selectief")+", Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break;case"smelt":t+=", Fase: "+this.selectPropToHTML("fase",["","L1","L2","L3"]);break}if(this.props.kortsluitvermogen!=""&&["differentieel","automatisch","differentieelautomaat"].includes(this.props.bescherming)&&(t+=", Huishoudelijke installatie: "+this.checkboxPropToHTML("huishoudelijk")),this.getParent()==null){let s=this.sourcelist.getFirstChildId(0);s!==null&&this.id!==s&&(t+=", Start op nieuwe pagina: "+this.checkboxPropToHTML("newPage"))}return t}toSVG(){let e=(a,r)=>{let n=a;return["L1","L2","L3"].includes(this.props.fase)&&(n=n+(this.props.huishoudelijk&&this.props.kortsluitvermogen!=""?1.3:1),r.data+='<text x="'+(31+(this.props.bescherming=="smelt"?4:0))+'" y="'+(40+(n-1)*11)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.fase)+"</text>"),n},t=new H;k.addSymbol("zekering_automatisch_horizontaal"),k.addSymbol("zekering_smelt_horizontaal"),t.xleft=1,t.xright=50,t.yup=25,t.ydown=25,t.data+='<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>';let s=1;switch(this.props.bescherming){case"automatisch":if(s=1,t.data+='<use xlink:href="#zekering_automatisch_horizontaal" x="21" y="25" /><text x="31" y="40" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.aantal_polen+"P - "+this.props.amperage+"A")+"</text>",(this.props.curve_automaat=="B"||this.props.curve_automaat=="C"||this.props.curve_automaat=="D"||this.props.curve_automaat=="U")&&(++s,t.data+='<text x="31" y="'+(40+(s-1)*11)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Curve "+this.props.curve_automaat)+"</text>"),this.props.kortsluitvermogen!="")if(this.props.huishoudelijk){s=s+1.3,t.data+='<text x="31" y="'+(40+(s-1)*11)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+ie(this.props.kortsluitvermogen)*1e3)+"</text>";let a=ee(y(""+ie(this.props.kortsluitvermogen)*1e3))+6;t.data+='<rect x="'+(31-a/2)+'" y="'+(40+(s-1)*11-10)+'" width="'+a+'" height="'+11*1.2+'" fill="none" stroke="black" />'}else s=s+1,t.data+='<text x="31" y="'+(40+(s-1)*11)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+this.props.kortsluitvermogen)+"kA</text>";s=e.bind(this)(s,t);break;case"differentieel":if(s=2,t.data+='<use xlink:href="#zekering_automatisch_horizontaal" x="21" y="25" /><text x="31" y="40" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">Δ'+y(this.props.differentieel_delta_amperage+"mA")+'</text><text x="31" y="51" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.aantal_polen+"P - "+this.props.amperage+"A")+"</text>",(this.props.type_differentieel=="A"||this.props.type_differentieel=="B")&&(++s,t.data+='<text x="31" y="'+(40+(s-1)*11)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Type "+this.props.type_differentieel)+"</text>"),this.props.kortsluitvermogen!="")if(this.props.huishoudelijk){s=s+1.3,t.data+='<text x="31" y="'+(40+(s-1)*11)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+ie(this.props.kortsluitvermogen)*1e3)+"</text>";let a=ee(y(""+ie(this.props.kortsluitvermogen)*1e3))+6;t.data+='<rect x="'+(31-a/2)+'" y="'+(40+(s-1)*11-10)+'" width="'+a+'" height="'+11*1.2+'" fill="none" stroke="black" />'}else s=s+1,t.data+='<text x="31" y="'+(40+(s-1)*11)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+this.props.kortsluitvermogen)+"kA</text>";s=e.bind(this)(s,t);break;case"differentieelautomaat":if(s=2,t.data+='<use xlink:href="#zekering_automatisch_horizontaal" x="21" y="25" /><text x="31" y="40" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">Δ'+y(this.props.differentieel_delta_amperage+"mA")+'</text><text x="31" y="51" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.aantal_polen+"P - "+this.props.amperage+"A")+"</text>",(this.props.curve_automaat=="B"||this.props.curve_automaat=="C"||this.props.curve_automaat=="D"||this.props.curve_automaat=="U")&&(++s,t.data+='<text x="31" y="'+(40+(s-1)*11)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Curve "+this.props.curve_automaat)+"</text>"),(this.props.type_differentieel=="A"||this.props.type_differentieel=="B")&&(++s,t.data+='<text x="31" y="'+(40+(s-1)*11)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y("Type "+this.props.type_differentieel)+"</text>"),this.props.kortsluitvermogen!="")if(this.props.huishoudelijk){s=s+1.3,t.data+='<text x="31" y="'+(40+(s-1)*11)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+ie(this.props.kortsluitvermogen)*1e3)+"</text>";let a=ee(y(""+ie(this.props.kortsluitvermogen)*1e3))+6;t.data+='<rect x="'+(31-a/2)+'" y="'+(40+(s-1)*11-10)+'" width="'+a+'" height="'+11*1.2+'" fill="none" stroke="black" />'}else s=s+1,t.data+='<text x="31" y="'+(40+(s-1)*11)+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(""+this.props.kortsluitvermogen)+"kA</text>";s=e.bind(this)(s,t);break;case"smelt":s=1.4,t.data+='<use xlink:href="#zekering_smelt_horizontaal" x="21" y="25" /><text x="35" y="45" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.aantal_polen+"P - "+this.props.amperage+"A")+"</text>",s=e.bind(this)(s,t);break}return t.ydown=t.ydown+11*(s-1),this.props.differentieel_is_selectief&&(t.data+='<line x1="'+(t.xright+2)+'" x2="'+(t.xright+2+30)+'" y1="25" y2="25" stroke="black" /><rect x="'+(t.xright+8)+'" y="32" width="16" height="16" stroke="black" fill="white" /><text x="'+(t.xright+16)+'" y="44" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">S</text>',t.xright=t.xright+30),this.props.newPage&&(t.data=`<svg newPage="true" x="0" y="0" width="${t.xleft+t.xright}" height="${t.yup+t.ydown}">`+t.data+"</svg>"),t}}class Xi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15),this.props.symbool=this.getLegacyKey(e,16)}resetProps(){this.clearProps(),this.props.type="Zeldzame symbolen",this.props.adres="",this.props.symbool=""}overrideKeys(){this.props.symbool!=="deurslot"&&(this.props.adres="")}toHTML(e){this.overrideKeys();let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+"Symbool: "+this.selectPropToHTML("symbool",["","aarding","deurslot"]),this.props.symbool==="deurslot"&&(t+=", Adres/tekst: "+this.stringPropToHTML("adres",5)),t}toSVG(e=!1){let t=new H;switch(k.addSymbol("deurslot"),t.xleft=1,t.xright=59,t.yup=25,t.ydown=25,this.props.symbool){case"aarding":let s=20;t.data+=`<line x1="1" y1="25" x2="${s+.5}" y2="25" stroke="black"></line><line x1="`+s+'" y1="'+t.yup+'" x2="'+s+'" y2="'+(t.yup+10)+'" stroke="black" /><line x1="'+(s-10)+'" y1="'+(t.yup+10)+'" x2="'+(s+10)+'" y2="'+(t.yup+10)+'" stroke="black" /><line x1="'+(s-7.5)+'" y1="'+(t.yup+13)+'" x2="'+(s+7.5)+'" y2="'+(t.yup+13)+'" stroke="black" /><line x1="'+(s-5)+'" y1="'+(t.yup+16)+'" x2="'+(s+5)+'" y2="'+(t.yup+16)+'" stroke="black" />',this.heeftVerbruikerAlsKind()&&!e&&(t.data+=`<line x1="${s+.5}" y1="25" x2="${s+10}" y2="25" stroke="black" />`),t.xright=28;break;case"deurslot":t.data+=(e?"":'<line x1="1" y1="25" x2="21.5" y2="25" stroke="black"></line>')+'<use xlink:href="#deurslot" x="21" y="25"></use>',t.xright=58,t.data+=this.addAddressToSVG(t,55,10,2);break;default:t.data+=e?"":'<line x1="1" y1="25" x2="21" y2="25" stroke="black"></line>',t.xright=-1;break}return t}}class Yi extends B{convertLegacyKeys(e){this.props.type=this.getLegacyKey(e,0),this.props.aantal=this.getLegacyKey(e,4),this.props.nr=this.getLegacyKey(e,10),this.props.adres=this.getLegacyKey(e,15)}resetProps(){this.clearProps(),this.props.type="Zonnepaneel",this.props.aantal="1",this.props.adres="",this.props.symbool="driehoek"}overrideKeys(){this.props.symbool==null&&(this.props.symbool="driehoek")}toHTML(e){this.overrideKeys();let t=this.toHTMLHeader(e);return t+="&nbsp;"+this.nrToHtml()+" Aantal: "+this.selectPropToHTML("aantal",["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"])+", Symbool: "+this.selectPropToHTML("symbool",["driehoek","pijltjes"])+", Adres/tekst: "+this.stringPropToHTML("adres",5),t}toSVG(e=!1){let t=new H;switch(t.xleft=1,t.xright=69,t.yup=35,t.ydown=25,t.data+=e?"":'<line x1="1" y1="35" x2="21" y2="35" stroke="black"></line>',this.props.symbool){case"driehoek":t.data+='<use xlink:href="#zonnepaneel_driehoek" x="21" y="35"></use>',k.addSymbol("zonnepaneel_driehoek");break;case"pijltjes":default:t.data+='<use xlink:href="#zonnepaneel" x="21" y="35"></use>',k.addSymbol("arrow"),k.addSymbol("zonnepaneel");break}return t.data+='<text x="45" y="9" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(this.props.aantal)+"x</text>",t.data+=e?"":this.addAddressToSVG(t,70,15),t}}class Qi{constructor(){this.filename="eendraadschema.eds",this.owner="Voornaam Achternaam<br>Straat 0<br>0000 gemeente<br>Tel: +32 00 00 00 00<br>GSM: +32 000 00 00 00<br>e-mail: voornaam.achternaam@domein.be",this.installer="idem",this.control="",this.dpi=300,this.info="1 x 230V + N ~50 Hz",this.currentView="config",this.legacySchakelaars=null}setFilename(e){this.filename=e}}class qt{constructor(){var e,t;this.height=0,this.start=0,this.stop=0,this.info=((t=(e=globalThis.structure)==null?void 0:e.properties)==null?void 0:t.info)!=null?globalThis.structure.properties.info:""}}class ea{constructor(){this.markers=[]}clear(){this.markers=[]}addMarker(e,t,s=!1){this.markers.some(r=>r.depth===e&&r.xpos===t)||this.markers.push({depth:e,xpos:t,forceNewPage:s})}sort(){this.markers.sort((e,t)=>e.xpos-t.xpos)}findMinDepth(e,t){const s=this.markers.filter(a=>a.xpos>e&&a.xpos<=t);return s.length===0?{depth:null,xpos:t}:s.reduce((a,r)=>r.depth<a.depth||r.depth===a.depth&&r.xpos>a.xpos?r:a,s[0])}findForceNewPage(e,t){const s=this.markers.find(a=>a.xpos>e&&a.xpos<=t&&a.forceNewPage);return s?{depth:s.depth,xpos:s.xpos}:null}}class et{constructor(){this.height=0,this.maxwidth=0,this.displaypage=0,this.enableAutopage=!0,this.printPageMode="all",this.printPageRange="",this.pages=new Array,this.pages.push(new qt),this.pagemarkers=new ea}setPaperSize(e){this.papersize=e==="A3"?"A3":"A4"}getPaperSize(){return this.papersize||(this.papersize="A4"),this.papersize}setHeight(e){this.height=e,this.pages.forEach(t=>{t.height=e})}getHeight(){return this.height}setModeVertical(e){this.modevertical=e==="kies"?"kies":"alles",this.forceCorrectFigures()}getModeVertical(){return this.forceCorrectFigures(),this.modevertical}forceCorrectFigures(){switch(this.modevertical||(this.modevertical="alles"),this.modevertical){case"kies":this.starty=Math.min(Math.max(0,this.starty),this.height),this.stopy=Math.min(Math.max(this.starty,this.stopy),this.height);break;default:this.starty=0,this.stopy=this.height}this.pages[this.pages.length-1].stop=this.maxwidth,this.pages.forEach((e,t)=>{e.stop<0&&(e.stop=0),e.start<0&&(e.start=0),t>0&&(e.start=this.pages[t-1].stop),e.stop>this.maxwidth&&(this.pages[this.pages.length-1].stop=this.maxwidth),e.start>e.stop&&(e.start=e.stop)})}setMaxWidth(e){this.maxwidth=e,this.forceCorrectFigures()}getMaxWidth(){return this.maxwidth}getstarty(){return this.forceCorrectFigures(),this.starty}getstopy(){return this.forceCorrectFigures(),this.stopy}setstarty(e){this.starty=e,this.forceCorrectFigures}setstopy(e){this.stopy=e,this.forceCorrectFigures}setStop(e,t){e>0&&t<this.pages[e-1].stop&&(t=this.pages[e-1].stop),e<this.pages.length-1&&t>this.pages[e+1].stop&&(t=this.pages[e+1].stop),t>this.maxwidth&&(t=this.maxwidth),this.pages[e].stop=t,this.forceCorrectFigures()}autopage(){this.pages.forEach((o,c)=>{o.stop=this.maxwidth});let t=(this.getstopy()-this.getstarty())*(this.getPaperSize()=="A3"?1.6878:1.8467),s=3/4*t,a=0,r=0,n=null;if(t>0)for(;(n=this.pagemarkers.findForceNewPage(r,r+t))!=null||this.maxwidth-r>t;){for(n?r=n.xpos:r=this.pagemarkers.findMinDepth(r+s,r+t).xpos;this.pages.length<a+2;)this.addPage();this.setStop(a,r),a++}this.setStop(a,this.maxwidth);for(let o=this.pages.length-1;o>a;o--)this.deletePage(o)}addPage(){var e;e=new qt,e.height=this.height,e.start=this.pages[this.pages.length-1].stop,e.stop=this.maxwidth,this.pages.push(e)}deletePage(e){e==0?this.pages[1].start=0:this.pages[e-1].stop=this.pages[e].stop,this.pages.splice(e,1)}insertHTMLselectPaperSize(e,t){var s=document.createElement("select");s.id="select_papersize_input";var a=document.createElement("option");a.value="A4",a.textContent="A4";var r=document.createElement("option");r.value="A3",r.textContent="A3",this.papersize=="A3"?r.selected=!0:a.selected=!0,s.appendChild(a),s.appendChild(r),s.onchange=n=>{this.setPaperSize(n.target.value),t()},e.appendChild(s)}insertHTMLselectdpi(e,t){var s=document.createElement("select");s.id="select_dpi_input";var a=document.createElement("option");a.value="300",a.textContent="300dpi (standaard)";var r=document.createElement("option");r.value="600",r.textContent="600dpi (beter maar trager)",typeof globalThis.structure.properties.dpi=="undefined"&&(globalThis.structure.properties.dpi=300),globalThis.structure.properties.dpi==600?r.selected=!0:a.selected=!0,s.appendChild(a),s.appendChild(r),s.onchange=n=>{globalThis.structure.properties.dpi=parseInt(n.target.value,0)},e.appendChild(s)}insertHTMLselectPageRange(e,t){var d,h;const s=document.createElement("div");s.style.margin="1em 0",s.innerHTML=`<label for="print_page_mode"><b>Pagina's:</b></label><select id="print_page_mode" style="margin-left:0.5em;"><option value="all">Alles</option><option value="custom">Aangepast</option></select><input type="text" id="print_page_range" style="margin-left:0.5em;width:120px;" placeholder="bijv. 1-2, 4"><span id="print_range_error" style="color:red;display:none;margin-left:0.5em;">Ongeldige invoer!</span>`;const a=s.querySelector("#print_page_mode"),r=s.querySelector("#print_page_range"),n=s.querySelector("#print_range_error"),o=(d=this.printPageMode)!=null?d:"all",c=(h=this.printPageRange)!=null?h:"";a.value=o,r.value=c,r.style.display=o==="custom"?"":"none";const l=()=>{const p=globalThis.structure.print_table.pages.length+(globalThis.structure.sitplan?globalThis.structure.sitplan.getNumPages():0),[u,g]=et.isValidPageRange(r.value,p);u?(n.style.display="none",n.textContent=""):(n.style.display="",n.textContent=g)};a.addEventListener("change",()=>{this.printPageMode=a.value,a.value==="custom"?r.style.display="":(r.style.display="none",r.value="",n.style.display="none",this.printPageRange=""),l()}),r.addEventListener("input",()=>{this.printPageRange=r.value,l()}),l(),e.appendChild(s)}static isValidPageRange(e,t){if(e.trim()==="")return[!0,""];if(!/^[\d\s,\-]*$/.test(e))return[!1,"Ongeldige invoer: alleen cijfers, spaties, komma's en streepjes toegestaan."];const s=e.split(",").map(r=>r.trim());let a=0;for(const r of s)if(r!=="")if(r.includes("-")){const[n,o]=r.split("-").map(d=>d.trim());if(!/^\d+$/.test(n)||!/^\d+$/.test(o))return[!1,`Ongeldige invoer: niet-geheel getal in bereik (${r})`];const c=Number(n),l=Number(o);if(!Number.isInteger(c)||!Number.isInteger(l))return[!1,`Ongeldige invoer: niet-geheel getal in bereik (${r})`];if(c<1||l>t)return[!1,`Ongeldige invoer: pagina buiten bereik (${r}), toegestaan: 1-${t}`];if(c>l)return[!1,`Ongeldige invoer: startpagina groter dan eindpagina (${r})`];if(c<=a)return[!1,`Ongeldige invoer: overlappende of niet-oplopende pagina's (${r})`];a=l}else{if(!/^\d+$/.test(r))return[!1,`Ongeldige invoer: niet-geheel getal (${r})`];const n=Number(r);if(!Number.isInteger(n))return[!1,`Ongeldige invoer: niet-geheel getal (${r})`];if(n<1||n>t)return[!1,`Ongeldige invoer: pagina buiten bereik (${r}), toegestaan: 1-${t}`];if(n<=a)return[!1,`Ongeldige invoer: overlappende of niet-oplopende pagina's (${r})`];a=n}return[!0,""]}canPrint(){var a;const e=globalThis.structure.print_table.pages.length+(globalThis.structure.sitplan?globalThis.structure.sitplan.getNumPages():0),[t,s]=et.isValidPageRange((a=this.printPageRange)!=null?a:"",e);return t}insertHTMLcheckAutopage(e,t){var s=document.createElement("input");s.type="checkbox",s.id="autopage",s.name="autopage";var a=document.createElement("label");a.htmlFor="autopage",a.textContent="Eéndraadschema handmatig over pagina's verdelen",this.enableAutopage?(this.setModeVertical("alles"),this.autopage()):s.checked=!0,e.append(s),e.append(a),s.onchange=r=>{this.enableAutopage=!r.target.checked,this.enableAutopage||this.pages.forEach(n=>{n.info=globalThis.structure.properties.info}),t()}}insertHTMLchooseVerticals(e,t){let s="";switch(this.modevertical){case"kies":s+='Hoogte <select id="select_modeVertical"><option value="alles">Alles (standaard)</option><option value="kies" selected="Selected">Kies (expert)</option></select>',s+="&nbsp;&nbsp;StartY ",s+='<input size="4" id="input_starty" type="number" min="0" step="1" max="'+this.getHeight()+'" value="'+this.getstarty()+'">',s+="&nbsp;&nbsp;StopY ",s+='<input size="4" id="input_stopy" type="number" min="0" step="1" max="'+this.getHeight()+'" value="'+this.getstopy()+'">';break;case"alles":default:s+='Hoogte <select id="select_modeVertical"><option value="alles">Alles (standaard)</option><option value="kies">Kies (expert)</option></select>'}e.insertAdjacentHTML("beforeend",s),document.getElementById("select_modeVertical").onchange=a=>{this.setModeVertical(a.target.value),t()},this.modevertical=="kies"&&(document.getElementById("input_starty").onchange=a=>{let r=parseInt(a.target.value);isNaN(r)&&(r=0),this.setstarty(r),this.forceCorrectFigures(),t()},document.getElementById("input_stopy").onchange=a=>{let r=parseInt(a.target.value);isNaN(r)&&(r=this.getHeight()),this.setstopy(r),this.forceCorrectFigures(),t()})}insertHTMLsuggestXposButton(e,t){var s=document.createElement("button");s.innerText="Suggereer X-posities",e.append(s),s.onclick=()=>{this.autopage(),t()}}insertHTMLposxTable(e,t){globalThis.structure.print_table.enableAutopage&&this.autopage();let s="",a;for(s+='<table border="1" cellpadding="3">',s+='<tr><th align="center">Pagina</th><th align="center">Startx</th><th align="center">Stopx</th><th align="left">Info</th><th align="left">Acties</th></tr>',a=0;a<this.pages.length;a++)s+="<tr><td align=center>"+(a+1)+"</td><td align=center>"+this.pages[a].start+"</td><td align=center>",a!=this.pages.length-1?s+='<input size="5" id="input_stop_'+a+'" type="number" min="'+this.pages[a].start+'" step="1" max="'+this.maxwidth+'" value="'+this.pages[a].stop+'">':s+=this.pages[a].stop.toString(),s+='</td><td><div style="width:200px; border-style:solid; border-width:thin; cursor:text; padding: 2px; border-color:darkgray; font-size: small;" align=left contenteditable="true" id="input_info_'+a+'">',s+=this.pages[a].info,s+="</div></td><td align=left>",a==this.pages.length-1&&(s+='<button style="background-color:green;" id="Btn_Addpage">&#9660;</button>'),this.pages.length>1&&(s+='<button style="background-color:red;" id="Btn_Deletepage_'+a+'">&#9851;</button>'),s+="</td></tr>";s+="</table>",e.insertAdjacentHTML("beforeend",s),document.getElementById("Btn_Addpage").onclick=()=>{this.addPage(),t()},document.querySelectorAll('button[id^="Btn_Deletepage_"]').forEach(r=>{const n=r.id.match(/Btn_Deletepage_(\d+)/);if(n){const o=parseInt(n[1]);r.onclick=()=>{this.deletePage(o),t()}}}),document.querySelectorAll('input[id^="input_stop_"]').forEach(r=>{r.addEventListener("change",n=>{const o=n.target.id.match(/input_stop_(\d+)/);if(o){const c=parseInt(o[1]),l=parseInt(n.target.value);this.setStop(c,l),t()}})}),document.querySelectorAll('div[id^="input_info_"]').forEach(r=>{r.addEventListener("blur",n=>{const o=n.target.id.match(/input_info_(\d+)/);if(o){const c=parseInt(o[1]),l=n.target.innerHTML;this.pages[c].info=l}})})}}function ta(i,e,t){const s=t*Math.PI/180,a=Math.cos(s),r=Math.sin(s),n=Math.abs(i*a)+Math.abs(e*r),o=Math.abs(i*r)+Math.abs(e*a);return{width:n,height:o}}function sa(i,e,t){t=Math.abs(t)%180,t>90&&(t=180-t);const s=t*Math.PI/180,a=Math.cos(s),r=Math.sin(s);return{width:Math.min(i/a,e/r),height:Math.min(i/r,e/a)}}let ot=null;function Jt(){if(ot===null){const i=document.createElement("div");i.style.width="10mm",i.style.position="absolute",document.body.appendChild(i);const e=i.offsetWidth;document.body.removeChild(i),ot=e/10}return ot}class Mt{constructor(){this.activePage=1,this.numPages=1,this.elements=[],this.defaults={fontsize:11,scale:globalThis.SITPLANVIEW_DEFAULT_SCALE,rotate:0}}dispose(){this.elements=[],this.numPages=1,this.activePage=1,this.defaults={fontsize:11,scale:globalThis.SITPLANVIEW_DEFAULT_SCALE,rotate:0}}getElements(){return this.elements}getNumPages(){return this.elements.length>0?this.numPages:0}heeftEenzameSchakelaars(){var e=this.elements.filter(function(t){if(t.isEendraadschemaSymbool()){let s=globalThis.structure.getElectroItemById(t.getElectroItemId());if(s!=null&&s.props.type=="Schakelaars"&&(s.props.aantal_schakelaars==1||s.props.aantal_schakelaars==null))return!0}});return e.length>1}dropLegacySchakelaars(){for(let e of this.elements)if(e.isEendraadschemaSymbool()){let t=globalThis.structure.getElectroItemById(e.getElectroItemId());t!=null&&t.props.type=="Schakelaars"&&(t.props.aantal_schakelaars==1||t.props.aantal_schakelaars==null)&&(e.rotate=0)}}addElement(e){this.elements.push(e)}addElementFromFile(e,t,s,a,r){let n=new Se;return n.setVars({page:t,posx:s,posy:a,labelfontsize:this.defaults.fontsize,scale:this.defaults.scale,rotate:this.defaults.rotate}),n.importFromFile(e,r),this.elements.push(n),n}addElementFromElectroItem(e,t,s,a,r,n,o,c,l,d){const h=globalThis.structure.getElectroItemById(e);if(!h)return null;const p=h.toSituationPlanElement();return Object.assign(p,{page:t,posx:s,posy:a,labelfontsize:c,scale:l,rotate:d}),p.setElectroItemId(e),p.setAdres(r,n,o),this.elements.push(p),p}removeElement(e){if(e.isEendraadschemaSymbool()){const s=e.getElectroItemId(),a=globalThis.structure.getElectroItemById(s);a!=null&&a.getParent()instanceof Qe&&globalThis.structure.deleteById(a.id)}const t=this.elements.indexOf(e);t!==-1&&(this.elements.splice(t,1),e.boxref!=null&&e.boxref.remove(),e.boxlabelref!=null&&e.boxlabelref.remove(),this.removeElement(e))}syncToEendraadSchema(){for(let e of this.elements)if(e.electroItemId!=null&&globalThis.structure.getElectroItemById(e.getElectroItemId())==null){this.removeElement(e),this.syncToEendraadSchema();return}}orderByZIndex(){this.elements.sort((e,t)=>{let s=e.boxref==null||e.boxref.style.zIndex===""?0:parseInt(e.boxref.style.zIndex),a=t.boxref==null||t.boxref.style.zIndex===""?0:parseInt(t.boxref.style.zIndex);return s-a})}fromJsonObject(e){this.dispose(),e.numPages!==void 0?this.numPages=e.numPages:this.numPages=1,e.activePage!==void 0?this.activePage=e.activePage:this.activePage=1,e.defaults!==void 0&&Object.assign(this.defaults,e.defaults),Array.isArray(e.elements)?this.elements=e.elements.map(t=>{const s=new Se;return s.fromJsonObject(t),s}):this.elements=[]}toJsonObject(){this.orderByZIndex();let e=[];for(let t of this.elements)e.push(t.toJsonObject());return{numPages:this.numPages,activePage:this.activePage,defaults:this.defaults,elements:e}}countByElectroItemId(e){return this.elements.filter(t=>t.getElectroItemId()===e).length}toSitPlanPrint(e=!1){this.syncToEendraadSchema(),this.orderByZIndex();let t={};t.numpages=this.elements.length>0?globalThis.structure.sitplan.numPages:0,t.pages=[];for(let s=0;s<t.numpages;s++){let a="",r=Jt()*277,n=Jt()*150,o=0,c=0;for(let l of this.elements)if(l.page==s+1&&l.visible!==!1){let d=l.labelfontsize!=null?l.labelfontsize:11;if(a+=l.getScaledSVG(!0),e){let p=ta(l.sizex*l.getscale(),l.sizey*l.getscale(),l.rotate);r=Math.max(r,l.posx+p.width/2),n=Math.max(n,l.posy+p.height/2),o=Math.min(o,l.posx-p.width/2),c=Math.min(c,l.posy-p.height/2)}let h=l.getAdres();a+=`<text x="${l.labelposx}" y="${l.labelposy}" font-size="${d}" fill="black" text-anchor="middle" dominant-baseline="middle">${y(h)}</text>`}a=`<svg xmlns="http://www.w3.org/2000/svg" width="${r-o}px" height="${n-c}px" viewBox="${o} ${c} ${r-o} ${n-c}">${a}</svg>`,t.pages.push({sizex:r-o,sizey:n-c,svg:a})}return t}}class fs{constructor(){this.currentView="",this.idToOrdinalMap=null,this.length=0,this.data=new Array,this.active=new Array,this.id=new Array,this.print_table=new et,this.properties=new Qi,this.curid=1,this.mode="edit",this.sitplan=new Mt}dispose(){this.sitplanview!=null&&this.sitplanview.dispose()}reSort(){let e=()=>{if(this.length<=1)return!0;let o=[],c=0;for(let l=0;l<this.length;l++)if(this.active[l]){let d=this.data[l].parent;if(d==c)o.push(c),c=this.id[l];else{for(;o.length>0&&o[o.length-1]!==d;)o.pop();if(o.length===0)return!1;c=this.id[l]}}else return!1;return!0},t=(o=0,c=[])=>{for(let l=0;l<this.length;l++)this.active[l]&&this.data[l].parent==o&&(c.push(l),t(this.id[l],c));return c};if(e())return;let s=t(),a=[],r=[],n=[];for(let o=0;o<s.length;o++)a.push(this.data[s[o]]),r.push(this.active[s[o]]),n.push(this.id[s[o]]);this.data=a,this.active=r,this.id=n,this.length=s.length,this.idToOrdinalMap=null}buildIdToOrdinalMap(){this.idToOrdinalMap=new Map;for(let e=0;e<this.length;e++)this.active[e]&&this.idToOrdinalMap.set(this.id[e],e)}getOrdinalById(e){function t(a){return a==null||a>=this.length||!this.active[a]||this.id[a]!==e}if(e===0)return null;this.idToOrdinalMap===null&&this.buildIdToOrdinalMap();let s=this.idToOrdinalMap.get(e);return t.call(this,s)&&(this.buildIdToOrdinalMap(),s=this.idToOrdinalMap.get(e),t.call(this,s))?null:s}getElectroItemById(e){if(e===null||e===0)return null;let t=this.getOrdinalById(e);return t!==null?this.data[t]:null}getNumChilds(e){let t=0;for(let s=0;s<this.length;s++)this.data[s].parent==e&&this.active[s]&&!this.data[s].isAttribuut()&&t++;return t}getFirstChildId(e){for(let t=0;t<this.length;t++)if(this.active[t]&&this.data[t].parent==e&&!this.data[t].isAttribuut())return this.id[t];return null}getMaxNumChilds(e){let t=this.getOrdinalById(e);return t===null?0:this.data[t].getMaxNumChilds()}createContainerIfNotExists(){for(let t=0;t<this.length;t++)if(this.active[t]&&this.data[t].parent===0&&this.data[t]instanceof Qe)return this.data[t];let e=this.addItem("Container");return e.parent=0,e}createItem(e){let t;switch(e){case"Aansluiting":t=new pi(this);break;case"Aansluitpunt":case"Leeg":t=new ui(this);break;case"Aardingsonderbreker":t=new gi(this);break;case"Aftakdoos":t=new Gt(this);break;case"Batterij":t=new fi(this);break;case"Bel":t=new mi(this);break;case"Boiler":t=new yi(this);break;case"Bord":t=new yt(this);break;case"Container":t=new Qe(this);break;case"Diepvriezer":t=new ki(this);break;case"Domotica":t=new xi(this);break;case"Domotica module (verticaal)":t=new vi(this);break;case"Domotica gestuurde verbruiker":t=new wi(this);break;case"Droogkast":t=new _i(this);break;case"Drukknop":t=new Ft(this);break;case"Elektriciteitsmeter":t=new Ti(this);break;case"Elektrische oven":t=new Si(this);break;case"EV lader":t=new Li(this);break;case"Ketel":t=new Ei(this);break;case"Koelkast":t=new Ii(this);break;case"Kookfornuis":t=new Ai(this);break;case"Kring":t=new us(this);break;case"Leiding":t=new Pi(this);break;case"Lichtcircuit":t=new Ki(this);break;case"Lichtpunt":t=new gs(this);break;case"Meerdere verbruikers":t=new Ci(this);break;case"Media":t=new Mi(this);break;case"Microgolfoven":t=new Hi(this);break;case"Motor":t=new Bi(this);break;case"Omvormer":t=new Wt(this);break;case"Overspanningsbeveiliging":t=new zi(this);break;case"Schakelaars":t=new _e(this);break;case"Splitsing":t=new Ni(this);break;case"Stoomoven":t=new Oi(this);break;case"Contactdoos":t=new bi(this);break;case"Transformator":t=new Vi(this);break;case"USB lader":t=new Di(this);break;case"Vaatwasmachine":t=new $i(this);break;case"Ventilator":t=new ji(this);break;case"Verbruiker":t=new Ri(this);break;case"Verlenging":t=new Ui(this);break;case"Verwarmingstoestel":t=new Gi(this);break;case"Vrije ruimte":t=new Fi(this);break;case"Vrije tekst":t=new Wi(this);break;case"Warmtepomp/airco":t=new qi(this);break;case"Wasmachine":t=new Ji(this);break;case"Zeldzame symbolen":t=new Xi(this);break;case"Zekering/differentieel":t=new Zi(this);break;case"Zonnepaneel":t=new Yi(this);break;default:t=new B(this)}return t.id=this.curid,t.parent=0,t.indent=0,t}addItem(e){let t=this.createItem(e);return this.data.push(t),this.active.push(!0),this.id.push(this.curid),this.curid+=1,this.length+=1,this.idToOrdinalMap=null,t}insertItemBeforeId(e,t){for(let s=0;s<this.length;s++)if(this.id[s]==t){e.id=this.curid,e.parent=this.data[s].parent,e.indent=this.data[s].indent,e.collapsed=!1,this.data.splice(s,0,e),this.active.splice(s,0,!0),this.id.splice(s,0,this.curid),this.curid+=1,this.length+=1;break}this.reSort()}insertItemAfterId(e,t){for(let s=0;s<this.length;s++)if(this.id[s]==t)return e.id=this.curid,e.parent=this.data[s].parent,e.indent=this.data[s].indent,e.collapsed=!1,this.data.splice(s+1,0,e),this.active.splice(s+1,0,!0),this.id.splice(s+1,0,this.curid),this.curid+=1,this.length+=1,s+1;this.reSort()}insertChildAfterId(e,t){let s=this.getNumChilds(t),a=this.getMaxNumChilds(t);if(s<a||e.isAttribuut()){let r=this.insertItemAfterId(e,t);this.data[r].parent=t,this.data[r].indent=this.data[r-1].indent+1}else alert("Het maximum aantal kinderen van dit element is "+a);this.reSort()}moveUp(e){let t=this.getOrdinalById(e);if(t===null)return;let s=t,a=this.data[t].parent;for(let o=t-1;o>=0;o--)if(this.data[o].parent==a&&this.active[o]&&!this.data[o].isAttribuut()){s=o;break}let r=new ft(this);r=this.data[t],this.data[t]=this.data[s],this.data[s]=r;let n=this.id[t];this.id[t]=this.id[s],this.id[s]=n,this.reSort()}moveDown(e){let t=this.getOrdinalById(e);if(t===null)return;let s=t,a=this.data[t].parent;for(let o=t+1;o<this.length;o++)if(this.data[o].parent==a&&this.active[o]&&!this.data[o].isAttribuut()){s=o;break}let r=new ft(this);r=this.data[t],this.data[t]=this.data[s],this.data[s]=r;let n=this.id[t];this.id[t]=this.id[s],this.id[s]=n,this.reSort()}clone(e,t){let s=this.getOrdinalById(e);if(s===null)return;arguments.length<2&&(t=this.data[s].parent);let a=this.createItem(this.data[s].getType());a.clone(this.data[s]),arguments.length<2?this.insertItemAfterId(a,e):this.insertChildAfterId(a,t);let r=this.curid-1,n=this.getOrdinalById(r);if(s=this.getOrdinalById(e),s===null||n===null)return;this.data[n].collapsed=this.data[s].collapsed;let o=new Array;for(let c=0;c<this.length;c++)if(this.id[c]==e)for(let l=this.length-1;l>=0;l--)this.data[l].parent==e&&o.push(this.id[l]);for(let c=0;c<o.length;c++)this.clone(o[c],r);this.reSort()}cloneRelativeToId(e,t,s){const a=this.getOrdinalById(e),r=this.getOrdinalById(t);if(a===null||r===null)return null;const n=this.data[a];if(n==null)return null;const o=this.createItem(n.getType());o.clone(this.data[a]),s==="before"?this.insertItemBeforeId(o,t):this.insertItemAfterId(o,t);const c=this.curid-1,l=this.getOrdinalById(c);l!==null&&(this.data[l].collapsed=this.data[a].collapsed);let d=[];for(let h=this.length-1;h>=0;h--)this.data[h].parent===e&&d.push(this.id[h]);for(let h=0;h<d.length;h++)this.clone(d[h],c);return this.reSort(),c}moveSubtreeRelativeToId(e,t,s,a=!1){var E,f,m,x,w,P,A,S,N,W,M,L,j,C,q,K,O,Z,te,Y,G;if(e===t)return!1;this.idToOrdinalMap=null;const r=this.getOrdinalById(e),n=this.getOrdinalById(t);if(r===null||n===null)return!1;const o=(f=(E=this.data[r])==null?void 0:E.indent)!=null?f:0;let c=r+1;for(;c<this.length&&!(((x=(m=this.data[c])==null?void 0:m.indent)!=null?x:0)<=o);)c++;for(let R=r;R<c;R++)if(this.id[R]===t)return!1;const l=this.data.splice(r,c-r),d=this.active.splice(r,c-r),h=this.id.splice(r,c-r);this.idToOrdinalMap=null;const p=this.getOrdinalById(t);if(p===null)return this.data.splice(r,0,...l),this.active.splice(r,0,...d),this.id.splice(r,0,...h),this.idToOrdinalMap=null,!1;const u=(P=(w=this.data[p])==null?void 0:w.indent)!=null?P:0;let g=p+1;for(;g<this.length&&!(((S=(A=this.data[g])==null?void 0:A.indent)!=null?S:0)<=u);)g++;const b=s==="before"?p:g,_=(W=(N=l[0])==null?void 0:N.indent)!=null?W:0;let v=_,T=(L=(M=l[0])==null?void 0:M.parent)!=null?L:0;if(a){if(T=t,v=((C=(j=this.data[p])==null?void 0:j.indent)!=null?C:0)+1,((K=(q=l[0])==null?void 0:q.parent)!=null?K:0)!==T){const $=this.getElectroItemById(T);if($&&typeof $.checkInsertChild=="function"&&!$.checkInsertChild())return this.data.splice(r,0,...l),this.active.splice(r,0,...d),this.id.splice(r,0,...h),this.idToOrdinalMap=null,!1}}else T=(Z=(O=this.data[p])==null?void 0:O.parent)!=null?Z:0,v=(Y=(te=this.data[p])==null?void 0:te.indent)!=null?Y:0;const U=v-_;for(let R=0;R<l.length;R++)l[R].indent=((G=l[R].indent)!=null?G:0)+U;return l[0].parent=T,this.data.splice(b,0,...l),this.active.splice(b,0,...d),this.id.splice(b,0,...h),this.idToOrdinalMap=null,this.reSort(),!0}deleteById(e){for(let t=0;t<this.length;t++)if(this.id[t]==e){this.active[t]=!1;for(let s=0;s<this.length;s++)this.data[s].parent==e&&this.deleteById(this.id[s])}this.reSort()}adjustTypeByOrdinal(e,t){let s=this.createItem(t);Object.assign(s,this.data[e]),s.props.type=t,s.resetProps(),this.data[e]=s}adjustTypeById(e,t){let s=this.getOrdinalById(e);s!==null&&this.adjustTypeByOrdinal(s,t)}tekenVerticaleLijnIndienKindVanKring(e,t){let s=e.getParent();if(s!=null){if(s.getType()=="Kring"){let a=0,r=this.getOrdinalById(e.id);if(r===null)return;for(let n=0;n<e.sourcelist.length;n++)this.active[n]&&this.data[n].parent==s.id&&(a=n);if(e.getType()=="Omvormer"&&e.props.inkring)t.data+='<line x1="'+t.xleft+'" x2="'+t.xleft+'" y1="0" y2="'+(t.yup-5+.5)+'" stroke="black" />',t.data+='<line x1="'+t.xleft+'" x2="'+t.xleft+'" y1="'+(t.yup+5-.5)+'" y2="'+(t.yup+t.ydown)+'" stroke="black" />';else{let n,o;r<a?(n=0,o=t.yup+t.ydown):(n=t.yup,o=t.yup+t.ydown),t.data+='<line x1="'+t.xleft+'" x2="'+t.xleft+'" y1="'+n+'" y2="'+o+'" stroke="black" />'}}if(s.getType()=="Kring"||["Domotica module (verticaal)"].includes(s.getType())){let a;a=e.props.nr;let r=t.xleft+9,n=t.yup-5;e.getType()=="Omvormer"&&e.props.inkring&&(n-=5),t.data+='<text x="'+r+'" y="'+n+'" style="text-anchor:middle" font-family="Arial, Helvetica, sans-serif" font-size="10">'+y(a)+"</text>"}}}updateRibbon(){if(this.properties.currentView!="2col")return;let e="";switch(e+=`
            <div class="icon" ${globalThis.undostruct.undoStackSize()>0?'onclick="undoClicked()"':'style="filter: opacity(45%)"'}>
                <img src="gif/undo.png" alt="Ongedaan maken" class="icon-image">
                <span class="icon-text">Ongedaan maken</span>
            </div>
            <div class="icon" ${globalThis.undostruct.redoStackSize()>0?'onclick="redoClicked()"':'style="filter: opacity(45%)"'}>
                <img src="gif/redo.png" alt="Opnieuw" class="icon-image">
                <span class="icon-text">Opnieuw</span>
            </div>
            <span style="display: inline-block; width: 30px;"></span>
        `,e+='<p style="margin-top: 5px;margin-bottom: 5px;">',this.mode){case"edit":e+=`
                        <div>
                            Werkmodus<br>
                            <select id="edit_mode" onchange="HL_editmode()">
                                <option value="edit" selected>Invoegen</option>
                                <option value="move">Verplaatsen/Clone</option>
                            </select>
                        </div>`;break;case"move":e+=`
                        <div>
                            Werkmodus<br>
                            <select id="edit_mode" onchange="HL_editmode()">
                                <option value="edit">Invoegen</option>
                                <option value="move" selected>Verplaatsen/Clone</option>
                            </select>
                        </div>
                        <span style="display: inline-block; width: 30px;"></span>`,e+=`
                        <div style="color:black;font-size:12px"><i>
                            Gebruik de <b>blauwe</b> pijlen om de volgorde van elementen te wijzigen.<br>
                        U kan ook slepen in de boomstructuur via het <b>⋮⋮</b>-handvat.<br>
                            Gebruik het <u>Moeder</u>-veld om een component elders in het schema te hangen.<br>
                            Kies "<b>clone</b>" om een dubbel te maken van een element.
                        </i></div>`;break}const t=globalThis.treeEditInModal===!0?"checked":"";e+=`
            <span style="display: inline-block; width: 30px;"></span>
            <div>
                Boom
                <div style="font-size:12px">
                    <label style="cursor:pointer">
                        <input id="hl_tree_edit_in_modal" type="checkbox" ${t} onchange="HL_toggleTreeEditModal()">
                        Bewerk in venster
                    </label>
                </div>
            </div>
        `,e+="</p>",globalThis.autoSaver&&globalThis.autoSaver.hasChangesSinceLastManualSave()?(e+='<span style="display: inline-block; width: 30px;"></span>',e+=`<div style="margin-top: 5px;margin-bottom: 5px;display: flex; align-items: center; justify-content: center;" class="highlight-warning-big" onclick="saveSchema()"
                           onmouseover="this.style.cursor='pointer'" 
                           onmouseout="this.style.cursor='default'">
                           <div style="display: inline-block; vertical-align: middle;"><span class="icon-image" style="font-size:24px;">💾</span></div>
                           <div style="display: inline-block; vertical-align: middle; margin-left: 10px;">
                               U heeft niet opgeslagen wijzigingen. Klik hier om op te slaan<br>
                               of ga naar het "Bestand"-menu voor meer opties.
                           </div>
                        </div>`):(e+='<span style="display: inline-block; width: 30px;"></span>',e+=`<div style="margin-top: 5px;margin-bottom: 5px;display: flex; align-items: center; justify-content: center;" class="highlight-ok-big" onclick="topMenu.selectMenuItemByName('Bestand')"
                           onmouseover="this.style.cursor='pointer'" 
                           onmouseout="this.style.cursor='default'">
                           <div style="display: inline-block; vertical-align: middle;"><span class="icon-image" style="font-size:24px; filter: grayscale(100%); opacity: 0.5;">💾</span></div>
                           <div style="display: inline-block; vertical-align: middle; margin-left: 10px;">
                               Er zijn geen niet opgeslagen wijzigingen. Ga naar het "Bestand"-menu<br>
                               indien u toch wenst op te slaan.
                           </div>
                        </div>`);const s=document.getElementById("ribbon"),a=`<div id="left-icons">${e}</div>`;s.innerHTML=a}toHTMLinner(e){var d,h,p,u;const t=this.mode==="move"?'<span class="tree-drag-handle" draggable="true" title="Sleep om te verplaatsen">⋮⋮</span>':"",s=globalThis.treeEditInModal===!0,a=this.data[e],r=I((h=(d=a==null?void 0:a.getType)==null?void 0:d.call(a))!=null?h:""),o=y((()=>{var E,f,m,x,w,P,A,S,N,W,M,L,j,C,q;const g=(E=a==null?void 0:a.props)!=null?E:{},b=r!==""?r:"Element",_=I((m=(f=a==null?void 0:a.getReadableAdres)==null?void 0:f.call(a))!=null?m:""),v=I((x=g.naam)!=null?x:""),T=I((w=g.adres)!=null?w:"");if(b==="Bord")return v!==""?`Bord ${v}`:"Bord";if(b==="Kring"){const K=v==="---"?"":v,O=I((P=g.bescherming)!=null?P:""),Z=I((A=g.amperage)!=null?A:""),te=I((S=g.aantal_polen)!=null?S:""),Y=I((N=g.curve_automaat)!=null?N:""),G=I((W=g.differentieel_delta_amperage)!=null?W:"");let R=K!==""?`Kring ${K}`:"Kring",$="";return O!==""&&O!=="geen"?($=O,O==="automatisch"&&Y!==""&&($+=` ${Y}`),te!==""&&($=`${te}P ${$}`),Z!==""&&($+=` ${Z}A`),(O==="differentieel"||O==="differentieelautomaat")&&G!==""&&($+=` Δ${G}mA`)):O==="geen"&&($="geen beveiliging"),$!==""&&(R+=` — ${$}`),T!==""&&(R+=` — @ ${T}`),R}if(b==="Zekering/differentieel"){const K=I((M=g.bescherming)!=null?M:""),O=I((L=g.amperage)!=null?L:""),Z=I((j=g.aantal_polen)!=null?j:""),te=I((C=g.curve_automaat)!=null?C:""),Y=I((q=g.differentieel_delta_amperage)!=null?q:"");let G=_!==""?`Zekering ${_}`:"Zekering",R="";return K!==""&&(R=K,K==="automatisch"&&te!==""&&(R+=` ${te}`),Z!==""&&(R=`${Z}P ${R}`),O!==""&&(R+=` ${O}A`),(K==="differentieel"||K==="differentieelautomaat")&&Y!==""&&(R+=` Δ${Y}mA`)),R!==""&&(G+=` — ${R}`),G}let U=_!==""?`${b} ${_}`:b;return v!==""&&(U+=` — ${v}`),T!==""&&(U+=` — @ ${T}`),U})());let c="";if(s){const g=this.data[e].id;let b="";this.mode!=="move"&&((p=a==null?void 0:a.checkInsertSibling)!=null&&p.call(a)&&(b+=`<button class="button-insertBefore" onclick="HLInsertBefore(${g})"></button>`,b+=`<button class="button-insertAfter" onclick="HLInsertAfter(${g})"></button>`),(u=a==null?void 0:a.checkInsertChild)!=null&&u.call(a)&&(b+=`<button class="button-insertChild" onclick="HLInsertChild(${g})"></button>`)),b+=`<button class="button-delete-garbage-can" onclick="HLDelete(${g})"></button>`,b+="&nbsp;",c=`<span class="hl-quick-actions">${b}</span>`}const l=s?`${c}<span class="hl-open-modal-label" data-hl-open-id="${this.data[e].id}" title="Klik om te bewerken">${o}</span>`:`${this.data[e].toHTML(this.mode)}`;return this.data[e].collapsed?`<tr>
                        <td class="hl-collapse-cell" bgcolor="#8AB2E4" onclick="HLCollapseExpand(${this.data[e].id})" valign= "top"><span class="hl-collapse-icon">&#x229E;</span></td>
                        <td width="100%">${t}${l}<br></td>
                    </tr>`:`<tr>
                       <td class="hl-collapse-cell" bgcolor="C0C0C0" onclick="HLCollapseExpand(${this.data[e].id})" valign= "top"><span class="hl-collapse-icon">&#x229F;</span></td>
                       <td width="100%">${t}${l}<br>${this.toHTML(this.id[e])}</td>
                    </tr>`}updateHTMLinner(e){let t=this.getOrdinalById(e);if(t===null)return;let s=document.getElementById("id_elem_"+e);s.innerHTML=this.toHTMLinner(t)}voegAttributenToeAlsNodigEnReSort(){for(let e=0;e<this.length;e++)if(this.data[e].props!=null&&this.data[e].isAttribuut()){let t=this.data[e].getParent();if(t==null||t.getType()!="Domotica gestuurde verbruiker")continue;if(t.props.heeft_externe_sturing==!0)switch(t.props.type_externe_sturing){case"schakelaar":if(this.data[e].props.type=="Schakelaars")continue;Object.setPrototypeOf(this.data[e],_e.prototype),this.data[e].resetProps(),this.data[e].props.isAttribuut=!0;continue;case"drukknop":if(this.data[e].props.type=="Drukknop")continue;Object.setPrototypeOf(this.data[e],Ft.prototype),this.data[e].resetProps(),this.data[e].props.isAttribuut=!0;continue;default:continue}this.active[e]=!1}for(let e=0;e<this.length;e++)if(this.active[e]&&this.data[e].getType()=="Domotica gestuurde verbruiker"&&this.data[e].props.heeft_externe_sturing==!0){let t=!1;for(let s=0;s<this.length;s++)this.active[s]&&this.data[s].parent==this.id[e]&&this.data[s].isAttribuut()&&(t=!0);if(!t){let s=null;switch(this.data[e].props.type_externe_sturing){case"schakelaar":s=this.createItem("Schakelaars"),s.props.type_schakelaar="enkelpolig";break;case"drukknop":default:s=this.createItem("Drukknop");break}if(s!=null){s.props.isAttribuut=!0,this.insertChildAfterId(s,this.id[e]),this.voegAttributenToeAlsNodigEnReSort();return}}}this.reSort()}toHTML(e){e==0&&(this.updateRibbon(),this.reNumber());let t=this.getElectroItemById(e),s="",a=0,r=0;for(let n=0;n<this.length;n++)if(this.active[n]&&this.data[n].parent==e&&!this.data[n].isAttribuut()&&this.data[n].getType()!="Container"){a++;const o=this.data[n].getType();if(o=="Container")continue;o!=null&&o=="Kring"&&r++,s+='<table class="html_edit_table" id="id_elem_'+this.id[n]+'" data-hl-id="'+this.id[n]+'" draggable="'+(this.mode==="move"?"true":"false")+'">',s+=this.toHTMLinner(n),s+="</table>"}if(e==0&&a<1&&(s+='<button onclick="HLAdd()">Voeg eerste object toe of kies bovenaan "Nieuw"</button><br>'),t!=null&&t.getType()=="Kring"&&r>1){const n=I(getComputedStyle(document.documentElement).getPropertyValue("--EDStekenFoutKleur")),o=Ut(n);s=`<div class="EDS-tekenfout"><b>Tekenfout:</b> U heeft meer dan 1 kring achter deze kring gehangen, Kring ${o} {Kring, Kring, &#8230;}. Dat is niet gebruikelijk.<br>Als u hier een vertakking wilt, gebruik dan eerst het "Splitsing"-element: Kring ${o} Splitsing ${o} {Kring, Kring, &#8230;}.<br>Als u daadwerkelijk verticaal gestapelde kringen in het schema wilt, is het correcter ze hiërarchisch onder elkaar te hangen: Kring ${o} Kring ${o} Kring.<br></div>`+s}if(t!=null&&t.getType()=="Aansluiting"&&a>1){const n=I(getComputedStyle(document.documentElement).getPropertyValue("--EDStekenFoutKleur")),o=Ut(n);s=`<div class="EDS-tekenfout"><b>Tekenfout:</b> U heeft meer dan 1 element achter een aansluiting gehangen, Aansluiting ${o} {Element1, Element2, &#8230;}. Dat is niet gebruikelijk.<br>Het is correcter om elementen achter een aansluiting als volgt te stapelen: Aansluiting ${o} Element1 ${o} Element2 ${o} &#8230;.<br>Verwijder het teveel aan elementen of gebruik de werkmodus "Verplaatsen/Clone" bovenaan om ze onder elkaar te hangen.</div>`+s}return s}findKringName(e){let t=this.getOrdinalById(e);if(t==null)return"";let s=this.data[t].parent;if(s==0)return"";{let a=this.getOrdinalById(s);return a==null?"":this.data[a].getType()=="Kring"?I(this.data[a].props.naam)!=""?this.data[a].props.naam:this.findKringName(s):this.findKringName(s)}}updateKringNamen(){function e(r,n){let o=document.getElementById(`HL_edit_${r}_naam`);o&&o.value!=n&&(o.value=n)}function t(r){let n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o="",c=!1;for(let l=0;l<n.length;l++)if(o=n[l],!r[o]){c=!0;break}if(!c)for(let l=0;l<n.length;l++){for(let d=0;d<n.length;d++)if(o=n[l]+n[d],!r[o]){c=!0;break}if(c)break}if(!c)for(let l=0;l<n.length;l++){for(let d=0;d<n.length;d++){for(let h=0;h<n.length;h++)if(o=n[l]+n[d]+n[h],!r[o]){c=!0;break}if(c)break}if(c)break}return o}function s(){let r={};for(let n=0;n<this.length;n++){if(!this.active[n])continue;let o=this.data[n];if(o==null)continue;let c=o.getType();if(c!=null&&c=="Kring"&&o.props.autoKringNaam!=="auto"){let l=I(o.props.naam);l!=""&&(r[l]=!0)}}return r}let a=s.call(this);for(let r=0;r<this.length;r++){if(!this.active[r])continue;let n=this.data[r];if(n==null||n.isAttribuut())continue;let o=n.getType();if(o!=null&&o=="Kring"&&n.props.autoKringNaam==="auto"){let c="";mt(["automatisch","differentieel","differentieelautomaat","smelt"],n.props.bescherming)&&(c=t(a)),a[c]=!0,n.props.naam!=c&&(n.props.naam=c,e(n.id,c))}}}reNumber(){function e(a,r){let n=document.getElementById(`HL_edit_${a}_nr`);n&&n.value!=r&&(n.value=r)}this.reSort(),this.updateKringNamen();let t={},s=["","Bord","Kring","Splitsing"];for(let a=0;a<this.length;a++){if(!this.active[a])continue;let r=this.data[a];if(r==null||r.isAttribuut())continue;let n=r.getType();if(n==null)continue;let o=r.getParent();if(o==null)continue;let c=this.findKringName(r.id);if(n=="Bord")for(let l in t)t[l]=0;else if(n=="Kring"){if(o.getType()==="Bord"){let l=I(r.props.naam);t[l]=0}}else if(!mt(s,this.data[a].getType())){let l=this.data[a];if(l==null)continue;let d=l.getParent();if(d==null)continue;if(d.getType()=="Kring"||d.getType()=="Domotica module (verticaal)")if(l.props.autonr==="auto"){t[c]=(t[c]||0)+1;let h=t[c].toString();l.props.nr!=h&&(l.props.nr=h,e(l.id,h))}else l.props.nr!=null&&!isNaN(Number(l.props.nr))&&(t[c]=Number(l.props.nr))}}}toSVG(e,t,s=0,a=!1){var h,p;let r=new Array,n=new Array,o=0;for(let u=0;u<this.length;u++)if(this.active[u]&&!this.data[u].isAttribuut()&&(this.data[u].parent==e||a==!0&&this.id[u]==e)){let g=this.data[u].getType();switch(g=this.data[u].props.type,g){case"":r[o]=new H;break;case"Bord":r[o]=this.data[u].toSVG();break;case"Splitsing":r[o]=this.data[u].toSVG();break;case"Domotica":r[o]=this.data[u].toSVG(),this.tekenVerticaleLijnIndienKindVanKring(this.data[u],r[o]);break;case"Meerdere verbruikers":r[o]=this.data[u].toSVG(),this.tekenVerticaleLijnIndienKindVanKring(this.data[u],r[o]);break;case"Vrije ruimte":r[o]=this.data[u].toSVG();break;case"Domotica module (verticaal)":r[o]=this.data[u].toSVG(),this.tekenVerticaleLijnIndienKindVanKring(this.data[u],r[o]);break;case"Omvormer":r[o]=this.data[u].toSVG(),this.tekenVerticaleLijnIndienKindVanKring(this.data[u],r[o]);break;case"Aftakdoos":r[o]=this.data[u].toSVG(),this.tekenVerticaleLijnIndienKindVanKring(this.data[u],r[o]);break;case"Domotica gestuurde verbruiker":r[o]=this.data[u].toSVG(),this.tekenVerticaleLijnIndienKindVanKring(this.data[u],r[o]);break;case"Kring":r[o]=this.data[u].toSVG();break;case"Aansluiting":r[o]=this.data[u].toSVG(),this.tekenVerticaleLijnIndienKindVanKring(this.data[u],r[o]);break;case"Container":break;default:const b=this.getElectroItemById(e);e!=0&&b!=null&&b.getType()=="Meerdere verbruikers"?r[o]=this.data[u].toSVG():t=="vertical"?r[o]=this.toSVG(this.id[u],"horizontal",0,!0):this.id[u]==e?r[o]=this.data[u].toSVG():r[o]=this.toSVG(this.id[u],"horizontal",0,!0),this.tekenVerticaleLijnIndienKindVanKring(this.data[u],r[o]);break}g!=="Container"&&(n[o]=this.id[u],o++)}o==0&&(r[0]=new H,n[0]=0);let c=new H;c.xleft=0,c.xright=0,c.yup=0,c.ydown=0,c.data="";let l=0,d=0;switch(t){case"horizontal":let u=0,g=0;for(let E=0;E<o;E++)l=l+r[E].xleft+r[E].xright,u=Math.max(u,r[E].yup),g=Math.max(g,r[E].ydown);d=u+g,o>0?(c.xleft=r[0].xleft,c.xright=l-c.xleft,c.xrightmin=c.xright-r[o-1].xright):(c.xleft=0,c.xright=0,c.xrightmin=0),c.yup=u,c.ydown=g;let b=0;for(let E=0;E<o;E++)c.data+='<svg data-eds-id="'+((h=n[E])!=null?h:0)+'" x="'+b+'" y="'+(u-r[E].yup)+'">',c.data+=r[E].data,c.data+="</svg>",b+=r[E].xleft+r[E].xright;break;case"vertical":let _=0,v=0;for(let E=0;E<o;E++)d=d+r[E].yup+r[E].ydown,_=Math.max(_,r[E].xleft),v=Math.max(v,r[E].xright),r[E].yup+r[E].ydown>0?c.connectorPos.push(d-r[E].yup):c.connectorPos.push(null);_=Math.max(s,_),l=_+v,c.yup=d,c.ydown=0,c.xleft=_,o>0&&(c.firstChildydown=r[0].ydown,c.lastChildyup=r[o-1].yup);let T=this.getElectroItemById(e);T!=null&&T.getType()=="Kring"&&(v+=10),!(this.getElectroItemById(e)instanceof Wt)&&!(this.getElectroItemById(e)instanceof Gt)?c.xright=Math.max(v,25):c.xright=Math.max(v,0);let U=0;for(let E=o-1;E>=0;E--)c.data+='<svg data-eds-id="'+((p=n[E])!=null?p:0)+'" x="'+(c.xleft-r[E].xleft)+'" y="'+U+'">',c.data+=r[E].data,c.data+="</svg>",U+=r[E].yup+r[E].ydown;break}if(e==0){let u='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" transform="scale(1,1)" width="'+(l+20)+'" height="'+(d+5)+'">';u+=k.outputSVGSymbols();let g="</svg>";c.data=u+c.data+g}return c}toJsonObject(e=!0){for(let o of this.data)o.sourcelist=null;let t=this.print_table.pagemarkers,s=this.sitplan,a=this.sitplanview,r=this.properties.currentView;this.print_table.pagemarkers=null,this.sitplan!=null&&(this.sitplanjson=this.sitplan.toJsonObject()),this.sitplan=null,this.sitplanview=null,e&&(this.properties.currentView=null);var n=JSON.stringify(this);for(let o of this.data)o.sourcelist=this;return this.print_table.pagemarkers=t,this.sitplan=s,this.sitplanview=a,this.properties.currentView=r,this.sitplanjson=null,n}}class Ne extends Error{}Ne.prototype.name="InvalidTokenError";function ia(i){return decodeURIComponent(atob(i).replace(/(.)/g,(e,t)=>{let s=t.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}function aa(i){let e=i.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return ia(e)}catch(t){return atob(e)}}function ra(i,e){if(typeof i!="string")throw new Ne("Invalid token specified: must be a string");e||(e={});const t=e.header===!0?0:1,s=i.split(".")[t];if(typeof s!="string")throw new Ne(`Invalid token specified: missing part #${t+1}`);let a;try{a=aa(s)}catch(r){throw new Ne(`Invalid token specified: invalid base64 for part #${t+1} (${r.message})`)}try{return JSON.parse(a)}catch(r){throw new Ne(`Invalid token specified: invalid json for part #${t+1} (${r.message})`)}}var na={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},ue,ge,tt=(i=>(i[i.NONE=0]="NONE",i[i.ERROR=1]="ERROR",i[i.WARN=2]="WARN",i[i.INFO=3]="INFO",i[i.DEBUG=4]="DEBUG",i))(tt||{});(i=>{function e(){ue=3,ge=na}i.reset=e;function t(a){if(!(0<=a&&a<=4))throw new Error("Invalid log level");ue=a}i.setLevel=t;function s(a){ge=a}i.setLogger=s})(tt||(tt={}));var F=class pe{constructor(e){this._name=e}debug(...e){ue>=4&&ge.debug(pe._format(this._name,this._method),...e)}info(...e){ue>=3&&ge.info(pe._format(this._name,this._method),...e)}warn(...e){ue>=2&&ge.warn(pe._format(this._name,this._method),...e)}error(...e){ue>=1&&ge.error(pe._format(this._name,this._method),...e)}throw(e){throw this.error(e),e}create(e){const t=Object.create(this);return t._method=e,t.debug("begin"),t}static createStatic(e,t){const s=new pe(`${e}.${t}`);return s.debug("begin"),s}static _format(e,t){const s=`[${e}]`;return t?`${s} ${t}:`:s}static debug(e,...t){ue>=4&&ge.debug(pe._format(e),...t)}static info(e,...t){ue>=3&&ge.info(pe._format(e),...t)}static warn(e,...t){ue>=2&&ge.warn(pe._format(e),...t)}static error(e,...t){ue>=1&&ge.error(pe._format(e),...t)}};tt.reset();var De=class{static decode(i){try{return ra(i)}catch(e){throw F.error("JwtUtils.decode",e),e}}static async generateSignedJwt(i,e,t){const s=Q.encodeBase64Url(new TextEncoder().encode(JSON.stringify(i))),a=Q.encodeBase64Url(new TextEncoder().encode(JSON.stringify(e))),r=`${s}.${a}`,n=await window.crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},t,new TextEncoder().encode(r)),o=Q.encodeBase64Url(new Uint8Array(n));return`${r}.${o}`}static async generateSignedJwtWithHmac(i,e,t){const s=Q.encodeBase64Url(new TextEncoder().encode(JSON.stringify(i))),a=Q.encodeBase64Url(new TextEncoder().encode(JSON.stringify(e))),r=`${s}.${a}`,n=await window.crypto.subtle.sign("HMAC",t,new TextEncoder().encode(r)),o=Q.encodeBase64Url(new Uint8Array(n));return`${r}.${o}`}},oa="10000000-1000-4000-8000-100000000000",bt=i=>btoa([...new Uint8Array(i)].map(e=>String.fromCharCode(e)).join("")),ms=class de{static _randomWord(){const e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}static generateUUIDv4(){return oa.replace(/[018]/g,t=>(+t^de._randomWord()&15>>+t/4).toString(16)).replace(/-/g,"")}static generateCodeVerifier(){return de.generateUUIDv4()+de.generateUUIDv4()+de.generateUUIDv4()}static async generateCodeChallenge(e){if(!crypto.subtle)throw new Error("Crypto.subtle is available only in secure contexts (HTTPS).");try{const s=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",s);return bt(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(t){throw F.error("CryptoUtils.generateCodeChallenge",t),t}}static generateBasicAuth(e,t){const a=new TextEncoder().encode([e,t].join(":"));return bt(a)}static async hash(e,t){const s=new TextEncoder().encode(t),a=await crypto.subtle.digest(e,s);return new Uint8Array(a)}static async customCalculateJwkThumbprint(e){let t;switch(e.kty){case"RSA":t={e:e.e,kty:e.kty,n:e.n};break;case"EC":t={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":t={crv:e.crv,kty:e.kty,x:e.x};break;case"oct":t={crv:e.k,kty:e.kty};break;default:throw new Error("Unknown jwk type")}const s=await de.hash("SHA-256",JSON.stringify(t));return de.encodeBase64Url(s)}static async generateDPoPProof({url:e,accessToken:t,httpMethod:s,keyPair:a,nonce:r}){let n,o;const c={jti:window.crypto.randomUUID(),htm:s!=null?s:"GET",htu:e,iat:Math.floor(Date.now()/1e3)};t&&(n=await de.hash("SHA-256",t),o=de.encodeBase64Url(n),c.ath=o),r&&(c.nonce=r);try{const l=await crypto.subtle.exportKey("jwk",a.publicKey),d={alg:"ES256",typ:"dpop+jwt",jwk:{crv:l.crv,kty:l.kty,x:l.x,y:l.y}};return await De.generateSignedJwt(d,c,a.privateKey)}catch(l){throw l instanceof TypeError?new Error(`Error exporting dpop public key: ${l.message}`):l}}static async generateDPoPJkt(e){try{const t=await crypto.subtle.exportKey("jwk",e.publicKey);return await de.customCalculateJwkThumbprint(t)}catch(t){throw t instanceof TypeError?new Error(`Could not retrieve dpop keys from storage: ${t.message}`):t}}static async generateDPoPKeys(){return await window.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!1,["sign","verify"])}static async generateClientAssertionJwt(e,t,s,a="HS256"){const r=Math.floor(Date.now()/1e3),n={alg:a,typ:"JWT"},o={iss:e,sub:e,aud:s,jti:de.generateUUIDv4(),exp:r+300,iat:r},l={HS256:"SHA-256",HS384:"SHA-384",HS512:"SHA-512"}[a];if(!l)throw new Error(`Unsupported algorithm: ${a}. Supported algorithms are: HS256, HS384, HS512`);const d=new TextEncoder,h=await crypto.subtle.importKey("raw",d.encode(t),{name:"HMAC",hash:l},!1,["sign"]);return await De.generateSignedJwtWithHmac(n,o,h)}};ms.encodeBase64Url=i=>bt(i).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");var Q=ms,we=class{constructor(i){this._name=i,this._callbacks=[],this._logger=new F(`Event('${this._name}')`)}addHandler(i){return this._callbacks.push(i),()=>this.removeHandler(i)}removeHandler(i){const e=this._callbacks.lastIndexOf(i);e>=0&&this._callbacks.splice(e,1)}async raise(...i){this._logger.debug("raise:",...i);for(const e of this._callbacks)await e(...i)}},Zt=class{static center(e){var i=ae(e,[]);var t,s,a;return i.width==null&&(i.width=(t=[800,720,600,480].find(r=>r<=window.outerWidth/1.618))!=null?t:360),(s=i.left)!=null||(i.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-i.width)/2))),i.height!=null&&((a=i.top)!=null||(i.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-i.height)/2)))),i}static serialize(i){return Object.entries(i).filter(([,e])=>e!=null).map(([e,t])=>`${e}=${typeof t!="boolean"?t:t?"yes":"no"}`).join(",")}},ke=class Ze extends we{constructor(){super(...arguments),this._logger=new F(`Timer('${this._name}')`),this._timerHandle=null,this._expiration=0,this._callback=()=>{const e=this._expiration-Ze.getEpochTime();this._logger.debug("timer completes in",e),this._expiration<=Ze.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(e){const t=this._logger.create("init");e=Math.max(Math.floor(e),1);const s=Ze.getEpochTime()+e;if(this.expiration===s&&this._timerHandle){t.debug("skipping since already initialized for expiration at",this.expiration);return}this.cancel(),t.debug("using duration",e),this._expiration=s;const a=Math.min(e,5);this._timerHandle=setInterval(this._callback,a*1e3)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},kt=class{static readParams(i,e="query"){if(!i)throw new TypeError("Invalid URL");const s=new URL(i,"http://127.0.0.1")[e==="fragment"?"hash":"search"];return new URLSearchParams(s.slice(1))}},ze=";",Le=class extends Error{constructor(i,e){var t,s,a;if(super(i.error_description||i.error||""),this.form=e,this.name="ErrorResponse",!i.error)throw F.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=i.error,this.error_description=(t=i.error_description)!=null?t:null,this.error_uri=(s=i.error_uri)!=null?s:null,this.state=i.userState,this.session_state=(a=i.session_state)!=null?a:null,this.url_state=i.url_state}},Ct=class extends Error{constructor(i){super(i),this.name="ErrorTimeout"}},la=class{constructor(i){this._logger=new F("AccessTokenEvents"),this._expiringTimer=new ke("Access token expiring"),this._expiredTimer=new ke("Access token expired"),this._expiringNotificationTimeInSeconds=i.expiringNotificationTimeInSeconds}async load(i){const e=this._logger.create("load");if(i.access_token&&i.expires_in!==void 0){const t=i.expires_in;if(e.debug("access token present, remaining duration:",t),t>0){let a=t-this._expiringNotificationTimeInSeconds;a<=0&&(a=1),e.debug("registering expiring timer, raising in",a,"seconds"),this._expiringTimer.init(a)}else e.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();const s=t+1;e.debug("registering expired timer, raising in",s,"seconds"),this._expiredTimer.init(s)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}async unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(i){return this._expiringTimer.addHandler(i)}removeAccessTokenExpiring(i){this._expiringTimer.removeHandler(i)}addAccessTokenExpired(i){return this._expiredTimer.addHandler(i)}removeAccessTokenExpired(i){this._expiredTimer.removeHandler(i)}},ca=class{constructor(i,e,t,s,a){this._callback=i,this._client_id=e,this._intervalInSeconds=s,this._stopOnError=a,this._logger=new F("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=n=>{n.origin===this._frame_origin&&n.source===this._frame.contentWindow&&(n.data==="error"?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):n.data==="changed"?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(n.data+" message from check session op iframe"))};const r=new URL(t);this._frame_origin=r.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=r.href}load(){return new Promise(i=>{this._frame.onload=()=>{i()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)})}start(i){if(this._session_state===i)return;this._logger.create("start"),this.stop(),this._session_state=i;const e=()=>{!this._frame.contentWindow||!this._session_state||this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};e(),this._timer=setInterval(e,this._intervalInSeconds*1e3)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}},ys=class{constructor(){this._logger=new F("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(i){return this._logger.create(`getItem('${i}')`),this._data[i]}setItem(i,e){this._logger.create(`setItem('${i}')`),this._data[i]=e}removeItem(i){this._logger.create(`removeItem('${i}')`),delete this._data[i]}get length(){return Object.getOwnPropertyNames(this._data).length}key(i){return Object.getOwnPropertyNames(this._data)[i]}},xt=class extends Error{constructor(i,e){super(e),this.name="ErrorDPoPNonce",this.nonce=i}},Ht=class{constructor(i=[],e=null,t={}){this._jwtHandler=e,this._extraHeaders=t,this._logger=new F("JsonService"),this._contentTypes=[],this._contentTypes.push(...i,"application/json"),e&&this._contentTypes.push("application/jwt")}async fetchWithTimeout(i,e={}){const n=e,{timeoutInSeconds:t}=n,s=ae(n,["timeoutInSeconds"]);if(!t)return await fetch(i,s);const a=new AbortController,r=setTimeout(()=>a.abort(),t*1e3);try{return await fetch(i,me(V({},e),{signal:a.signal}))}catch(o){throw o instanceof DOMException&&o.name==="AbortError"?new Ct("Network timed out"):o}finally{clearTimeout(r)}}async getJson(i,{token:e,credentials:t,timeoutInSeconds:s}={}){const a=this._logger.create("getJson"),r={Accept:this._contentTypes.join(", ")};e&&(a.debug("token passed, setting Authorization header"),r.Authorization="Bearer "+e),this._appendExtraHeaders(r);let n;try{a.debug("url:",i),n=await this.fetchWithTimeout(i,{method:"GET",headers:r,timeoutInSeconds:s,credentials:t})}catch(l){throw a.error("Network Error"),l}a.debug("HTTP response received, status",n.status);const o=n.headers.get("Content-Type");if(o&&!this._contentTypes.find(l=>o.startsWith(l))&&a.throw(new Error(`Invalid response Content-Type: ${o!=null?o:"undefined"}, from URL: ${i}`)),n.ok&&this._jwtHandler&&(o!=null&&o.startsWith("application/jwt")))return await this._jwtHandler(await n.text());let c;try{c=await n.json()}catch(l){throw a.error("Error parsing JSON response",l),n.ok?l:new Error(`${n.statusText} (${n.status})`)}if(!n.ok)throw a.error("Error from server:",c),c.error?new Le(c):new Error(`${n.statusText} (${n.status}): ${JSON.stringify(c)}`);return c}async postForm(i,{body:e,basicAuth:t,timeoutInSeconds:s,initCredentials:a,extraHeaders:r}){const n=this._logger.create("postForm"),o=V({Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"},r);t!==void 0&&(o.Authorization="Basic "+t),this._appendExtraHeaders(o);let c;try{n.debug("url:",i),c=await this.fetchWithTimeout(i,{method:"POST",headers:o,body:e,timeoutInSeconds:s,credentials:a})}catch(p){throw n.error("Network error"),p}n.debug("HTTP response received, status",c.status);const l=c.headers.get("Content-Type");if(l&&!this._contentTypes.find(p=>l.startsWith(p)))throw new Error(`Invalid response Content-Type: ${l!=null?l:"undefined"}, from URL: ${i}`);const d=await c.text();let h={};if(d)try{h=JSON.parse(d)}catch(p){throw n.error("Error parsing JSON response",p),c.ok?p:new Error(`${c.statusText} (${c.status})`)}if(!c.ok){if(n.error("Error from server:",h),c.headers.has("dpop-nonce")){const p=c.headers.get("dpop-nonce");throw new xt(p,`${JSON.stringify(h)}`)}throw h.error?new Le(h,e):new Error(`${c.statusText} (${c.status}): ${JSON.stringify(h)}`)}return h}_appendExtraHeaders(i){const e=this._logger.create("appendExtraHeaders"),t=Object.keys(this._extraHeaders),s=["accept","content-type"],a=["authorization"];t.length!==0&&t.forEach(r=>{if(s.includes(r.toLocaleLowerCase())){e.warn("Protected header could not be set",r,s);return}if(a.includes(r.toLocaleLowerCase())&&Object.keys(i).includes(r)){e.warn("Header could not be overridden",r,a);return}const n=typeof this._extraHeaders[r]=="function"?this._extraHeaders[r]():this._extraHeaders[r];n&&n!==""&&(i[r]=n)})}},da=class{constructor(i){this._settings=i,this._logger=new F("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new Ht(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}resetSigningKeys(){this._signingKeys=null}async getMetadata(){const i=this._logger.create("getMetadata");if(this._metadata)return i.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw i.throw(new Error("No authority or metadataUrl configured on settings")),null;i.debug("getting metadata from",this._metadataUrl);const e=await this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials,timeoutInSeconds:this._settings.requestTimeoutInSeconds});return i.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},e,this._settings.metadataSeed),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(i=!0){return this._getMetadataProperty("token_endpoint",i)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(i=!0){return this._getMetadataProperty("revocation_endpoint",i)}getKeysEndpoint(i=!0){return this._getMetadataProperty("jwks_uri",i)}async _getMetadataProperty(i,e=!1){const t=this._logger.create(`_getMetadataProperty('${i}')`),s=await this.getMetadata();if(t.debug("resolved"),s[i]===void 0){if(e===!0){t.warn("Metadata does not contain optional property");return}t.throw(new Error("Metadata does not contain property "+i))}return s[i]}async getSigningKeys(){const i=this._logger.create("getSigningKeys");if(this._signingKeys)return i.debug("returning signingKeys from cache"),this._signingKeys;const e=await this.getKeysEndpoint(!1);i.debug("got jwks_uri",e);const t=await this._jsonService.getJson(e,{timeoutInSeconds:this._settings.requestTimeoutInSeconds});if(i.debug("got key set",t),!Array.isArray(t.keys))throw i.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=t.keys,this._signingKeys}},Bt=class{constructor({prefix:i="oidc.",store:e=localStorage}={}){this._logger=new F("WebStorageStateStore"),this._store=e,this._prefix=i}async set(i,e){this._logger.create(`set('${i}')`),i=this._prefix+i,await this._store.setItem(i,e)}async get(i){return this._logger.create(`get('${i}')`),i=this._prefix+i,await this._store.getItem(i)}async remove(i){this._logger.create(`remove('${i}')`),i=this._prefix+i;const e=await this._store.getItem(i);return await this._store.removeItem(i),e}async getAllKeys(){this._logger.create("getAllKeys");const i=await this._store.length,e=[];for(let t=0;t<i;t++){const s=await this._store.key(t);s&&s.indexOf(this._prefix)===0&&e.push(s.substr(this._prefix.length))}return e}},ha="code",pa="openid",ua="client_secret_post",ga=900,wt=class{constructor({authority:i,metadataUrl:e,metadata:t,signingKeys:s,metadataSeed:a,client_id:r,client_secret:n,response_type:o=ha,scope:c=pa,redirect_uri:l,post_logout_redirect_uri:d,client_authentication:h=ua,token_endpoint_auth_signing_alg:p="HS256",prompt:u,display:g,max_age:b,ui_locales:_,acr_values:v,resource:T,response_mode:U,filterProtocolClaims:E=!0,loadUserInfo:f=!1,requestTimeoutInSeconds:m,staleStateAgeInSeconds:x=ga,mergeClaimsStrategy:w={array:"replace"},disablePKCE:P=!1,stateStore:A,revokeTokenAdditionalContentTypes:S,fetchRequestCredentials:N,refreshTokenAllowedScope:W,extraQueryParams:M={},extraTokenParams:L={},extraHeaders:j={},dpop:C,omitScopeWhenRequesting:q=!1}){var K;if(this.authority=i,e?this.metadataUrl=e:(this.metadataUrl=i,i&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=t,this.metadataSeed=a,this.signingKeys=s,this.client_id=r,this.client_secret=n,this.response_type=o,this.scope=c,this.redirect_uri=l,this.post_logout_redirect_uri=d,this.client_authentication=h,this.token_endpoint_auth_signing_alg=p,this.prompt=u,this.display=g,this.max_age=b,this.ui_locales=_,this.acr_values=v,this.resource=T,this.response_mode=U,this.filterProtocolClaims=E!=null?E:!0,this.loadUserInfo=!!f,this.staleStateAgeInSeconds=x,this.mergeClaimsStrategy=w,this.omitScopeWhenRequesting=q,this.disablePKCE=!!P,this.revokeTokenAdditionalContentTypes=S,this.fetchRequestCredentials=N||"same-origin",this.requestTimeoutInSeconds=m,A)this.stateStore=A;else{const O=typeof window!="undefined"?window.localStorage:new ys;this.stateStore=new Bt({store:O})}if(this.refreshTokenAllowedScope=W,this.extraQueryParams=M,this.extraTokenParams=L,this.extraHeaders=j,this.dpop=C,this.dpop&&!((K=this.dpop)!=null&&K.store))throw new Error("A DPoPStore is required when dpop is enabled")}},fa=class{constructor(i,e){this._settings=i,this._metadataService=e,this._logger=new F("UserInfoService"),this._getClaimsFromJwt=async t=>{const s=this._logger.create("_getClaimsFromJwt");try{const a=De.decode(t);return s.debug("JWT decoding successful"),a}catch(a){throw s.error("Error parsing JWT response"),a}},this._jsonService=new Ht(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}async getClaims(i){const e=this._logger.create("getClaims");i||this._logger.throw(new Error("No token passed"));const t=await this._metadataService.getUserInfoEndpoint();e.debug("got userinfo url",t);const s=await this._jsonService.getJson(t,{token:i,credentials:this._settings.fetchRequestCredentials,timeoutInSeconds:this._settings.requestTimeoutInSeconds});return e.debug("got claims",s),s}},bs=class{constructor(i,e){this._settings=i,this._metadataService=e,this._logger=new F("TokenClient"),this._jsonService=new Ht(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}async exchangeCode(n){var o=n,{grant_type:i="authorization_code",redirect_uri:e=this._settings.redirect_uri,client_id:t=this._settings.client_id,client_secret:s=this._settings.client_secret,extraHeaders:a}=o,r=ae(o,["grant_type","redirect_uri","client_id","client_secret","extraHeaders"]);const c=this._logger.create("exchangeCode");t||c.throw(new Error("A client_id is required")),e||c.throw(new Error("A redirect_uri is required")),r.code||c.throw(new Error("A code is required"));const l=new URLSearchParams({grant_type:i,redirect_uri:e});for(const[u,g]of Object.entries(r))g!=null&&l.set(u,g);if((this._settings.client_authentication==="client_secret_basic"||this._settings.client_authentication==="client_secret_jwt")&&s==null)throw c.throw(new Error("A client_secret is required")),null;let d;const h=await this._metadataService.getTokenEndpoint(!1);switch(this._settings.client_authentication){case"client_secret_basic":d=Q.generateBasicAuth(t,s);break;case"client_secret_post":l.append("client_id",t),s&&l.append("client_secret",s);break;case"client_secret_jwt":{const u=await Q.generateClientAssertionJwt(t,s,h,this._settings.token_endpoint_auth_signing_alg);l.append("client_id",t),l.append("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),l.append("client_assertion",u);break}}c.debug("got token endpoint");const p=await this._jsonService.postForm(h,{body:l,basicAuth:d,timeoutInSeconds:this._settings.requestTimeoutInSeconds,initCredentials:this._settings.fetchRequestCredentials,extraHeaders:a});return c.debug("got response"),p}async exchangeCredentials(r){var n=r,{grant_type:i="password",client_id:e=this._settings.client_id,client_secret:t=this._settings.client_secret,scope:s=this._settings.scope}=n,a=ae(n,["grant_type","client_id","client_secret","scope"]);const o=this._logger.create("exchangeCredentials");e||o.throw(new Error("A client_id is required"));const c=new URLSearchParams({grant_type:i});this._settings.omitScopeWhenRequesting||c.set("scope",s);for(const[p,u]of Object.entries(a))u!=null&&c.set(p,u);if((this._settings.client_authentication==="client_secret_basic"||this._settings.client_authentication==="client_secret_jwt")&&t==null)throw o.throw(new Error("A client_secret is required")),null;let l;const d=await this._metadataService.getTokenEndpoint(!1);switch(this._settings.client_authentication){case"client_secret_basic":l=Q.generateBasicAuth(e,t);break;case"client_secret_post":c.append("client_id",e),t&&c.append("client_secret",t);break;case"client_secret_jwt":{const p=await Q.generateClientAssertionJwt(e,t,d,this._settings.token_endpoint_auth_signing_alg);c.append("client_id",e),c.append("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),c.append("client_assertion",p);break}}o.debug("got token endpoint");const h=await this._jsonService.postForm(d,{body:c,basicAuth:l,timeoutInSeconds:this._settings.requestTimeoutInSeconds,initCredentials:this._settings.fetchRequestCredentials});return o.debug("got response"),h}async exchangeRefreshToken(n){var o=n,{grant_type:i="refresh_token",client_id:e=this._settings.client_id,client_secret:t=this._settings.client_secret,timeoutInSeconds:s,extraHeaders:a}=o,r=ae(o,["grant_type","client_id","client_secret","timeoutInSeconds","extraHeaders"]);const c=this._logger.create("exchangeRefreshToken");e||c.throw(new Error("A client_id is required")),r.refresh_token||c.throw(new Error("A refresh_token is required"));const l=new URLSearchParams({grant_type:i});for(const[u,g]of Object.entries(r))Array.isArray(g)?g.forEach(b=>l.append(u,b)):g!=null&&l.set(u,g);if((this._settings.client_authentication==="client_secret_basic"||this._settings.client_authentication==="client_secret_jwt")&&t==null)throw c.throw(new Error("A client_secret is required")),null;let d;const h=await this._metadataService.getTokenEndpoint(!1);switch(this._settings.client_authentication){case"client_secret_basic":d=Q.generateBasicAuth(e,t);break;case"client_secret_post":l.append("client_id",e),t&&l.append("client_secret",t);break;case"client_secret_jwt":{const u=await Q.generateClientAssertionJwt(e,t,h,this._settings.token_endpoint_auth_signing_alg);l.append("client_id",e),l.append("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),l.append("client_assertion",u);break}}c.debug("got token endpoint");const p=await this._jsonService.postForm(h,{body:l,basicAuth:d,timeoutInSeconds:s,initCredentials:this._settings.fetchRequestCredentials,extraHeaders:a});return c.debug("got response"),p}async revoke(i){var e;const t=this._logger.create("revoke");i.token||t.throw(new Error("A token is required"));const s=await this._metadataService.getRevocationEndpoint(!1);t.debug(`got revocation endpoint, revoking ${(e=i.token_type_hint)!=null?e:"default token type"}`);const a=new URLSearchParams;for(const[r,n]of Object.entries(i))n!=null&&a.set(r,n);a.set("client_id",this._settings.client_id),this._settings.client_secret&&a.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(s,{body:a,timeoutInSeconds:this._settings.requestTimeoutInSeconds}),t.debug("got response")}},ma=class{constructor(i,e,t){this._settings=i,this._metadataService=e,this._claimsService=t,this._logger=new F("ResponseValidator"),this._userInfoService=new fa(this._settings,this._metadataService),this._tokenClient=new bs(this._settings,this._metadataService)}async validateSigninResponse(i,e,t){const s=this._logger.create("validateSigninResponse");this._processSigninState(i,e),s.debug("state processed"),await this._processCode(i,e,t),s.debug("code processed"),i.isOpenId&&this._validateIdTokenAttributes(i),s.debug("tokens validated"),await this._processClaims(i,e==null?void 0:e.skipUserInfo,i.isOpenId),s.debug("claims processed")}async validateCredentialsResponse(i,e){const t=this._logger.create("validateCredentialsResponse"),s=i.isOpenId&&!!i.id_token;s&&this._validateIdTokenAttributes(i),t.debug("tokens validated"),await this._processClaims(i,e,s),t.debug("claims processed")}async validateRefreshResponse(i,e){var t,s;const a=this._logger.create("validateRefreshResponse");i.userState=e.data,(t=i.session_state)!=null||(i.session_state=e.session_state),(s=i.scope)!=null||(i.scope=e.scope),i.isOpenId&&i.id_token&&(this._validateIdTokenAttributes(i,e.id_token),a.debug("ID Token validated")),i.id_token||(i.id_token=e.id_token,i.profile=e.profile);const r=i.isOpenId&&!!i.id_token;await this._processClaims(i,!1,r),a.debug("claims processed")}validateSignoutResponse(i,e){const t=this._logger.create("validateSignoutResponse");if(e.id!==i.state&&t.throw(new Error("State does not match")),t.debug("state validated"),i.userState=e.data,i.error)throw t.warn("Response was error",i.error),new Le(i)}_processSigninState(i,e){var t;const s=this._logger.create("_processSigninState");if(e.id!==i.state&&s.throw(new Error("State does not match")),e.client_id||s.throw(new Error("No client_id on state")),e.authority||s.throw(new Error("No authority on state")),this._settings.authority!==e.authority&&s.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==e.client_id&&s.throw(new Error("client_id mismatch on settings vs. signin state")),s.debug("state validated"),i.userState=e.data,i.url_state=e.url_state,(t=i.scope)!=null||(i.scope=e.scope),i.error)throw s.warn("Response was error",i.error),new Le(i);e.code_verifier&&!i.code&&s.throw(new Error("Expected code in response"))}async _processClaims(i,e=!1,t=!0){const s=this._logger.create("_processClaims");if(i.profile=this._claimsService.filterProtocolClaims(i.profile),e||!this._settings.loadUserInfo||!i.access_token){s.debug("not loading user info");return}s.debug("loading user info");const a=await this._userInfoService.getClaims(i.access_token);s.debug("user info claims received from user info endpoint"),t&&a.sub!==i.profile.sub&&s.throw(new Error("subject from UserInfo response does not match subject in ID Token")),i.profile=this._claimsService.mergeClaims(i.profile,this._claimsService.filterProtocolClaims(a)),s.debug("user info claims received, updated profile:",i.profile)}async _processCode(i,e,t){const s=this._logger.create("_processCode");if(i.code){s.debug("Validating code");const a=await this._tokenClient.exchangeCode(V({client_id:e.client_id,client_secret:e.client_secret,code:i.code,redirect_uri:e.redirect_uri,code_verifier:e.code_verifier,extraHeaders:t},e.extraTokenParams));Object.assign(i,a)}else s.debug("No code to process")}_validateIdTokenAttributes(i,e){var t;const s=this._logger.create("_validateIdTokenAttributes");s.debug("decoding ID Token JWT");const a=De.decode((t=i.id_token)!=null?t:"");if(a.sub||s.throw(new Error("ID Token is missing a subject claim")),e){const r=De.decode(e);a.sub!==r.sub&&s.throw(new Error("sub in id_token does not match current sub")),a.auth_time&&a.auth_time!==r.auth_time&&s.throw(new Error("auth_time in id_token does not match original auth_time")),a.azp&&a.azp!==r.azp&&s.throw(new Error("azp in id_token does not match original azp")),!a.azp&&r.azp&&s.throw(new Error("azp not in id_token, but present in original id_token"))}i.profile=a}},st=class vt{constructor(e){this.id=e.id||Q.generateUUIDv4(),this.data=e.data,e.created&&e.created>0?this.created=e.created:this.created=ke.getEpochTime(),this.request_type=e.request_type,this.url_state=e.url_state}toStorageString(){return new F("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state})}static fromStorageString(e){return F.createStatic("State","fromStorageString"),Promise.resolve(new vt(JSON.parse(e)))}static async clearStaleState(e,t){const s=F.createStatic("State","clearStaleState"),a=ke.getEpochTime()-t,r=await e.getAllKeys();s.debug("got keys",r);for(let n=0;n<r.length;n++){const o=r[n],c=await e.get(o);let l=!1;if(c)try{const d=await vt.fromStorageString(c);s.debug("got item from key:",o,d.created),d.created<=a&&(l=!0)}catch(d){s.error("Error parsing state for key:",o,d),l=!0}else s.debug("no item in storage for key:",o),l=!0;l&&(s.debug("removed item for key:",o),e.remove(o))}}},ks=class _t extends st{constructor(e){super(e),this.code_verifier=e.code_verifier,this.code_challenge=e.code_challenge,this.authority=e.authority,this.client_id=e.client_id,this.redirect_uri=e.redirect_uri,this.scope=e.scope,this.client_secret=e.client_secret,this.extraTokenParams=e.extraTokenParams,this.response_mode=e.response_mode,this.skipUserInfo=e.skipUserInfo}static async create(e){const t=e.code_verifier===!0?Q.generateCodeVerifier():e.code_verifier||void 0,s=t?await Q.generateCodeChallenge(t):void 0;return new _t(me(V({},e),{code_verifier:t,code_challenge:s}))}toStorageString(){return new F("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(e){F.createStatic("SigninState","fromStorageString");const t=JSON.parse(e);return _t.create(t)}},xs=class ws{constructor(e){this.url=e.url,this.state=e.state}static async create(f){var m=f,{url:e,authority:t,client_id:s,redirect_uri:a,response_type:r,scope:n,state_data:o,response_mode:c,request_type:l,client_secret:d,nonce:h,url_state:p,resource:u,skipUserInfo:g,extraQueryParams:b,extraTokenParams:_,disablePKCE:v,dpopJkt:T,omitScopeWhenRequesting:U}=m,E=ae(m,["url","authority","client_id","redirect_uri","response_type","scope","state_data","response_mode","request_type","client_secret","nonce","url_state","resource","skipUserInfo","extraQueryParams","extraTokenParams","disablePKCE","dpopJkt","omitScopeWhenRequesting"]);if(!e)throw this._logger.error("create: No url passed"),new Error("url");if(!s)throw this._logger.error("create: No client_id passed"),new Error("client_id");if(!a)throw this._logger.error("create: No redirect_uri passed"),new Error("redirect_uri");if(!r)throw this._logger.error("create: No response_type passed"),new Error("response_type");if(!n)throw this._logger.error("create: No scope passed"),new Error("scope");if(!t)throw this._logger.error("create: No authority passed"),new Error("authority");const x=await ks.create({data:o,request_type:l,url_state:p,code_verifier:!v,client_id:s,authority:t,redirect_uri:a,response_mode:c,client_secret:d,scope:n,extraTokenParams:_,skipUserInfo:g}),w=new URL(e);w.searchParams.append("client_id",s),w.searchParams.append("redirect_uri",a),w.searchParams.append("response_type",r),U||w.searchParams.append("scope",n),h&&w.searchParams.append("nonce",h),T&&w.searchParams.append("dpop_jkt",T);let P=x.id;p&&(P=`${P}${ze}${p}`),w.searchParams.append("state",P),x.code_challenge&&(w.searchParams.append("code_challenge",x.code_challenge),w.searchParams.append("code_challenge_method","S256")),u&&(Array.isArray(u)?u:[u]).forEach(S=>w.searchParams.append("resource",S));for(const[A,S]of Object.entries(V(V({response_mode:c},E),b)))S!=null&&w.searchParams.append(A,S.toString());return new ws({url:w.href,state:x})}};xs._logger=new F("SigninRequest");var ya=xs,ba="openid",lt=class{constructor(i){if(this.access_token="",this.token_type="",this.profile={},this.state=i.get("state"),this.session_state=i.get("session_state"),this.state){const e=decodeURIComponent(this.state).split(ze);this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(ze))}this.error=i.get("error"),this.error_description=i.get("error_description"),this.error_uri=i.get("error_uri"),this.code=i.get("code")}get expires_in(){if(this.expires_at!==void 0)return this.expires_at-ke.getEpochTime()}set expires_in(i){typeof i=="string"&&(i=Number(i)),i!==void 0&&i>=0&&(this.expires_at=Math.floor(i)+ke.getEpochTime())}get isOpenId(){var i;return((i=this.scope)==null?void 0:i.split(" ").includes(ba))||!!this.id_token}},ka=class{constructor({url:i,state_data:e,id_token_hint:t,post_logout_redirect_uri:s,extraQueryParams:a,request_type:r,client_id:n,url_state:o}){if(this._logger=new F("SignoutRequest"),!i)throw this._logger.error("ctor: No url passed"),new Error("url");const c=new URL(i);if(t&&c.searchParams.append("id_token_hint",t),n&&c.searchParams.append("client_id",n),s&&(c.searchParams.append("post_logout_redirect_uri",s),e||o)){this.state=new st({data:e,request_type:r,url_state:o});let l=this.state.id;o&&(l=`${l}${ze}${o}`),c.searchParams.append("state",l)}for(const[l,d]of Object.entries(V({},a)))d!=null&&c.searchParams.append(l,d.toString());this.url=c.href}},xa=class{constructor(i){if(this.state=i.get("state"),this.state){const e=decodeURIComponent(this.state).split(ze);this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(ze))}this.error=i.get("error"),this.error_description=i.get("error_description"),this.error_uri=i.get("error_uri")}},wa=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],va=["sub","iss","aud","exp","iat"],_a=class{constructor(i){this._settings=i,this._logger=new F("ClaimsService")}filterProtocolClaims(i){const e=V({},i);if(this._settings.filterProtocolClaims){let t;Array.isArray(this._settings.filterProtocolClaims)?t=this._settings.filterProtocolClaims:t=wa;for(const s of t)va.includes(s)||delete e[s]}return e}mergeClaims(i,e){const t=V({},i);for(const[s,a]of Object.entries(e))if(t[s]!==a)if(Array.isArray(t[s])||Array.isArray(a))if(this._settings.mergeClaimsStrategy.array=="replace")t[s]=a;else{const r=Array.isArray(t[s])?t[s]:[t[s]];for(const n of Array.isArray(a)?a:[a])r.includes(n)||r.push(n);t[s]=r}else typeof t[s]=="object"&&typeof a=="object"?t[s]=this.mergeClaims(t[s],a):t[s]=a;return t}},vs=class{constructor(i,e){this.keys=i,this.nonce=e}},Ta=class{constructor(i,e){this._logger=new F("OidcClient"),this.settings=i instanceof wt?i:new wt(i),this.metadataService=e!=null?e:new da(this.settings),this._claimsService=new _a(this.settings),this._validator=new ma(this.settings,this.metadataService,this._claimsService),this._tokenClient=new bs(this.settings,this.metadataService)}async createSigninRequest({state:i,request:e,request_uri:t,request_type:s,id_token_hint:a,login_hint:r,skipUserInfo:n,nonce:o,url_state:c,response_type:l=this.settings.response_type,scope:d=this.settings.scope,redirect_uri:h=this.settings.redirect_uri,prompt:p=this.settings.prompt,display:u=this.settings.display,max_age:g=this.settings.max_age,ui_locales:b=this.settings.ui_locales,acr_values:_=this.settings.acr_values,resource:v=this.settings.resource,response_mode:T=this.settings.response_mode,extraQueryParams:U=this.settings.extraQueryParams,extraTokenParams:E=this.settings.extraTokenParams,dpopJkt:f,omitScopeWhenRequesting:m=this.settings.omitScopeWhenRequesting}){const x=this._logger.create("createSigninRequest");if(l!=="code")throw new Error("Only the Authorization Code flow (with PKCE) is supported");const w=await this.metadataService.getAuthorizationEndpoint();x.debug("Received authorization endpoint",w);const P=await ya.create({url:w,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:h,response_type:l,scope:d,state_data:i,url_state:c,prompt:p,display:u,max_age:g,ui_locales:b,id_token_hint:a,login_hint:r,acr_values:_,dpopJkt:f,resource:v,request:e,request_uri:t,extraQueryParams:U,extraTokenParams:E,request_type:s,response_mode:T,client_secret:this.settings.client_secret,skipUserInfo:n,nonce:o,disablePKCE:this.settings.disablePKCE,omitScopeWhenRequesting:m});await this.clearStaleState();const A=P.state;return await this.settings.stateStore.set(A.id,A.toStorageString()),P}async readSigninResponseState(i,e=!1){const t=this._logger.create("readSigninResponseState"),s=new lt(kt.readParams(i,this.settings.response_mode));if(!s.state)throw t.throw(new Error("No state in response")),null;const a=await this.settings.stateStore[e?"remove":"get"](s.state);if(!a)throw t.throw(new Error("No matching state found in storage")),null;return{state:await ks.fromStorageString(a),response:s}}async processSigninResponse(i,e,t=!0){const s=this._logger.create("processSigninResponse"),{state:a,response:r}=await this.readSigninResponseState(i,t);if(s.debug("received state from storage; validating response"),this.settings.dpop&&this.settings.dpop.store){const n=await this.getDpopProof(this.settings.dpop.store);e=me(V({},e),{DPoP:n})}try{await this._validator.validateSigninResponse(r,a,e)}catch(n){if(n instanceof xt&&this.settings.dpop){const o=await this.getDpopProof(this.settings.dpop.store,n.nonce);e.DPoP=o,await this._validator.validateSigninResponse(r,a,e)}else throw n}return r}async getDpopProof(i,e){let t,s;return(await i.getAllKeys()).includes(this.settings.client_id)?(s=await i.get(this.settings.client_id),s.nonce!==e&&e&&(s.nonce=e,await i.set(this.settings.client_id,s))):(t=await Q.generateDPoPKeys(),s=new vs(t,e),await i.set(this.settings.client_id,s)),await Q.generateDPoPProof({url:await this.metadataService.getTokenEndpoint(!1),httpMethod:"POST",keyPair:s.keys,nonce:s.nonce})}async processResourceOwnerPasswordCredentials({username:i,password:e,skipUserInfo:t=!1,extraTokenParams:s={}}){const a=await this._tokenClient.exchangeCredentials(V({username:i,password:e},s)),r=new lt(new URLSearchParams);return Object.assign(r,a),await this._validator.validateCredentialsResponse(r,t),r}async useRefreshToken({state:i,redirect_uri:e,resource:t,timeoutInSeconds:s,extraHeaders:a,extraTokenParams:r}){var n;const o=this._logger.create("useRefreshToken");let c;if(this.settings.refreshTokenAllowedScope===void 0)c=i.scope;else{const h=this.settings.refreshTokenAllowedScope.split(" ");c=(((n=i.scope)==null?void 0:n.split(" "))||[]).filter(u=>h.includes(u)).join(" ")}if(this.settings.dpop&&this.settings.dpop.store){const h=await this.getDpopProof(this.settings.dpop.store);a=me(V({},a),{DPoP:h})}let l;try{l=await this._tokenClient.exchangeRefreshToken(V({refresh_token:i.refresh_token,scope:c,redirect_uri:e,resource:t,timeoutInSeconds:s,extraHeaders:a},r))}catch(h){if(h instanceof xt&&this.settings.dpop)a.DPoP=await this.getDpopProof(this.settings.dpop.store,h.nonce),l=await this._tokenClient.exchangeRefreshToken(V({refresh_token:i.refresh_token,scope:c,redirect_uri:e,resource:t,timeoutInSeconds:s,extraHeaders:a},r));else throw h}const d=new lt(new URLSearchParams);return Object.assign(d,l),o.debug("validating response",d),await this._validator.validateRefreshResponse(d,me(V({},i),{scope:c})),d}async createSignoutRequest({state:i,id_token_hint:e,client_id:t,request_type:s,url_state:a,post_logout_redirect_uri:r=this.settings.post_logout_redirect_uri,extraQueryParams:n=this.settings.extraQueryParams}={}){const o=this._logger.create("createSignoutRequest"),c=await this.metadataService.getEndSessionEndpoint();if(!c)throw o.throw(new Error("No end session endpoint")),null;o.debug("Received end session endpoint",c),!t&&r&&!e&&(t=this.settings.client_id);const l=new ka({url:c,id_token_hint:e,client_id:t,post_logout_redirect_uri:r,state_data:i,extraQueryParams:n,request_type:s,url_state:a});await this.clearStaleState();const d=l.state;return d&&(o.debug("Signout request has state to persist"),await this.settings.stateStore.set(d.id,d.toStorageString())),l}async readSignoutResponseState(i,e=!1){const t=this._logger.create("readSignoutResponseState"),s=new xa(kt.readParams(i,this.settings.response_mode));if(!s.state){if(t.debug("No state in response"),s.error)throw t.warn("Response was error:",s.error),new Le(s);return{state:void 0,response:s}}const a=await this.settings.stateStore[e?"remove":"get"](s.state);if(!a)throw t.throw(new Error("No matching state found in storage")),null;return{state:await st.fromStorageString(a),response:s}}async processSignoutResponse(i){const e=this._logger.create("processSignoutResponse"),{state:t,response:s}=await this.readSignoutResponseState(i,!0);return t?(e.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(s,t)):e.debug("No state from storage; skipping response validation"),s}clearStaleState(){return this._logger.create("clearStaleState"),st.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(i,e){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:i,token_type_hint:e})}},Sa=class{constructor(i){this._userManager=i,this._logger=new F("SessionMonitor"),this._start=async e=>{const t=e.session_state;if(!t)return;const s=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,s.debug("session_state",t,", sub",this._sub)):(this._sub=void 0,s.debug("session_state",t,", anonymous user")),this._checkSessionIFrame){this._checkSessionIFrame.start(t);return}try{const a=await this._userManager.metadataService.getCheckSessionIframe();if(a){s.debug("initializing check session iframe");const r=this._userManager.settings.client_id,n=this._userManager.settings.checkSessionIntervalInSeconds,o=this._userManager.settings.stopCheckSessionOnError,c=new ca(this._callback,r,a,n,o);await c.load(),this._checkSessionIFrame=c,c.start(t)}else s.warn("no check session iframe found in the metadata")}catch(a){s.error("Error from getCheckSessionIframe:",a instanceof Error?a.message:a)}},this._stop=()=>{const e=this._logger.create("_stop");if(this._sub=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){const t=setInterval(async()=>{clearInterval(t);try{const s=await this._userManager.querySessionStatus();if(s){const a={session_state:s.session_state,profile:s.sub?{sub:s.sub}:null};this._start(a)}}catch(s){e.error("error from querySessionStatus",s instanceof Error?s.message:s)}},1e3)}},this._callback=async()=>{const e=this._logger.create("_callback");try{const t=await this._userManager.querySessionStatus();let s=!0;t&&this._checkSessionIFrame?t.sub===this._sub?(s=!1,this._checkSessionIFrame.start(t.session_state),e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",t.session_state),await this._userManager.events._raiseUserSessionChanged()):e.debug("different subject signed into OP",t.sub):e.debug("subject no longer signed into OP"),s?this._sub?await this._userManager.events._raiseUserSignedOut():await this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(t){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",t),await this._userManager.events._raiseUserSignedOut())}},i||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch(e=>{this._logger.error(e)})}async _init(){this._logger.create("_init");const i=await this._userManager.getUser();if(i)this._start(i);else if(this._userManager.settings.monitorAnonymousSession){const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub?{sub:e.sub}:null};this._start(t)}}}},ct=class _s{constructor(e){var t;this.id_token=e.id_token,this.session_state=(t=e.session_state)!=null?t:null,this.access_token=e.access_token,this.refresh_token=e.refresh_token,this.token_type=e.token_type,this.scope=e.scope,this.profile=e.profile,this.expires_at=e.expires_at,this.state=e.userState,this.url_state=e.url_state}get expires_in(){if(this.expires_at!==void 0)return this.expires_at-ke.getEpochTime()}set expires_in(e){e!==void 0&&(this.expires_at=Math.floor(e)+ke.getEpochTime())}get expired(){const e=this.expires_in;if(e!==void 0)return e<=0}get scopes(){var e,t;return(t=(e=this.scope)==null?void 0:e.split(" "))!=null?t:[]}toStorageString(){return new F("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(e){return F.createStatic("User","fromStorageString"),new _s(JSON.parse(e))}},Xt="oidc-client",Ts=class{constructor(){this._abort=new we("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}async navigate(i){const e=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");e.debug("setting URL in window"),this._window.location.replace(i.url);const{url:t,keepOpen:s}=await new Promise((a,r)=>{const n=c=>{var l;const d=c.data,h=(l=i.scriptOrigin)!=null?l:window.location.origin;if(!(c.origin!==h||(d==null?void 0:d.source)!==Xt)){try{const p=kt.readParams(d.url,i.response_mode).get("state");if(p||e.warn("no state found in response url"),c.source!==this._window&&p!==i.state)return}catch(p){this._dispose(),r(new Error("Invalid response from window"))}a(d)}};window.addEventListener("message",n,!1),this._disposeHandlers.add(()=>window.removeEventListener("message",n,!1));const o=new BroadcastChannel(`oidc-client-popup-${i.state}`);o.addEventListener("message",n,!1),this._disposeHandlers.add(()=>o.close()),this._disposeHandlers.add(this._abort.addHandler(c=>{this._dispose(),r(c)}))});return e.debug("got response from window"),this._dispose(),s||this.close(),{url:t}}_dispose(){this._logger.create("_dispose");for(const i of this._disposeHandlers)i();this._disposeHandlers.clear()}static _notifyParent(i,e,t=!1,s=window.location.origin){const a={source:Xt,url:e,keepOpen:t},r=new F("_notifyParent");if(i)r.debug("With parent. Using parent.postMessage."),i.postMessage(a,s);else{r.debug("No parent. Using BroadcastChannel.");const n=new URL(e).searchParams.get("state");if(!n)throw new Error("No parent and no state in URL. Can't complete notification.");const o=new BroadcastChannel(`oidc-client-popup-${n}`);o.postMessage(a),o.close()}}},Ss={location:!1,toolbar:!1,height:640,closePopupWindowAfterInSeconds:-1},Ls="_blank",La=60,Ea=2,Es=10,Ia=class extends wt{constructor(i){const{popup_redirect_uri:e=i.redirect_uri,popup_post_logout_redirect_uri:t=i.post_logout_redirect_uri,popupWindowFeatures:s=Ss,popupWindowTarget:a=Ls,redirectMethod:r="assign",redirectTarget:n="self",iframeNotifyParentOrigin:o=i.iframeNotifyParentOrigin,iframeScriptOrigin:c=i.iframeScriptOrigin,requestTimeoutInSeconds:l,silent_redirect_uri:d=i.redirect_uri,silentRequestTimeoutInSeconds:h,automaticSilentRenew:p=!0,validateSubOnSilentRenew:u=!0,includeIdTokenInSilentRenew:g=!1,monitorSession:b=!1,monitorAnonymousSession:_=!1,checkSessionIntervalInSeconds:v=Ea,query_status_response_type:T="code",stopCheckSessionOnError:U=!0,revokeTokenTypes:E=["access_token","refresh_token"],revokeTokensOnSignout:f=!1,includeIdTokenInSilentSignout:m=!1,accessTokenExpiringNotificationTimeInSeconds:x=La,userStore:w}=i;if(super(i),this.popup_redirect_uri=e,this.popup_post_logout_redirect_uri=t,this.popupWindowFeatures=s,this.popupWindowTarget=a,this.redirectMethod=r,this.redirectTarget=n,this.iframeNotifyParentOrigin=o,this.iframeScriptOrigin=c,this.silent_redirect_uri=d,this.silentRequestTimeoutInSeconds=h||l||Es,this.automaticSilentRenew=p,this.validateSubOnSilentRenew=u,this.includeIdTokenInSilentRenew=g,this.monitorSession=b,this.monitorAnonymousSession=_,this.checkSessionIntervalInSeconds=v,this.stopCheckSessionOnError=U,this.query_status_response_type=T,this.revokeTokenTypes=E,this.revokeTokensOnSignout=f,this.includeIdTokenInSilentSignout=m,this.accessTokenExpiringNotificationTimeInSeconds=x,w)this.userStore=w;else{const P=typeof window!="undefined"?window.sessionStorage:new ys;this.userStore=new Bt({store:P})}}},Yt=class Is extends Ts{constructor({silentRequestTimeoutInSeconds:e=Es}){super(),this._logger=new F("IFrameWindow"),this._timeoutInSeconds=e,this._frame=Is.createHiddenIframe(),this._window=this._frame.contentWindow}static createHiddenIframe(){const e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",window.document.body.appendChild(e),e}async navigate(e){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);const t=setTimeout(()=>void this._abort.raise(new Ct("IFrame timed out without a response")),this._timeoutInSeconds*1e3);return this._disposeHandlers.add(()=>clearTimeout(t)),await super.navigate(e)}close(){var e;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",t=>{var s;const a=t.target;(s=a.parentNode)==null||s.removeChild(a),this._abort.raise(new Error("IFrame removed from DOM"))},!0),(e=this._frame.contentWindow)==null||e.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(e,t){return super._notifyParent(window.parent,e,!1,t)}},Aa=class{constructor(i){this._settings=i,this._logger=new F("IFrameNavigator")}async prepare({silentRequestTimeoutInSeconds:i=this._settings.silentRequestTimeoutInSeconds}){return new Yt({silentRequestTimeoutInSeconds:i})}async callback(i){this._logger.create("callback"),Yt.notifyParent(i,this._settings.iframeNotifyParentOrigin)}},Pa=500,Ma=1e3,Qt=class extends Ts{constructor({popupWindowTarget:i=Ls,popupWindowFeatures:e={},popupSignal:t,popupAbortOnClose:s}){super(),this._logger=new F("PopupWindow");const a=Zt.center(V(V({},Ss),e));this._window=window.open(void 0,i,Zt.serialize(a)),this.abortOnClose=!!s,t&&t.addEventListener("abort",()=>{var r;this._abort.raise(new Error((r=t.reason)!=null?r:"Popup aborted"))}),e.closePopupWindowAfterInSeconds&&e.closePopupWindowAfterInSeconds>0&&setTimeout(()=>{if(!this._window||typeof this._window.closed!="boolean"||this._window.closed){this._abort.raise(new Error("Popup blocked by user"));return}this.close()},e.closePopupWindowAfterInSeconds*Ma)}async navigate(i){var e;(e=this._window)==null||e.focus();const t=setInterval(()=>{(!this._window||this._window.closed)&&(this._logger.debug("Popup closed by user or isolated by redirect"),s(),this._disposeHandlers.delete(s),this.abortOnClose&&this._abort.raise(new Error("Popup closed by user")))},Pa),s=()=>clearInterval(t);return this._disposeHandlers.add(s),await super.navigate(i)}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(i,e){super._notifyParent(window.opener,i,e),!e&&!window.opener&&window.close()}},Ca=class{constructor(i){this._settings=i,this._logger=new F("PopupNavigator")}async prepare({popupWindowFeatures:i=this._settings.popupWindowFeatures,popupWindowTarget:e=this._settings.popupWindowTarget,popupSignal:t,popupAbortOnClose:s}){return new Qt({popupWindowFeatures:i,popupWindowTarget:e,popupSignal:t,popupAbortOnClose:s})}async callback(i,{keepOpen:e=!1}){this._logger.create("callback"),Qt.notifyOpener(i,e)}},Ha=class{constructor(i){this._settings=i,this._logger=new F("RedirectNavigator")}async prepare({redirectMethod:i=this._settings.redirectMethod,redirectTarget:e=this._settings.redirectTarget}){var t;this._logger.create("prepare");let s=window.self;e==="top"&&(s=(t=window.top)!=null?t:window.self);const a=s.location[i].bind(s.location);let r;return{navigate:async n=>(this._logger.create("navigate"),await new Promise((c,l)=>{r=l,window.addEventListener("pageshow",()=>c(window.location.href)),a(n.url)})),close:()=>{this._logger.create("close"),r==null||r(new Error("Redirect aborted")),s.stop()}}}async callback(){}},Ba=class extends la{constructor(i){super({expiringNotificationTimeInSeconds:i.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new F("UserManagerEvents"),this._userLoaded=new we("User loaded"),this._userUnloaded=new we("User unloaded"),this._silentRenewError=new we("Silent renew error"),this._userSignedIn=new we("User signed in"),this._userSignedOut=new we("User signed out"),this._userSessionChanged=new we("User session changed")}async load(i,e=!0){await super.load(i),e&&await this._userLoaded.raise(i)}async unload(){await super.unload(),await this._userUnloaded.raise()}addUserLoaded(i){return this._userLoaded.addHandler(i)}removeUserLoaded(i){return this._userLoaded.removeHandler(i)}addUserUnloaded(i){return this._userUnloaded.addHandler(i)}removeUserUnloaded(i){return this._userUnloaded.removeHandler(i)}addSilentRenewError(i){return this._silentRenewError.addHandler(i)}removeSilentRenewError(i){return this._silentRenewError.removeHandler(i)}async _raiseSilentRenewError(i){await this._silentRenewError.raise(i)}addUserSignedIn(i){return this._userSignedIn.addHandler(i)}removeUserSignedIn(i){this._userSignedIn.removeHandler(i)}async _raiseUserSignedIn(){await this._userSignedIn.raise()}addUserSignedOut(i){return this._userSignedOut.addHandler(i)}removeUserSignedOut(i){this._userSignedOut.removeHandler(i)}async _raiseUserSignedOut(){await this._userSignedOut.raise()}addUserSessionChanged(i){return this._userSessionChanged.addHandler(i)}removeUserSessionChanged(i){this._userSessionChanged.removeHandler(i)}async _raiseUserSessionChanged(){await this._userSessionChanged.raise()}},za=class{constructor(i){this._userManager=i,this._logger=new F("SilentRenewService"),this._isStarted=!1,this._retryTimer=new ke("Retry Silent Renew"),this._tokenExpiring=async()=>{const e=this._logger.create("_tokenExpiring");try{await this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(t){if(t instanceof Ct){e.warn("ErrorTimeout from signinSilent:",t,"retry in 5s"),this._retryTimer.init(5);return}e.error("Error from signinSilent:",t),await this._userManager.events._raiseSilentRenewError(t)}}}async start(){const i=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{await this._userManager.getUser()}catch(e){i.error("getUser error",e)}}}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}},Ka=class{constructor(i){this.refresh_token=i.refresh_token,this.id_token=i.id_token,this.session_state=i.session_state,this.scope=i.scope,this.profile=i.profile,this.data=i.state}},Na=class{constructor(i,e,t,s){this._logger=new F("UserManager"),this.settings=new Ia(i),this._client=new Ta(i),this._redirectNavigator=e!=null?e:new Ha(this.settings),this._popupNavigator=t!=null?t:new Ca(this.settings),this._iframeNavigator=s!=null?s:new Aa(this.settings),this._events=new Ba(this.settings),this._silentRenewService=new za(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new Sa(this))}get events(){return this._events}get metadataService(){return this._client.metadataService}async getUser(i=!1){const e=this._logger.create("getUser"),t=await this._loadUser();return t?(e.info("user loaded"),await this._events.load(t,i),t):(e.info("user not found in storage"),null)}async removeUser(){const i=this._logger.create("removeUser");await this.storeUser(null),i.info("user removed from storage"),await this._events.unload()}async signinRedirect(i={}){var e;this._logger.create("signinRedirect");const n=i,{redirectMethod:t}=n,s=ae(n,["redirectMethod"]);let a;(e=this.settings.dpop)!=null&&e.bind_authorization_code&&(a=await this.generateDPoPJkt(this.settings.dpop));const r=await this._redirectNavigator.prepare({redirectMethod:t});await this._signinStart(V({request_type:"si:r",dpopJkt:a},s),r)}async signinRedirectCallback(i=window.location.href){const e=this._logger.create("signinRedirectCallback"),t=await this._signinEnd(i);return t.profile&&t.profile.sub?e.info("success, signed in subject",t.profile.sub):e.info("no subject"),t}async signinResourceOwnerCredentials({username:i,password:e,skipUserInfo:t=!1}){const s=this._logger.create("signinResourceOwnerCredential"),a=await this._client.processResourceOwnerPasswordCredentials({username:i,password:e,skipUserInfo:t,extraTokenParams:this.settings.extraTokenParams});s.debug("got signin response");const r=await this._buildUser(a);return r.profile&&r.profile.sub?s.info("success, signed in subject",r.profile.sub):s.info("no subject"),r}async signinPopup(i={}){var e;const t=this._logger.create("signinPopup");let s;(e=this.settings.dpop)!=null&&e.bind_authorization_code&&(s=await this.generateDPoPJkt(this.settings.dpop));const p=i,{popupWindowFeatures:a,popupWindowTarget:r,popupSignal:n,popupAbortOnClose:o}=p,c=ae(p,["popupWindowFeatures","popupWindowTarget","popupSignal","popupAbortOnClose"]),l=this.settings.popup_redirect_uri;l||t.throw(new Error("No popup_redirect_uri configured"));const d=await this._popupNavigator.prepare({popupWindowFeatures:a,popupWindowTarget:r,popupSignal:n,popupAbortOnClose:o}),h=await this._signin(V({request_type:"si:p",redirect_uri:l,display:"popup",dpopJkt:s},c),d);return h&&(h.profile&&h.profile.sub?t.info("success, signed in subject",h.profile.sub):t.info("no subject")),h}async signinPopupCallback(i=window.location.href,e=!1){const t=this._logger.create("signinPopupCallback");await this._popupNavigator.callback(i,{keepOpen:e}),t.info("success")}async signinSilent(i={}){var e,t;const s=this._logger.create("signinSilent"),h=i,{silentRequestTimeoutInSeconds:a}=h,r=ae(h,["silentRequestTimeoutInSeconds"]);let n=await this._loadUser();if(!i.forceIframeAuth&&(n!=null&&n.refresh_token)){s.debug("using refresh token");const p=new Ka(n);return await this._useRefreshToken({state:p,redirect_uri:r.redirect_uri,resource:r.resource,extraTokenParams:r.extraTokenParams,timeoutInSeconds:a})}let o;(e=this.settings.dpop)!=null&&e.bind_authorization_code&&(o=await this.generateDPoPJkt(this.settings.dpop));const c=this.settings.silent_redirect_uri;c||s.throw(new Error("No silent_redirect_uri configured"));let l;n&&this.settings.validateSubOnSilentRenew&&(s.debug("subject prior to silent renew:",n.profile.sub),l=n.profile.sub);const d=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:a});return n=await this._signin(V({request_type:"si:s",redirect_uri:c,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?n==null?void 0:n.id_token:void 0,dpopJkt:o},r),d,l),n&&((t=n.profile)!=null&&t.sub?s.info("success, signed in subject",n.profile.sub):s.info("no subject")),n}async _useRefreshToken(i){const e=await this._client.useRefreshToken(V({timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds},i)),t=new ct(V(V({},i.state),e));return await this.storeUser(t),await this._events.load(t),t}async signinSilentCallback(i=window.location.href){const e=this._logger.create("signinSilentCallback");await this._iframeNavigator.callback(i),e.info("success")}async signinCallback(i=window.location.href){const{state:e}=await this._client.readSigninResponseState(i);switch(e.request_type){case"si:r":return await this.signinRedirectCallback(i);case"si:p":await this.signinPopupCallback(i);break;case"si:s":await this.signinSilentCallback(i);break;default:throw new Error("invalid response_type in state")}}async signoutCallback(i=window.location.href,e=!1){const{state:t}=await this._client.readSignoutResponseState(i);if(t)switch(t.request_type){case"so:r":return await this.signoutRedirectCallback(i);case"so:p":await this.signoutPopupCallback(i,e);break;case"so:s":await this.signoutSilentCallback(i);break;default:throw new Error("invalid response_type in state")}}async querySessionStatus(i={}){const e=this._logger.create("querySessionStatus"),c=i,{silentRequestTimeoutInSeconds:t}=c,s=ae(c,["silentRequestTimeoutInSeconds"]),a=this.settings.silent_redirect_uri;a||e.throw(new Error("No silent_redirect_uri configured"));const r=await this._loadUser(),n=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:t}),o=await this._signinStart(V({request_type:"si:s",redirect_uri:a,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?r==null?void 0:r.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0},s),n);try{const l={},d=await this._client.processSigninResponse(o.url,l);return e.debug("got signin response"),d.session_state&&d.profile.sub?(e.info("success for subject",d.profile.sub),{session_state:d.session_state,sub:d.profile.sub}):(e.info("success, user not authenticated"),null)}catch(l){if(this.settings.monitorAnonymousSession&&l instanceof Le)switch(l.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return e.info("success for anonymous user"),{session_state:l.session_state}}throw l}}async _signin(i,e,t){const s=await this._signinStart(i,e);return await this._signinEnd(s.url,t)}async _signinStart(i,e){const t=this._logger.create("_signinStart");try{const s=await this._client.createSigninRequest(i);return t.debug("got signin request"),await e.navigate({url:s.url,state:s.state.id,response_mode:s.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(s){throw t.debug("error after preparing navigator, closing navigator window"),e.close(),s}}async _signinEnd(i,e){const t=this._logger.create("_signinEnd"),s={},a=await this._client.processSigninResponse(i,s);return t.debug("got signin response"),await this._buildUser(a,e)}async _buildUser(i,e){const t=this._logger.create("_buildUser"),s=new ct(i);if(e){if(e!==s.profile.sub)throw t.debug("current user does not match user returned from signin. sub from signin:",s.profile.sub),new Le(me(V({},i),{error:"login_required"}));t.debug("current user matches user returned from signin")}return await this.storeUser(s),t.debug("user stored"),await this._events.load(s),s}async signoutRedirect(i={}){const e=this._logger.create("signoutRedirect"),r=i,{redirectMethod:t}=r,s=ae(r,["redirectMethod"]),a=await this._redirectNavigator.prepare({redirectMethod:t});await this._signoutStart(V({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri},s),a),e.info("success")}async signoutRedirectCallback(i=window.location.href){const e=this._logger.create("signoutRedirectCallback"),t=await this._signoutEnd(i);return e.info("success"),t}async signoutPopup(i={}){const e=this._logger.create("signoutPopup"),c=i,{popupWindowFeatures:t,popupWindowTarget:s,popupSignal:a}=c,r=ae(c,["popupWindowFeatures","popupWindowTarget","popupSignal"]),n=this.settings.popup_post_logout_redirect_uri,o=await this._popupNavigator.prepare({popupWindowFeatures:t,popupWindowTarget:s,popupSignal:a});await this._signout(V({request_type:"so:p",post_logout_redirect_uri:n,state:n==null?void 0:{}},r),o),e.info("success")}async signoutPopupCallback(i=window.location.href,e=!1){const t=this._logger.create("signoutPopupCallback");await this._popupNavigator.callback(i,{keepOpen:e}),t.info("success")}async _signout(i,e){const t=await this._signoutStart(i,e);return await this._signoutEnd(t.url)}async _signoutStart(i={},e){var t;const s=this._logger.create("_signoutStart");try{const a=await this._loadUser();s.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&await this._revokeInternal(a);const r=i.id_token_hint||a&&a.id_token;r&&(s.debug("setting id_token_hint in signout request"),i.id_token_hint=r),await this.removeUser(),s.debug("user removed, creating signout request");const n=await this._client.createSignoutRequest(i);return s.debug("got signout request"),await e.navigate({url:n.url,state:(t=n.state)==null?void 0:t.id,scriptOrigin:this.settings.iframeScriptOrigin})}catch(a){throw s.debug("error after preparing navigator, closing navigator window"),e.close(),a}}async _signoutEnd(i){const e=this._logger.create("_signoutEnd"),t=await this._client.processSignoutResponse(i);return e.debug("got signout response"),t}async signoutSilent(i={}){var e;const t=this._logger.create("signoutSilent"),c=i,{silentRequestTimeoutInSeconds:s}=c,a=ae(c,["silentRequestTimeoutInSeconds"]),r=this.settings.includeIdTokenInSilentSignout?(e=await this._loadUser())==null?void 0:e.id_token:void 0,n=this.settings.popup_post_logout_redirect_uri,o=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:s});await this._signout(V({request_type:"so:s",post_logout_redirect_uri:n,id_token_hint:r},a),o),t.info("success")}async signoutSilentCallback(i=window.location.href){const e=this._logger.create("signoutSilentCallback");await this._iframeNavigator.callback(i),e.info("success")}async revokeTokens(i){const e=await this._loadUser();await this._revokeInternal(e,i)}async _revokeInternal(i,e=this.settings.revokeTokenTypes){const t=this._logger.create("_revokeInternal");if(!i)return;const s=e.filter(a=>typeof i[a]=="string");if(!s.length){t.debug("no need to revoke due to no token(s)");return}for(const a of s)await this._client.revokeToken(i[a],a),t.info(`${a} revoked successfully`),a!=="access_token"&&(i[a]=null);await this.storeUser(i),t.debug("user stored"),await this._events.load(i)}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return`user:${this.settings.authority}:${this.settings.client_id}`}async _loadUser(){const i=this._logger.create("_loadUser"),e=await this.settings.userStore.get(this._userStoreKey);return e?(i.debug("user storageString loaded"),ct.fromStorageString(e)):(i.debug("no user storageString"),null)}async storeUser(i){const e=this._logger.create("storeUser");if(i){e.debug("storing user");const t=i.toStorageString();await this.settings.userStore.set(this._userStoreKey,t)}else this._logger.debug("removing user"),await this.settings.userStore.remove(this._userStoreKey),this.settings.dpop&&await this.settings.dpop.store.remove(this.settings.client_id)}async clearStaleState(){await this._client.clearStaleState()}async dpopProof(i,e,t,s){var a,r;const n=await((r=(a=this.settings.dpop)==null?void 0:a.store)==null?void 0:r.get(this.settings.client_id));if(n)return await Q.generateDPoPProof({url:i,accessToken:e==null?void 0:e.access_token,httpMethod:t,keyPair:n.keys,nonce:s})}async generateDPoPJkt(i){let e=await i.store.get(this.settings.client_id);if(!e){const t=await Q.generateDPoPKeys();e=new vs(t),await i.store.set(this.settings.client_id,e)}return await Q.generateDPoPJkt(e.keys)}};function Oa(){return{issuerUrl:String("https://auth.h.thyvo.eu/application/o/schema/"),clientId:String("LedPwatI9rCJmOOfRIS6vfnmhWyifsBo5BkRWezv"),audience:void 0,scope:String("openid profile email")}}function Va(){return window.location.origin+window.location.pathname}class Da{constructor(){this.env=Oa(),this.manager=this.env?new Na({authority:this.env.issuerUrl,client_id:this.env.clientId,redirect_uri:Va(),response_type:"code",scope:this.env.scope,userStore:new Bt({store:window.sessionStorage}),automaticSilentRenew:!1,loadUserInfo:!0}):null}isEnabled(){return!!this.manager}async init(){var s;if(!this.manager)return;const e=new URLSearchParams(window.location.search);if(e.has("code")&&e.has("state"))try{const a=await this.manager.signinRedirectCallback(),r=(s=a==null?void 0:a.state)==null?void 0:s.returnUrl;window.history.replaceState(null,document.title,r||window.location.origin+window.location.pathname+window.location.hash)}catch(a){window.history.replaceState(null,document.title,window.location.origin+window.location.pathname+window.location.hash),console.warn("OIDC callback handling failed",a)}try{await this.manager.getUser()}catch(a){}}async login(){if(!this.manager){alert("Login is niet geconfigureerd op deze site.");return}const e=window.location.href;try{await this.manager.signinRedirect({state:{returnUrl:e}})}catch(t){console.error("signinRedirect failed",t);const s=t!=null&&t.message?String(t.message):String(t),a=s.toLowerCase().includes("failed to fetch")?" (kan CORS/HTTPS of een onbereikbare issuer zijn)":"";throw alert(`Aanmelden mislukt: ${s}${a}`),t}}async logout(){if(this.manager){try{await this.manager.removeUser()}catch(e){}alert("Uitgelogd.")}}async getUser(){if(!this.manager)return null;const e=await this.manager.getUser();return!e||e.expired?null:e}async getAccessToken(){const e=await this.getUser();return(e==null?void 0:e.access_token)||null}async getProfile(){const e=await this.getUser();if(!e)return null;const t=e.profile||{};return t.sub?{sub:String(t.sub),name:t.name?String(t.name):void 0,email:t.email?String(t.email):void 0}:null}}const D=new Da;class $a{constructor(){this.clear()}clear(){this.saveNeeded=!1,this.fileHandle=null,this.filename=null}updateLastSaved(){var e=new Date;this.lastsaved=e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")+":"+e.getSeconds().toString().padStart(2,"0"),document.getElementById("exportscreen")&&Bs()}setSaveNeeded(e){this.saveNeeded,this.saveNeeded=e}async readFile(){[this.fileHandle]=await window.showOpenFilePicker({types:[{description:"Eendraadschema (.eds)",accept:{"application/eds":[".eds"]}}]});const e=await this.fileHandle.getFile(),t=await e.text();return this.filename=e.name,globalThis.structure.properties.filename=e.name,this.setSaveNeeded(!1),this.updateLastSaved(),t}async saveAs(e){const t={suggestedName:globalThis.structure.properties.filename,types:[{description:"Eendraadschema (.eds)",accept:{"application/eds":[".eds"]}}],startIn:"documents"};this.fileHandle=await window.showSaveFilePicker(t),await this.saveFile(e,this.fileHandle)}async saveFile(e,t){const s=await t.createWritable();await s.write(e),await s.close(),this.filename=t.name,globalThis.structure.properties.filename=t.name,this.setSaveNeeded(!1),this.updateLastSaved()}async save(e){await this.saveFile(e,this.fileHandle)}}globalThis.importjson=i=>{var e=i.target,t=new FileReader;t.onload=function(){globalThis.currentShareId=null,ne(t.result.toString()),globalThis.structure.sitplan&&(globalThis.structure.sitplan.activePage=1)},t.readAsText(e.files[0])};globalThis.appendjson=function(i){var e=i.target,t=new FileReader;t.onload=function(){Ua(t.result.toString())},t.readAsText(e.files[0])};globalThis.loadClicked=async()=>{if(window.showOpenFilePicker){let i=await globalThis.fileAPIobj.readFile();globalThis.currentShareId=null,ne(i),globalThis.structure.sitplan&&(globalThis.structure.sitplan.activePage=1)}else document.getElementById("importfile").click(),document.getElementById("importfile").value=""};globalThis.importToAppendClicked=async()=>{document.getElementById("appendfile").click(),document.getElementById("appendfile").value=""};function ja(i,e){if(e==1&&i.length>0&&typeof i.data[0].keys=="undefined"&&typeof i.data[0].props!="undefined"&&(e=3),e<2)for(let t=0;t<i.length;t++)i.data[t].keys[0][2]==="Vrije tekst"&&i.data[t].keys[16][2]!="verbruiker"&&(Number(i.data[t].keys[22][2])>0?i.data[t].keys[22][2]=String(Number(i.data[t].keys[22][2])+30):i.data[t].keys[18][2]="automatisch",i.data[t].keys[16][2]!="zonder kader"&&(i.data[t].keys[16][2]="verbruiker"));if(e<3)for(let t=0;t<i.length;t++)i.data[t].keys[0][2]==="Stopcontact"&&(i.data[t].keys[0][2]="Contactdoos"),i.data[t].keys[0][2]==="Leeg"&&(i.data[t].keys[0][2]="Aansluitpunt");if(e==3)for(let t=0;t<i.length;t++)i.data[t].props.type==="Stopcontact"&&(i.data[t].props.type="Contactdoos");if(e<4)if(e<3)for(let t=0;t<i.length;t++)i.data[t].keys[0][2]==="Bord"&&i.data[t].keys[10][2]!==""&&(i.data[t].keys[10][2]="<"+i.data[t].keys[10][2]+">");else for(let t=0;t<i.length;t++)i.data[t].props.type==="Bord"&&i.data[t].props.naam!==""&&(i.data[t].props.naam="<"+i.data[t].props.naam+">");if(e>=3&&e<=4)for(let t=0;t<i.length;t++)i.data[t].props.type==="Leeg"&&(i.data[t].props.type="Aansluitpunt")}globalThis.exportjson=(i=!0)=>{function e(r){let o="";for(let c=0;c<r.length;c+=32768)o+=String.fromCharCode.apply(null,r.subarray(c,c+32768));return btoa(o)}var t;t=globalThis.structure.properties.filename;let s=globalThis.structure.toJsonObject(!0),a="";try{if(globalThis.structure.properties.disableEDSCompression==!0)throw new Error("Compression is disabled");let r=new TextEncoder,n=new Uint8Array(r.encode(s)),o=new Uint8Array(pako.deflate(n));a="EDS0040000"+e(o)}catch(r){console.log("Terugvallen naar TXT-uitvoer vanwege compressiefout: "+r),a="TXT0040000"+s}finally{window.showOpenFilePicker?(globalThis.fileAPIobj.filename==null&&i==!1&&(i=!0),i?globalThis.fileAPIobj.saveAs(a).then(()=>{globalThis.autoSaver.saveManually("TXT0040000"+s)}):globalThis.fileAPIobj.save(a).then(()=>{globalThis.autoSaver.saveManually("TXT0040000"+s)})):(Hs(a,t,"data:text/eds;charset=utf-8"),globalThis.autoSaver.saveManually("TXT0040000"+s))}globalThis.propUpload(a)};function Ra(){function i(t){let a="";for(let r=0;r<t.length;r+=32768)a+=String.fromCharCode.apply(null,t.subarray(r,r+32768));return btoa(a)}const e=globalThis.structure.toJsonObject(!0);try{if(globalThis.structure.properties.disableEDSCompression==!0)throw new Error("Compression is disabled");const t=new TextEncoder,s=new Uint8Array(t.encode(e)),a=new Uint8Array(pako.deflate(s));return{schemaText:"EDS0040000"+i(a),origJson:e}}catch(t){return console.log("Terugvallen naar TXT-save vanwege compressiefout: "+t),{schemaText:"TXT0040000"+e,origJson:e}}}async function As(i){if(!D.isEnabled()){alert("Cloud opslaan vereist OIDC, maar OIDC is niet geconfigureerd.");return}const e=await D.getAccessToken();if(!e){globalThis.exportjson(!!i);return}const t=window.location.href.split("#")[0],{schemaText:s,origJson:a}=Ra();let r=i?null:globalThis.currentShareId||null;r||(i=!0);try{if(i){const o=await fetch("/api/shares",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},credentials:"include",body:JSON.stringify({schema:s,baseUrl:t})});if(!o.ok){alert(`Kon niet opslaan in cloud: ${o.status} ${await o.text()}`);return}const c=await o.json();if(!(c!=null&&c.id)){alert("Kon niet opslaan in cloud (ongeldig antwoord).");return}globalThis.currentShareId=String(c.id),globalThis.autoSaver&&globalThis.autoSaver.saveManually("TXT0040000"+a),alert(`Opgeslagen in cloud. Share ID: ${c.id}`);return}const n=await fetch(`/api/shares/${encodeURIComponent(String(r))}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},credentials:"include",body:JSON.stringify({schema:s})});if(!n.ok){alert(`Kon niet opslaan in cloud: ${n.status} ${await n.text()}`);return}globalThis.autoSaver&&globalThis.autoSaver.saveManually("TXT0040000"+a);return}catch(n){alert(`Kon niet opslaan in cloud: ${String((n==null?void 0:n.message)||n)}`)}}globalThis.saveSchema=async()=>{await As(!1)};globalThis.saveSchemaAs=async()=>{await As(!0)};globalThis.getShareLink=()=>{function i(a){let n="";for(let o=0;o<a.length;o+=32768)n+=String.fromCharCode.apply(null,a.subarray(o,o+32768));return btoa(n)}function e(a){return a.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}const t=window.location.href.split("#")[0],s=globalThis.structure.toJsonObject(!0);try{const a=new TextEncoder,r=new Uint8Array(a.encode(s)),n=new Uint8Array(pako.deflate(r)),o=i(n),c="EDS0040000"+e(o);return t+"#share="+c}catch(a){console.log("Terugvallen naar TXT-share vanwege compressiefout: "+a);const r="TXT0040000"+encodeURIComponent(s);return t+"#share="+r}};globalThis.copyShareLink=async()=>{function i(c){let d="";for(let h=0;h<c.length;h+=32768)d+=String.fromCharCode.apply(null,c.subarray(h,h+32768));return btoa(d)}function e(){const c=globalThis.structure.toJsonObject(!0);try{if(globalThis.structure.properties.disableEDSCompression==!0)throw new Error("Compression is disabled");const l=new TextEncoder,d=new Uint8Array(l.encode(c)),h=new Uint8Array(pako.deflate(d));return"EDS0040000"+i(h)}catch(l){return console.log("Terugvallen naar TXT-share vanwege compressiefout: "+l),"TXT0040000"+c}}const t=window.location.href.split("#")[0],s=e(),a=D.isEnabled();let r=null,n=null;if(a){if(n=await D.getAccessToken(),!n){confirm("Aanmelden is vereist om een deel-link aan te maken. Nu aanmelden?")&&await D.login();return}}else{if(r=prompt("Server-wachtwoord voor delen:",""),r===null)return;if(r.trim().length===0){alert("Server-wachtwoord is verplicht om te kunnen delen.");return}}let o=null;try{const c=await fetch("/api/shares",{method:"POST",headers:V({"Content-Type":"application/json"},n?{Authorization:"Bearer "+n}:{}),credentials:"include",body:JSON.stringify({schema:s,password:r||void 0,baseUrl:t})});if(!c.ok){const d=await c.text();throw c.status===401&&a&&alert("Niet geautoriseerd. Probeer opnieuw aan te melden."),new Error("Share API error: "+c.status+" "+d)}const l=await c.json();o=l.url||t+"#share="+l.id,l!=null&&l.id&&(globalThis.currentShareId=String(l.id))}catch(c){console.warn("Kon de share-server niet bereiken; val terug op legacy deel-link.",c),o=globalThis.getShareLink(),globalThis.currentShareId=null}try{if(navigator.clipboard&&typeof navigator.clipboard.writeText=="function"){await navigator.clipboard.writeText(o),alert("Deel-link gekopieerd naar het klembord.");return}}catch(c){}prompt("Kopieer deze deel-link:",o)};function Ps(i,e=null,t=0){e!=null&&e.dispose();let s=JSON.parse(i);t!=0&&ja(s,t);let a=new fs;if(typeof s.properties!="undefined"&&(typeof s.properties.filename!="undefined"&&(a.properties.filename=s.properties.filename),typeof s.properties.owner!="undefined"&&(a.properties.owner=s.properties.owner),typeof s.properties.control!="undefined"&&(a.properties.control=s.properties.control),typeof s.properties.installer!="undefined"&&(a.properties.installer=s.properties.installer),typeof s.properties.info!="undefined"&&(a.properties.info=s.properties.info),typeof s.properties.info!="undefined"&&(a.properties.dpi=s.properties.dpi),typeof s.properties.currentView!="undefined"&&(a.properties.currentView=s.properties.currentView),typeof s.properties.disableEDSCompression!="undefined"&&(a.properties.disableEDSCompression=s.properties.disableEDSCompression),typeof s.properties.legacySchakelaars!="undefined"?a.properties.legacySchakelaars=s.properties.legacySchakelaars:a.properties.legacySchakelaars=null),typeof s.print_table!="undefined"){a.print_table.setHeight(s.print_table.height),a.print_table.setMaxWidth(s.print_table.maxwidth),a.print_table.setPaperSize(s.print_table.papersize),a.print_table.setModeVertical(s.print_table.modevertical),a.print_table.setstarty(s.print_table.starty),a.print_table.setstopy(s.print_table.stopy),typeof s.print_table.enableAutopage!="undefined"?a.print_table.enableAutopage=s.print_table.enableAutopage:a.print_table.enableAutopage=!1;for(let r=0;r<s.print_table.pages.length;r++)r!=0&&a.print_table.addPage(),a.print_table.pages[r].height=s.print_table.pages[r].height,a.print_table.pages[r].start=s.print_table.pages[r].start,a.print_table.pages[r].stop=s.print_table.pages[r].stop,s.print_table.pages[r].info!=null&&(a.print_table.pages[r].info=s.print_table.pages[r].info)}typeof s.sitplanjson!="undefined"&&(a.sitplan=new Mt,a.sitplan.fromJsonObject(s.sitplanjson));for(let r=0;r<s.length;r++)t!=0&&t<3?(a.addItem(s.data[r].keys[0][2]),a.data[r].convertLegacyKeys(s.data[r].keys),a.data[r].props.autoKringNaam="manueel",a.data[r].props.autonr="manueel"):(a.addItem(s.data[r].props.type),Object.assign(a.data[r].props,s.data[r].props),s.data[r].props.type==="Kring"&&!s.data[r].props.autoKringNaam&&(a.data[r].props.autoKringNaam="manueel"),s.data[r].props.nr!==void 0&&s.data[r].props.nr!==null&&!s.data[r].props.autonr&&(a.data[r].props.autonr="manueel"),s.data[r].props.type==="Batterij"&&s.data[r].props.symbool==null&&(a.data[r].props.symbool="blokbatterij")),a.data[r].parent=s.data[r].parent,a.active[r]=s.active[r],a.id[r]=s.id[r],a.data[r].id=s.data[r].id,a.data[r].indent=s.data[r].indent,a.data[r].collapsed=s.data[r].collapsed;return a.curid=s.curid,a.voegAttributenToeAlsNodigEnReSort(),a}function Ms(i,e,t=!0){globalThis.structure=Ps(i,globalThis.structure,e),t==!0&&globalThis.topMenu.selectMenuItemByName("Eéndraadschema")}function Cs(i){let e="",t;if(i.charCodeAt(0)==69&&i.charCodeAt(1)==68&&i.charCodeAt(2)==83){t=Number(i.substring(3,6)),isNaN(t)&&(t=1),i=atob(i.substring(10,i.length));var s=new Uint8Array(i.length);for(let r=0;r<i.length;r++)s[r-0]=i.charCodeAt(r);try{e=new TextDecoder("utf-8").decode(pako.inflate(s))}catch(r){var a=pako.inflate(s);e="";for(let n=0;n<a.length;n++)e+=String.fromCharCode(a[n])}}else i.charCodeAt(0)==84&&i.charCodeAt(1)==88&&i.charCodeAt(2)==84?(t=Number(i.substring(3,6)),isNaN(t)&&(t=3),e=i.substring(10,i.length)):(e=i,t=1);return{text:e,version:t}}function ne(i,e=!0,t=!1){globalThis.autoSaver&&globalThis.autoSaver.reset();let s=Cs(i);Ms(s.text,s.version,e),globalThis.undostruct.clear(),globalThis.undostruct.store();const a=document.getElementById("left_col");a!=null&&(a.scrollTop=0,a.scrollLeft=0);const r=document.getElementById("right_col");r!=null&&(r.scrollTop=0,r.scrollLeft=0),globalThis.autoSaver&&!t&&globalThis.autoSaver.saveManually(),t&&(globalThis.autoSaver.forceHasChangesSinceLastManualSave(),globalThis.structure.updateRibbon())}function Ua(i,e=!0){let t=Cs(i),s=Ps(t.text,null,t.version),a=0;for(let r=0;r<globalThis.structure.id.length;r++)globalThis.structure.id[r]>a&&(a=globalThis.structure.id[r]);for(let r=0;r<s.id.length;r++)s.id[r]+=a,s.data[r].id+=a,s.data[r].parent!=0&&(s.data[r].parent+=a);if(globalThis.structure.curid+=s.curid,globalThis.structure.length=globalThis.structure.length+s.length,globalThis.structure.active=globalThis.structure.active.concat(s.active),globalThis.structure.id=globalThis.structure.id.concat(s.id),globalThis.structure.data=globalThis.structure.data.concat(s.data),globalThis.structure.data.forEach(r=>{r.sourcelist=globalThis.structure}),globalThis.structure.print_table.enableAutopage=!0,globalThis.structure.sitplan!=null&&s.sitplan!=null){globalThis.structure.sitplanview!=null&&globalThis.structure.sitplanview.dispose(),globalThis.structure.sitplanjson=globalThis.structure.sitplan.toJsonObject(),s.sitplanjson=s.sitplan.toJsonObject();for(let r=0;r<s.sitplanjson.elements.length;r++)s.sitplanjson.elements[r].electroItemId!=null&&(s.sitplanjson.elements[r].electroItemId+=a),s.sitplanjson.elements[r].page+=globalThis.structure.sitplanjson.numPages;globalThis.structure.sitplanjson!=null&&s.sitplanjson!=null&&(globalThis.structure.sitplanjson.numPages+=s.sitplanjson.numPages,globalThis.structure.sitplanjson.elements=globalThis.structure.sitplanjson.elements.concat(s.sitplanjson.elements)),globalThis.structure.sitplan.fromJsonObject(globalThis.structure.sitplanjson),globalThis.structure.sitplanjson=null}globalThis.structure.reSort(),s=null,e&&globalThis.topMenu.selectMenuItemByName("Eéndraadschema"),globalThis.undostruct.store()}function Hs(i,e,t){var s=document.createElement("a");if(navigator.msSaveBlob)navigator.msSaveBlob(new Blob([i],{type:t}),e);else if(URL&&"download"in s){let a=URL.createObjectURL(new Blob([i],{type:t}));s.setAttribute("href",a),s.setAttribute("download",e),s.style.display="none",document.body.appendChild(s),s.click(),setTimeout(()=>document.body.removeChild(s),1e3)}else this.location.go(`${t},${encodeURIComponent(i)}`)}function Bs(){var i='<span id="exportscreen"></span>';i+=`
    <table border="1px" style="border-collapse:collapse" align="center" width="100%">
      <tr>
        <td width="100%" align="center" bgcolor="LightGrey">
          <b>Openen uit bestand</b>
        </td>
      </tr>
      <tr>
        <td width="100%" align="left">
            <table border=0>
              <tr>
                <td width=350 style="vertical-align:top;padding:5px">
                  <button style="font-size:14px" onclick="loadClicked()">Openen</button>
                </td>
                <td style="vertical-align:top;padding:7px">
                  Click op "openen" en selecteer een eerder opgeslagen EDS bestand.
                </td>
              </tr>
            </table>
        </td>
      </tr>
    </table><br>`,i+=`
    <table border="1px" style="border-collapse:collapse" align="center" width="100%">
      <tr>
        <td width="100%" align="center" bgcolor="LightGrey">
          <b>Opslaan</b>
        </td>
      </tr>
      <tr>
        <td width="100%" align="left">
    `;let e=!1;globalThis.structure&&globalThis.structure.properties&&typeof globalThis.structure.properties.disableEDSCompression!="undefined"&&(e=!!globalThis.structure.properties.disableEDSCompression),window.showOpenFilePicker?(i+='<table border=0><tr><td width=350 style="vertical-align:top;padding:5px">',globalThis.fileAPIobj.filename!=null?(i+='<button style="font-size:14px" onclick="saveSchema()">Opslaan</button>&nbsp;',i+='<button style="font-size:14px" onclick="saveSchemaAs()">Opslaan als</button>&nbsp;',i+='<button style="font-size:14px" onclick="exportjson(saveAs = true)">Export</button>',i+='</td><td style="vertical-align:top;padding:5px">',i+="Laatst geopend of opgeslagen om <b>"+globalThis.fileAPIobj.lastsaved+"</b> met naam <b>"+globalThis.fileAPIobj.filename+'</b><br><br>Klik links op "Opslaan" om bij te werken'):i+='<button style="font-size:14px" onclick="saveSchemaAs()">Opslaan als</button>&nbsp;<button style="font-size:14px" onclick="exportjson(saveAs = true)">Export</button></td><td style="vertical-align:top;padding:7px"><span class="highlight-warning">Uw werk werd nog niet opgeslagen tijdens deze sessie. Klik links op "Opslaan als".</span>',i+='<br><br><label><input type="checkbox" id="saveUncompressedCheckbox" style="vertical-align:middle;margin-right:5px;" '+(e?"checked":"")+">Opslaan zonder compressie (groter bestand)</label>",i+="</td></tr>",i+="</table>"):(i+='<table border=0><tr><td width=350 style="vertical-align:top;padding:7px">',i+='Bestandsnaam: <span id="settings"><code>'+globalThis.structure.properties.filename+'</code><br><button style="font-size:14px" onclick="saveSchema()">Opslaan</button>&nbsp;<button style="font-size:14px" onclick="exportjson()">Export</button>&nbsp;<button style="font-size:14px" onclick="HL_enterSettings()">Naam wijzigen</button></span>',i+='</td><td style="vertical-align:top;padding:5px">',i+='U kan het schema opslaan op uw lokale harde schijf voor later gebruik. De standaard-naam is eendraadschema.eds. U kan deze wijzigen door links op "wijzigen" te klikken. ',i+='Klik vervolgens op "opslaan" en volg de instructies van uw browser. ',i+="In de meeste gevallen zal uw browser het bestand automatisch plaatsen in de Downloads-folder tenzij u uw browser instelde dat die eerst een locatie moet vragen.<br><br>",i+='Eens opgeslagen kan het schema later opnieuw geladen worden door in het menu "openen" te kiezen en vervolgens het bestand op uw harde schijf te selecteren.',i+='<br><br><label><input type="checkbox" id="saveUncompressedCheckbox" style="vertical-align:middle;margin-right:5px;" '+(e?"checked":"")+">Opslaan zonder compressie (groter bestand)</label>",i+="</td></tr>",i+="</table>"),i+=`
        </td>
      </tr>
    </table><br>    
    `,i+=`
        <table border="1px" style="border-collapse:collapse" align="center" width="100%">
            <tr>
                <td width="100%" align="center" bgcolor="LightGrey">
                    <b>Delen</b>
                </td>
            </tr>
            <tr>
                <td width="100%" align="left">
                        <table border=0>
                            <tr>
                                <td width=350 style="vertical-align:top;padding:5px">
                                    <button type="button" style="font-size:14px" onclick="copyShareLink()">Kopieer deel-link</button>
                                </td>
                                <td style="vertical-align:top;padding:7px">
                                    Maakt een link om dit schema te delen. Het schema wordt opgeslagen op de server zodat de link kort blijft.
                                </td>
                            </tr>
                            <tr>
                                <td width=350 style="vertical-align:top;padding:5px">
                                    <button type="button" style="font-size:14px" onclick="authLogin()">Aanmelden</button>&nbsp;
                                    <button type="button" style="font-size:14px" onclick="authLogout()">Afmelden</button>&nbsp;
                                    <button type="button" style="font-size:14px" onclick="authWhoAmI()">Wie ben ik?</button>
                                </td>
                                <td style="vertical-align:top;padding:7px">
                                    Alleen delen/beheer vereist aanmelden. Alle andere functies blijven beschikbaar zonder login.
                                </td>
                            </tr>
                            <tr>
                                <td width=350 style="vertical-align:top;padding:5px">
                                    <button type="button" style="font-size:14px" onclick="openShareManager()">Mijn shares</button>&nbsp;
                                    <button type="button" style="font-size:14px" onclick="openTeamManager()">Teams</button>
                                    &nbsp;<button type="button" style="font-size:14px" onclick="openShareTeamsScreen()">Beheer</button>
                                </td>
                                <td style="vertical-align:top;padding:7px">
                                    Bekijk je shares, maak teams en nodig mensen uit.
                                </td>
                            </tr>
                        </table>
                </td>
            </tr>
        </table><br>`,i+=`
    <table border="1px" style="border-collapse:collapse" align="center" width="100%">
      <tr>
        <td width="100%" align="center" bgcolor="LightGrey">
          <b>Samenvoegen</b>
        </td>
      </tr>
      <tr>
        <td width="100%" align="left">
            <table border=0>
              <tr>
                <td width=350 style="vertical-align:top;padding:5px">
                  <button style="font-size:14px" onclick="importToAppendClicked()">Samenvoegen (Expert!)</button>
                </td>
                <td style="vertical-align:top;padding:7px">
                  Open een tweede EDS bestand en voeg de inhoud toe aan het huidige EDS bestand.<br>
                  Voegt de ééndraadschema's samen en voegt eveneens pagina's toe aan het situatieschema als dat nodig is.<br><br>
                  <span style="color:red;font-weight:bold">Opgelet!</span> Het is aanbevolen uw werk op te slaan alvorens deze functie te gebruiken!
                </td>
              </tr>
            </table>
        </td>
      </tr>
    </table>`,document.getElementById("configsection").innerHTML=i;let t=document.getElementById("saveUncompressedCheckbox");t.onchange=function(){globalThis.structure.properties||(globalThis.structure.properties={}),globalThis.structure.properties.disableEDSCompression=t.checked},globalThis.toggleAppView("config")}class es{constructor(e,t){this.dbName=e,this.storeName=t}async openDB(){return new Promise((e,t)=>{const s=indexedDB.open(this.dbName,1);s.onupgradeneeded=a=>{const r=a.target.result;r.objectStoreNames.contains(this.storeName)||r.createObjectStore(this.storeName,{keyPath:"key"})},s.onsuccess=()=>e(s.result),s.onerror=()=>e(null)})}async set(e,t){performance.now();try{const s=await this.openDB();return s?new Promise(a=>{const o=s.transaction(this.storeName,"readwrite").objectStore(this.storeName).put({key:e,value:t});o.onsuccess=()=>a(!0),o.onerror=()=>a(!1)}):!1}catch(s){return console.error(`Error in IndexedDBStorage.set: ${s}`),!1}}async get(e){try{const t=await this.openDB();return t?new Promise(s=>{const n=t.transaction(this.storeName,"readonly").objectStore(this.storeName).get(e);n.onsuccess=()=>{n.result?s(n.result.value):s(null)},n.onerror=()=>s(null)}):null}catch(t){return console.error("Error accessing IndexedDB:",t),null}}}const oe=class oe{constructor(e,t){this.timerId=null,this.lastSavedString=null,this.lastSavedType=oe.SavedType.NONE,this.suspendSaving=!0,this.callbackAfterSave=()=>{},this.interval=e*1e3,this.getStructure=t}hasChangesSinceLastManualSave(){return this.lastSavedType===oe.SavedType.AUTOMATIC}forceHasChangesSinceLastManualSave(){this.lastSavedType=oe.SavedType.AUTOMATIC}start(){this.stop(),this.lastSavedString=null,this.timerId=window.setInterval(()=>{this.saveAutomatically()},this.interval),this.suspendSaving=!0}stop(){this.timerId!==null&&window.clearInterval(this.timerId)}reset(e=this.interval/1e3){this.stop(),this.interval=e*1e3,this.lastSavedType=oe.SavedType.NONE,this.start()}haltSuspendingIfUserStartedDrawing(){this.getStructure().properties.currentView!="config"&&(this.suspendSaving=!1)}saveAutomatically(){if(this.haltSuspendingIfUserStartedDrawing(),this.suspendSaving)return;const e="TXT0040000"+this.getStructure().toJsonObject(!0);e!=this.lastSavedString&&(async()=>{try{await this.saveToIndexedDB("TXT0040000"+this.getStructure().toJsonObject(!0),!0),this.lastSavedString=e,this.lastSavedType=oe.SavedType.AUTOMATIC}catch(t){console.error("Error saving to IndexedDB:",t)}finally{this.callbackAfterSave&&this.callbackAfterSave()}})()}saveManually(e=null){this.suspendSaving=!1,(async()=>{try{e==null&&(e="TXT0040000"+this.getStructure().toJsonObject(!0)),await this.saveToIndexedDB(e,!1),this.lastSavedString=e,this.lastSavedType=oe.SavedType.MANUAL}catch(t){console.error("Error saving to IndexedDB:",t)}finally{this.callbackAfterSave&&this.callbackAfterSave()}})(),this.reset()}setCallbackAfterSave(e){this.callbackAfterSave=e}getSavedType(){return this.lastSavedType}async saveToIndexedDB(e,t=!1){const s=new es("DB_EDS","Store_EDS");if(!s){console.error("Error saving to IndexedDB, kan de database niet openen.");return}let a=new Date;const r={filename:this.getStructure().properties.filename,currentTimeStamp:a.getDate().toString().padStart(2,"0")+"/"+(a.getMonth()+1).toString().padStart(2,"0")+"/"+a.getFullYear().toString()+" "+a.getHours().toString().padStart(2,"0")+":"+a.getMinutes().toString().padStart(2,"0")+":"+a.getSeconds().toString().padStart(2,"0"),recovery:t,shareId:globalThis.currentShareId||null};await Promise.all([s.set("autoSave",e),s.set("autoSaveInfo",JSON.stringify(r))])}async loadLastSaved(){const e=new es("DB_EDS","Store_EDS");if(!e)return[null,null];try{let t;[this.lastSavedString,t]=await Promise.all([e.get("autoSave"),e.get("autoSaveInfo")]);const s=t?JSON.parse(t):null;return this.lastSavedType=s?s.recovery?oe.SavedType.AUTOMATIC:oe.SavedType.MANUAL:oe.SavedType.NONE,[this.lastSavedString,s]}catch(t){return this.lastSavedString=null,console.error("Error loading from IndexedDB:",t),this.lastSavedType=oe.SavedType.NONE,[null,null]}}};oe.SavedType={AUTOMATIC:"AUTOMATIC",MANUAL:"MANUAL",NONE:"NONE"};let Tt=oe;class zs{constructor(){this.excludedTypes=["Bord","Kring","Domotica","Domotica module (verticaal)","Domotica gestuurde verbruiker","Leiding","Splitsing","Verlenging","Vrije ruimte","Meerdere verbruikers"],this.data=[],this.borden=[],this.kringTekstByNaam={},this.reCalculate()}getData(){return this.data}getBorden(){return this.borden}getUniqueKringnaam(){return Array.from(new Set(this.data.map(e=>e.kringnaam)))}getKringLabel(e){var s;const t=I((s=this.kringTekstByNaam[e])!=null?s:"");return t===""||t==="---"?e:`${e} ${t}`}getUniqueKringnaamWithLabels(){return this.getUniqueKringnaam().map(e=>({value:e,label:this.getKringLabel(e)}))}getElectroItemsByKring(e){return this.data.filter(t=>t.kringnaam===e).map(t=>({id:t.id,adres:t.adres,type:t.type}))}reCalculate(){var t,s,a,r;this.data=[];let e=[];this.borden=[],this.kringTekstByNaam={};for(let n=0;n<globalThis.structure.length;n++)if(globalThis.structure.active[n]){let o=globalThis.structure.id[n],c=globalThis.structure.data[n];if(c==null)continue;let l=c.getType();if(l!="Container"){if(l=="Kring"){const d=I((s=(t=c.props)==null?void 0:t.naam)!=null?s:""),h=I((r=(a=c.props)==null?void 0:a.tekst)!=null?r:"");d!==""&&(this.kringTekstByNaam[d]=h)}else if(!(c.getParent()instanceof Qe))if(l=="Bord"){let d=c.props.naam;(d==null||I(d)=="")&&(d="Bord"),this.borden.push({id:o,naam:d})}else{let d=I(globalThis.structure.findKringName(o));if(c.isAttribuut()&&(l="Externe sturing"),l!=null&&this.excludedTypes.indexOf(l)===-1){let h=c.getReadableAdres();I(d)!==""?this.data.push({id:o,kringnaam:d,adres:h,type:l}):e.push({id:o,kringnaam:"Zonder naam",adres:h,type:l})}}}}this.data=this.data.concat(e)}}class Ga{constructor(e){this.zoeker=null,this.selectedKring=null,this.container=e}renderSymbols(){}render(){if(!this.container)return;if(!globalThis.structure){this.container.innerHTML="";return}this.zoeker==null?this.zoeker=new zs:this.zoeker.reCalculate();const e=globalThis.structure.sitplan,t=()=>{if(e!=null&&e.getElements&&typeof e.getElements=="function"){const f=e.getElements();return Array.isArray(f)?f:[]}return Array.isArray(e==null?void 0:e.elements)?e.elements:[]},s=t(),a=s.filter(f=>{var m;return((m=f==null?void 0:f.getElectroItemId)==null?void 0:m.call(f))==null}),r=a.length,n=a.filter(f=>(f==null?void 0:f.visible)!==!1).length,o=r===0||n===0?"hidden":n===r?"visible":"mixed",c=o==="visible"?"👁":o==="mixed"?"◐":"🚫",l=f=>{if((f==null?void 0:f.kind)==="distanceLine"){const m=typeof f.getAdres=="function"?f.getAdres():"";return m?`Afstandslijn (${m})`:"Afstandslijn"}return typeof(f==null?void 0:f.svg)=="string"&&f.svg.includes("<image ")?"Achtergrond/tekening":"Niet-elektrisch element"},d=this.zoeker.getUniqueKringnaamWithLabels(),h=d.map(f=>f.value);(this.selectedKring==null||!h.includes(this.selectedKring))&&(this.selectedKring=h.length>0?h[0]:null);const p=d.map(f=>{const m=f.value.replace(/"/g,"&quot;"),x=f.value===this.selectedKring?"open":"",w=this.zoeker.getElectroItemsByKring(f.value).map(L=>L.id),P=s.filter(L=>{var j;return((j=L==null?void 0:L.getElectroItemId)==null?void 0:j.call(L))!=null&&w.includes(L.getElectroItemId())}),A=P.length,S=P.filter(L=>(L==null?void 0:L.visible)!==!1).length,N=A===0||S===0?"hidden":S===A?"visible":"mixed";return`
                <details class="sitplan-sidebar-kring" data-kring="${m}" ${x}>
                    <summary class="sitplan-sidebar-kring-summary">
                        <button type="button" class="sitplan-sidebar-visbtn" data-kring-toggle="${m}" data-state="${N}" title="Zichtbaarheid kring" ${A===0?"disabled":""}>${N==="visible"?"👁":N==="mixed"?"◐":"🚫"}</button>
                        <span>${f.label}</span>
                    </summary>
                    <div class="sitplan-sidebar-items" data-kring-items="${m}"></div>
                </details>`}).join(""),u=`
            <details class="sitplan-sidebar-kring" data-group="nonElectrical" ${r>0?"open":""}>
                <summary class="sitplan-sidebar-kring-summary">
                    <button type="button" class="sitplan-sidebar-visbtn" data-non-electrical-toggle="true" data-state="${o}" title="Zichtbaarheid niet-elektrische elementen" ${r===0?"disabled":""}>${c}</button>
                    <span>Niet-elektrisch</span>
                </summary>
                <div class="sitplan-sidebar-items" id="sitplan_sidebar_nonelectrical_items">
                    ${a.map(f=>{const m=l(f),x=(f==null?void 0:f.visible)!==!1?"visible":"hidden",w=x==="visible"?"👁":"🚫";return`<div class="sitplan-sidebar-itemrow">
                            <button type="button" class="sitplan-sidebar-visbtn" data-non-electrical-id="${f.id}" data-state="${x}" title="Zichtbaarheid" >${w}</button>
                            <div class="sitplan-sidebar-item" style="cursor: default;">
                                <span>${m}</span>
                                <span class="sitplan-sidebar-count"></span>
                            </div>
                        </div>`}).join("")}
                </div>
            </details>`;this.container.innerHTML=`
            <div class="sitplan-sidebar-titlebar">
                <div class="sitplan-sidebar-title">Snelle toevoeging</div>
                <div class="sitplan-sidebar-actions">
                    <button type="button" class="sitplan-sidebar-actionbtn" data-action="hideAll" title="Verberg alles">🙈</button>
                    <button type="button" class="sitplan-sidebar-actionbtn" data-action="showAll" title="Toon alles">👁</button>
                </div>
            </div>
            <div class="sitplan-sidebar-tree" id="sitplan_sidebar_tree">${p}${u}</div>
        `;const g=this.container.querySelector("#sitplan_sidebar_tree");if(!g)return;const b=(f,m)=>{if(!this.zoeker)return;const x=this.zoeker.getElectroItemsByKring(f),w=t();m.innerHTML=x.map(S=>{var G,R;const N=S.adres&&S.adres.trim()!==""?`${S.adres} | ${S.type}`:S.type,W=w.filter($=>{var xe;return((xe=$==null?void 0:$.getElectroItemId)==null?void 0:xe.call($))===S.id}),M=W.length,L=W.filter($=>($==null?void 0:$.visible)!==!1).length,j=M===0||L===0?"hidden":L===M?"visible":"mixed",C=j==="visible"?"👁":j==="mixed"?"◐":"🚫",q=M===0?"disabled":"",K=(R=(G=globalThis.structure).getElectroItemById)==null?void 0:R.call(G,S.id),O=K&&typeof K.maxSituationPlanElements=="function"?Number(K.maxSituationPlanElements()):0,Z=Number.isFinite(O)&&O>0,te=Z&&M>=O,Y=Z?`${M}/${O}`:`${M}`;return`<div class="sitplan-sidebar-itemrow">
                    <button type="button" class="sitplan-sidebar-visbtn" data-electro-visible="${S.id}" data-state="${j}" title="Zichtbaarheid symbool" ${q}>${C}</button>
                    <button type="button" class="sitplan-sidebar-item" data-electro-id="${S.id}" ${te?"disabled":""}>
                        <span>${N}</span>
                        <span class="sitplan-sidebar-count">${Y}</span>
                    </button>
                </div>`}).join(""),m.querySelectorAll("button[data-electro-id]").forEach(S=>{S.addEventListener("click",()=>{var O,Z,te,Y,G,R,$,xe;if(S.disabled)return;const N=S.getAttribute("data-electro-id"),W=N?Number(N):NaN;if(!Number.isFinite(W))return;const M=globalThis.structure.sitplanview;if(!M)return;const L=M.getVisibleCenterPaperPos?M.getVisibleCenterPaperPos():M.canvasPosToPaperPos(((O=M.canvas)==null?void 0:O.clientWidth)/2,((Z=M.canvas)==null?void 0:Z.clientHeight)/2),j=globalThis.structure.sitplan,C=(Y=(te=j==null?void 0:j.defaults)==null?void 0:te.fontsize)!=null?Y:11,q=(R=(G=j==null?void 0:j.defaults)==null?void 0:G.scale)!=null?R:globalThis.SITPLANVIEW_DEFAULT_SCALE,K=(xe=($=j==null?void 0:j.defaults)==null?void 0:$.rotate)!=null?xe:0;M.addElectroItem(W,"auto","","rechts",C,q,K,L==null?void 0:L.x,L==null?void 0:L.y)})}),m.querySelectorAll("button[data-electro-visible]").forEach(S=>{S.addEventListener("click",N=>{if(N.stopPropagation(),S.disabled)return;const W=Number(S.getAttribute("data-electro-visible"));if(!Number.isFinite(W))return;const M=globalThis.structure.sitplanview;if(!M)return;const L=t().filter(K=>{var O;return((O=K==null?void 0:K.getElectroItemId)==null?void 0:O.call(K))===W}),j=L.length,C=L.filter(K=>(K==null?void 0:K.visible)!==!1).length,q=!(j>0&&C===j);for(let K of L)K.visible=q;M.redraw(),globalThis.undostruct.store()})})};Array.from(g.querySelectorAll("details[data-kring]")).forEach(f=>{var P,A;const m=(A=(P=f.getAttribute("data-kring"))==null?void 0:P.replace(/&quot;/g,'"'))!=null?A:"",x=f.querySelector("div[data-kring-items]");if(!x)return;const w=()=>{f.open?(this.selectedKring=m,b(m,x)):x.innerHTML=""};f.addEventListener("toggle",w),f.open&&w()}),g.querySelectorAll("button[data-kring-toggle]").forEach(f=>{f.addEventListener("click",m=>{var L,j;if(m.stopPropagation(),f.disabled)return;const x=(j=(L=f.getAttribute("data-kring-toggle"))==null?void 0:L.replace(/&quot;/g,'"'))!=null?j:"";if(!x)return;const w=globalThis.structure.sitplanview;if(!w)return;const P=this.zoeker.getElectroItemsByKring(x),A=new Set(P.map(C=>C.id)),S=t().filter(C=>{var K;const q=(K=C==null?void 0:C.getElectroItemId)==null?void 0:K.call(C);return q!=null&&A.has(q)}),N=S.length,W=S.filter(C=>(C==null?void 0:C.visible)!==!1).length,M=!(N>0&&W===N);for(let C of S)C.visible=M;w.redraw(),globalThis.undostruct.store()})}),this.container.querySelectorAll("button[data-action]").forEach(f=>{f.addEventListener("click",()=>{const m=f.getAttribute("data-action"),x=globalThis.structure.sitplanview;x&&(m==="hideAll"&&x.hideAllElements(),m==="showAll"&&x.showAllElements())})});const U=this.container.querySelector("button[data-non-electrical-toggle]");U&&U.addEventListener("click",f=>{if(f.stopPropagation(),U.disabled)return;const m=globalThis.structure.sitplanview;if(!m)return;const x=t().filter(S=>{var N;return((N=S==null?void 0:S.getElectroItemId)==null?void 0:N.call(S))==null}),w=x.length,P=x.filter(S=>(S==null?void 0:S.visible)!==!1).length,A=!(w>0&&P===w);for(let S of x)S.visible=A;m.redraw(),globalThis.undostruct.store()}),this.container.querySelectorAll("button[data-non-electrical-id]").forEach(f=>{f.addEventListener("click",m=>{m.stopPropagation();const x=f.getAttribute("data-non-electrical-id");if(!x)return;const w=globalThis.structure.sitplanview;if(!w)return;const P=t().find(A=>(A==null?void 0:A.id)===x);P&&(P.visible=P.visible===!1,w.redraw(),globalThis.undostruct.store())})})}}globalThis.HLInsertAndEditSymbol=(i,e)=>{};globalThis.HLExpandSitPlan=i=>{};class Fa{constructor(){this.data=[]}clear(){this.data=[]}selectOne(e){this.clear(),this.data.push(e)}select(e){if(this.data.includes(e)){this.data.indexOf(e)!=this.data.length-1&&(this.data.splice(this.data.indexOf(e),1),this.data.push(e));return}else this.data.push(e)}toggleButNeverRemoveLast(e){this.data.includes(e)?this.data.length!=1&&this.data.splice(this.data.indexOf(e),1):this.data.push(e)}getLastSelected(){return this.data.length==0?null:this.data[this.data.length-1]}getAllSelected(){return this.data}length(){return this.data.length}includes(e){return this.data.includes(e)}}class zt{constructor(){this.listeners=[]}addEventListener(e,t,s){const a=this.listeners.findIndex(r=>r.element===e&&r.type===t);if(a!==-1){const r=this.listeners[a];e.removeEventListener(t,r.listener),this.listeners.splice(a,1)}this.listeners.push({element:e,type:t,listener:s}),e.addEventListener(t,s),this.cleanup()}removeAllEventListeners(){this.listeners.forEach(({element:e,type:t,listener:s})=>{e.removeEventListener(t,s)}),this.listeners=[]}dispose(){this.removeAllEventListeners()}cleanup(){this.listeners=this.listeners.filter(({element:e,type:t,listener:s})=>document.contains(e)?!0:(e.removeEventListener(t,s),!1))}}class ts{static showItemTypeSelectionPopup(e){function t(){n.style.visibility="visible",document.body.style.pointerEvents="none",n.style.pointerEvents="auto"}function s(){g.dispose(),n.style.visibility="hidden",document.body.style.pointerEvents="auto",r.remove()}const a=_=>{_.key==="Enter"&&(_.preventDefault(),_.stopPropagation(),p.click())},r=document.createElement("div");r.innerHTML=`
            <div id="popupOverlay" class="popup-overlay">
                <div id="popupWindow" class="popup">
                    <h3>Los symbool (niet in ééndraadschema)</h3>
                    <div style="position: absolute; top: 5px; right: 5px; display: flex; align-items: center; justify-content: center;">
                        <button id="closeButton" style="background-color: #e00; border-radius: 4px; width: 20px; height: 20px; font-size: 16px; color: white; border: none; outline: none; cursor: pointer; display: flex; align-items: center; justify-content: center; padding: 0px; vertical-align: middle;">&#10006;</button>
                    </div>
                    <div style="display: flex; margin-bottom: 20px; align-items: center;">
                        <label for="itemTypeSelect" style="margin-right: 10px; display: inline-block;">Type:</label>
                        <select id="itemTypeSelect" style="width: 200px;">
                            <option value="Aardingsonderbreker">Aardingsonderbreker</option>
                            <option value="Elektriciteitsmeter">Elektriciteitsmeter</option>
                        </select>
                    </div>
                    <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                        <i>Dit is een nieuwe functionaliteit om elementen in het situatieschema te
                           tekenen die niet voorkomen in het ééndraadschema.
                           Op dit moment ondersteunt deze functionaliteit slechts een beperkt
                           aantal symbolen. Dit zal verder uitgebreid worden naar de toekomst toe.</i>
                    </div>
                    <div style="display: flex; margin-bottom: 10px; align-items: center;">
                        <label for="scaleInput" style="margin-right: 10px; display: inline-block;">Schaal (%):</label>
                        <input id="scaleInput" style="width: 100px;" type="number" min="10" max="400" step="10" value="${String(globalThis.SITPLANVIEW_DEFAULT_SCALE*100)}">
                    </div>
                    <div style="display: flex; margin-bottom: 20px; align-items: center;">
                        <label for="rotationInput" style="margin-right: 10px; display: inline-block;">Rotatie (°):</label>
                        <input id="rotationInput" style="width: 100px;" type="number" min="0" max="360" step="10" value="0">
                    </div>
                    <div id="setDefaultContainer" style="display: flex; margin-bottom: 20px; align-items: flex-start;">
                        <input type="checkbox" id="setDefaultCheckbox">
                        <label for="setDefaultCheckbox" style="margin-left: 10px; flex-grow: 1; flex-wrap: wrap;">Zet schaal als standaard voor alle toekomstige nieuwe symbolen.</label>
                    </div>
                    <div style="display: flex; justify-content: center; gap: 0px;">
                        <button id="okButton" class="rounded-button">OK</button>
                        <button id="cancelButton" class="rounded-button">Cancel</button>
                    </div>
                </div>
            </div>`;const n=r.querySelector("#popupOverlay"),o=r.querySelector("#closeButton"),c=r.querySelector("#itemTypeSelect"),l=r.querySelector("#scaleInput"),d=r.querySelector("#rotationInput"),h=r.querySelector("#setDefaultCheckbox"),p=r.querySelector("#okButton"),u=r.querySelector("#cancelButton");l.value=Ae(globalThis.structure.sitplan.defaults.scale*100,6),d.value=Ae(0);let g=new zt;g.addEventListener(document,"keydown",_=>{_.key==="Enter"?a(_):_.key==="Escape"&&(_.preventDefault(),_.stopPropagation(),u.click())}),p.addEventListener("click",()=>{function _(T){return/^-?\d+(\.\d+)?$/.test(T)}(!_(l.value)||Number(l.value)<=0)&&(l.value=String(globalThis.structure.sitplan.defaults.scale*100)),_(d.value)||(d.value=String(0)),h.checked&&(globalThis.structure.sitplan.defaults.scale=Number(l.value)/100);const v=c.value;s(),e(v,Number(l.value)/100,Number(d.value))});const b=()=>{s()};u.addEventListener("click",b),o.addEventListener("click",b),document.body.appendChild(r),t()}}class Ks{constructor(e=document.body){this.menuItems=[],this.menuElement=null,this.menuElement=document.createElement("div"),this.menuElement.className="context-menu",e.appendChild(this.menuElement)}clearMenu(){this.menuItems=[],this.menuElement&&(this.menuElement.innerHTML="")}addMenuItem(e,t,s,a){var r,n;this.menuItems.push({label:e,shortcut:s,callback:t,disabled:(r=a==null?void 0:a.disabled)!=null?r:!1,hint:(n=a==null?void 0:a.hint)!=null?n:!1})}addLine(){this.menuItems.push({label:"separator",callback:()=>{}})}renderMenu(){this.menuElement&&(this.menuElement.innerHTML="",this.menuItems.forEach((e,t)=>{if(e.label==="separator"){const s=document.createElement("hr");s.className="context-menu-separator",this.menuElement.appendChild(s)}else{const s=document.createElement("div");s.className="context-menu-item",(e.disabled||e.callback==null)&&s.classList.add("context-menu-item-disabled"),e.hint&&s.classList.add("context-menu-item-hint");const a=document.createElement("span");a.textContent=e.label;const r=document.createElement("span");r.textContent=e.shortcut||"",r.className="context-menu-shortcut",s.appendChild(a),s.appendChild(r),e.disabled||e.callback==null||s.addEventListener("click",()=>{var n;(n=e.callback)==null||n.call(e),this.hide()}),this.menuElement.appendChild(s)}}))}show(e){if(this.menuElement){this.renderMenu(),this.menuElement.style.display="block";const{clientX:t,clientY:s}=e,{innerWidth:a,innerHeight:r}=window,{offsetWidth:n,offsetHeight:o}=this.menuElement;let c=t,l=s;c+n>a&&(c=a-n),l+o>r&&(l=r-o),this.menuElement.style.left=`${c}px`,this.menuElement.style.top=`${l}px`}}hide(){this.menuElement&&(this.menuElement.style.display="none")}}class Wa{constructor(){this.startOffsetLeft=0,this.startOffsetTop=0,this.startPaperPos={x:0,y:0},this.hassMoved=!1}startDrag(e=0,t=0,s=0,a=0){this.startOffsetLeft=s,this.startOffsetTop=a,this.hassMoved=!1;const r=parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--menu-height")),n=parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--ribbon-height")),o=parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--sideBarWidth"));this.startPaperPos=globalThis.structure.sitplanview.canvasPosToPaperPos(e-o,t-r-n)}returnNewPaperPos(e=0,t=0){const s=parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--menu-height")),a=parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--ribbon-height")),r=parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--sideBarWidth"));let n=globalThis.structure.sitplanview.canvasPosToPaperPos(e-r,t-s-a);return(n.x!=this.startPaperPos.x||n.y!=this.startPaperPos.y)&&(this.hassMoved=!0),{x:n.x-this.startPaperPos.x+this.startOffsetLeft,y:n.y-this.startPaperPos.y+this.startOffsetTop}}}class Pe{constructor(e,t="helpertip"){this.storage=e,this.storagePrefix=t}show(e,t,s=!1,a=()=>{}){const r=`${this.storagePrefix}.${e}.neverDisplay`,n=`${this.storagePrefix}.${e}.displayedInThisSession`;if(this.storage.get(r)===!0||this.storage.get(n)===!0){a&&a();return}const o=document.createElement("div");o.id="popupOverlay",o.classList.add("popup-overlay");const c=document.createElement("div");c.id="popup",c.classList.add("popup"),c.innerHTML=t;const l=document.createElement("label");l.style.display="block",l.style.marginTop="10px";const d=document.createElement("input");d.type="checkbox",d.checked=s,l.appendChild(d);const h=document.createTextNode(" Deze tekst nooit meer weergeven in deze browser."),p=document.createElement("i");p.appendChild(h),l.appendChild(p),c.appendChild(l);const u=document.createElement("div");u.style.display="flex",u.style.justifyContent="center",u.style.gap="0px";const g=document.createElement("button");g.textContent="OK",g.classList.add("rounded-button"),g.addEventListener("click",b=>{b.stopPropagation(),this.storage.set(n,!0,!0),d.checked&&this.storage.set(r,!0),document.body.removeChild(o),document.body.style.pointerEvents="auto",a&&a()}),u.appendChild(g),c.appendChild(u),o.appendChild(c),document.body.appendChild(o),o.style.visibility="visible",document.body.style.pointerEvents="none",o.style.pointerEvents="auto"}}class dt{constructor(e,t,s=null){this.title=e,this.body=t,s?this.buttons=s:this.buttons=[{text:"OK",callback:()=>{}}]}show(){const e=document.createElement("div");e.id="popupOverlay",e.classList.add("popup-overlay");const t=document.createElement("div");t.id="popup",t.classList.add("popup"),t.innerHTML=`<h3>${this.title}</h3><p>${this.body}</p>`;const s=document.createElement("div");s.style.display="flex",s.style.justifyContent="center",s.style.gap="0px";for(const a of this.buttons){const r=document.createElement("button");r.textContent=a.text,r.classList.add("rounded-button"),r.addEventListener("click",(()=>{document.body.removeChild(e),document.body.style.pointerEvents="auto",a.callback()}).bind(this)),s.appendChild(r)}t.appendChild(s),e.appendChild(t),document.body.appendChild(e),e.style.visibility="visible",document.body.style.pointerEvents="none",e.style.pointerEvents="auto"}}function ht(i,e,t=()=>{},s={}){let a=new zs,r=a.getUniqueKringnaam();function n(){A.innerHTML="";for(let z of r){const J=document.createElement("option");J.value=z,J.text=z,A.appendChild(J)}}function o(z=null){n(),z==null&&i!=null&&i.getElectroItemId()!=null&&(z=i.getElectroItemId()),z!=null&&(A.value=globalThis.structure.findKringName(z)),A.onchange=c}function c(){l(),h()}function l(){let z=a.getElectroItemsByKring(A.value);N.innerHTML="";for(let J=0;J<z.length;++J){const re=z[J],je=document.createElement("option");je.value=String(J),je.text=(I(re.adres)!==""?y(re.adres)+" | ":"")+re.type,N.appendChild(je)}}function d(z=null){l();let J=a.getElectroItemsByKring(A.value);if(z==null&&i!=null&&i.getElectroItemId()!=null&&(z=i.getElectroItemId()),z!=0)for(let re=0;re<J.length;++re)J[re].id==z&&(N.value=String(re));N.onchange=h}function h(){p(),q.value="auto",v()}function p(){let z="",J=a.getElectroItemsByKring(A.value),re=Number(N.value);isNaN(re)||J[re]!=null&&(z=J[re].id.toString()),L.value=z}function u(){i!=null?i.getElectroItemId()!=null&&(L.value=String(i.getElectroItemId())):p(),L.oninput=g}function g(){if(L.value!=null){L.value=L.value.replace(/[^0-9]/g,"");let z=Number(L.value);_(),globalThis.structure.getElectroItemById(z)!=null&&(o(z),d(z),q.value="auto",v())}}function b(z=null){if(z==null)return;let J=globalThis.structure.getElectroItemById(z);J!=null&&(J.expand(),a.reCalculate(),r=a.getUniqueKringnaam(),g(),globalThis.structure.sitplanview.redraw())}function _(){if(L.value==null||I(L.value)=="")j.innerHTML='<span style="color: red;">Geen ID ingegeven</span>',W.style.display="none";else{let z=Number(L.value),J=globalThis.structure.getElectroItemById(z);J!=null?(j.innerHTML='<span style="color:green;">'+J.getType()+"</span>",J.isExpandable()?(W.style.display="block",j.innerHTML+='<br><span style="color: black;">Klik op uitpakken indien u de onderliggende elementen in het situatieschema wil kunnen plaatsen.</span>',W.onclick=()=>{b(z)}):W.style.display="none"):(j.innerHTML='<span style="color: red;">Element niet gevonden</span>',W.style.display="none")}}function v(){let z=Number(L.value);_();let J=globalThis.structure.getElectroItemById(z);if(J==null){O.value="",O.readOnly=!0;return}switch(q.value){case"manueel":O.value=J!=null?O.value:"",O.readOnly=!1;break;case"auto":default:O.value=J!=null?J.getReadableAdres():"",O.readOnly=!0;break}}function T(){m.style.visibility="visible",document.body.style.pointerEvents="none",m.style.pointerEvents="auto"}function U(){Dt.dispose(),m.style.visibility="hidden",document.body.style.pointerEvents="auto",f.remove()}const E=z=>{z.key==="Enter"&&(z.preventDefault(),z.stopPropagation(),xe.click())};s.toonTekenGrootteStandaardVoorNieuweObjecten==null&&(i==null?s.toonTekenGrootteStandaardVoorNieuweObjecten=!0:s.toonTekenGrootteStandaardVoorNieuweObjecten=i.getElectroItemId()!=null);const f=document.createElement("div");f.innerHTML=`
        <div id="popupOverlay" class="popup-overlay">
            <div id="popupWindow" class="popup">
                <h3>Element toevoegen/bewerken</h3>
                <div style="position: absolute; top: 5px; right: 5px; display: flex; align-items: center; justify-content: center;">
                    <button id="closeButton" style="background-color: #e00; border-radius: 4px; width: 20px; height: 20px; font-size: 16px; color: white; border: none; outline: none; cursor: pointer; display: flex; align-items: center; justify-content: center; padding: 0px; vertical-align: middle;">&#10006;</button>
                </div>
                <div id="selectKringContainer" style="display: flex; margin-bottom: 10px; align-items: center;">
                    <label for="selectKring" style="margin-right: 10px; display: inline-block;">Kring:</label>
                    <select id="selectKring"></select>
                </div>
                <div id="selectElectroItemContainer" style="display: flex; margin-bottom: 10px; align-items: center;">
                    <label for="selectElectroItemBox" style="margin-right: 10px; display: inline-block;">Element:</label>
                    <select id="selectElectroItemBox"></select><span style="display: inline-block; width: 10px;"></span>
                    <button id="expandButton" title="Omzetten in indivuele elementen" style="background-color:lightblue;">Uitpakken</button>
                </div>
                <div id="electroItemIdContainer" style="display: flex; margin-bottom: 30px; align-items: center;">
                    <label for="electroItemIdInput" style="margin-right: 10px; display: inline-block;">ID:</label>
                    <input id="electroItemIdInput" style="width: 100px;" type="number" min="0" step="1" value="">
                    <div id="electroItemType" style="margin-left: 10px; width: 100%; font-size: 12px"></div>
                </div>
                <div id="selectContainer" style="display: flex; margin-bottom: 10px; align-items: center;">
                    <label for="selectAdresType" style="margin-right: 10px; display: inline-block; white-space: nowrap;">Label type:</label>
                    <select id="selectAdresType">
                        <option value="auto">Automatisch</option>
                        <option value="manueel">Handmatig</option>
                    </select>
                </div>
                <div id="adresContainer" style="display: flex; margin-bottom: 10px; align-items: center;">
                    <label for="adresInput" style="margin-right: 10px; display: inline-block; white-space: nowrap;">Label tekst:</label>
                    <input id="adresInput" style="width: 100%;" type="text" value="">
                    <select id="selectAdresLocation" style="margin-left: 10px; display: inline-block;">
                        <option value="links">Links</option>
                        <option value="rechts">Rechts</option>
                        <option value="boven">Boven</option>
                        <option value="onder">Onder</option>
                    </select>
                </div>
                <div id="fontSizeContainer" style="display: flex; margin-bottom: 30px; align-items: center;">
                    <label for="fontSizeInput" style="margin-right: 10px; display: inline-block; white-space: nowrap;">Tekengrootte (px):</label>
                    <input id="fontSizeInput" style="width: 100px;" type="number" min="1" max="72" step="11" value="11">
                </div> 
                <div style="display: flex; margin-bottom: 10px; align-items: center;">
                    <label for="scaleInput" style="margin-right: 10px; display: inline-block;">Schaal (%):</label>
                    <input id="scaleInput" style="width: 100px;" type="number" min="10" max="400" step="10" value="${String(globalThis.SITPLANVIEW_DEFAULT_SCALE*100)}">
                </div>
                <div style="display: flex; margin-bottom: 20px; align-items: center;">
                    <label for="rotationInput" style="margin-right: 10px; display: inline-block;">Rotatie (°):</label>
                    <input id="rotationInput" style="width: 100px;" type="number" min="0" max="360" step="10" value="0">
                </div>
                <div id="setDefaultContainer" style="display: flex; margin-bottom: 20px; align-items: flex-start;">
                    <input type="checkbox" id="setDefaultCheckbox">
                    ${s.toonTekenGrootteStandaardVoorNieuweObjecten?'<label for="setDefaultCheckbox" style="margin-left: 10px; flex-grow: 1; flex-wrap: wrap;">Zet tekengrootte en schaal als standaard voor alle toekomstige nieuwe symbolen.</label>':'<label for="setDefaultCheckbox" style="margin-left: 10px; flex-grow: 1; flex-wrap: wrap;">Zet schaal als standaard voor alle toekomstige nieuwe symbolen.</label>'}            
                </div>
                <div style="display: flex; justify-content: center; gap: 0px;">
                    <button id="okButton" class="rounded-button">OK</button>
                    <button id="cancelButton" class="rounded-button">Annuleren</button>
                </div>
            </div>
        </div>`;const m=f.querySelector("#popupOverlay"),x=m.querySelector("#popupWindow"),w=x.querySelector("#closeButton"),P=x.querySelector("#selectKringContainer"),A=x.querySelector("#selectKring"),S=x.querySelector("#selectElectroItemContainer"),N=x.querySelector("#selectElectroItemBox"),W=x.querySelector("#expandButton"),M=x.querySelector("#electroItemIdContainer"),L=x.querySelector("#electroItemIdInput"),j=x.querySelector("#electroItemType"),C=x.querySelector("#selectContainer"),q=x.querySelector("#selectAdresType"),K=x.querySelector("#adresContainer"),O=x.querySelector("#adresInput"),Z=x.querySelector("#selectAdresLocation"),te=x.querySelector("#fontSizeContainer"),Y=x.querySelector("#fontSizeInput"),G=x.querySelector("#scaleInput"),R=x.querySelector("#rotationInput"),$=x.querySelector("#setDefaultCheckbox"),xe=x.querySelector("#okButton"),nt=x.querySelector("#cancelButton");if(o(),d(),u(),i!=null){if(i.getElectroItemId()!=null){let z=globalThis.structure.getElectroItemById(i.getElectroItemId());z!=null&&z.getType()=="Bord"&&s.toonElementZoeker==null&&(s.toonElementZoeker=!1),q.value=i.getAdresType(),O.value=i.getAdres(),Y.value=String(i.labelfontsize),Z.value=i.getAdresLocation(),v()}else s.toonElementZoeker==null&&(s.toonElementZoeker=!1),C.style.display="none",te.style.display="none",K.style.display="none";G.value=Ae(i.getscale()*100,6),R.value=Ae(i.rotate,2)}else v(),Y.value=Ae(globalThis.structure.sitplan.defaults.fontsize,2),G.value=Ae(globalThis.structure.sitplan.defaults.scale*100,6),Z.value="rechts";s.toonElementZoeker==null&&(s.toonElementZoeker=!0),s.toonElementZoeker||(P.style.display="none",S.style.display="none",M.style.display="none");let Dt=new zt;Dt.addEventListener(document,"keydown",z=>{z.key==="Enter"?E(z):z.key==="Escape"&&(z.preventDefault(),z.stopPropagation(),nt.click())}),L.onblur=v,q.onchange=v,O.onclick=()=>{Array.from(q.options).forEach(z=>{z.text==="Handmatig"&&(z.selected=!0)}),O.readOnly=!1},xe.onclick=()=>{function z(re){return/^-?\d+(\.\d+)?$/.test(re)}let J=I(L.value)==""?null:Number(L.value);(!z(G.value)||Number(G.value)<=0)&&(G.value=String(globalThis.structure.sitplan.defaults.scale*100)),z(R.value)||(R.value=String(0)),$.checked&&((i==null||i!=null&&i.getElectroItemId()!=null)&&(globalThis.structure.sitplan.defaults.fontsize=Number(Y.value)),globalThis.structure.sitplan.defaults.scale=Number(G.value)/100),U(),e(J,q.value,O.value,Z.value,Number(Y.value),Number(G.value)/100,Number(R.value))},nt.onclick=()=>{U(),t()},w.onclick=nt.onclick,document.body.appendChild(f),T()}function qa(i,e,t=()=>{}){function s(){o.style.visibility="visible",document.body.style.pointerEvents="none",o.style.pointerEvents="auto"}function a(){o.style.visibility="hidden",document.body.style.pointerEvents="auto",n.remove()}const r=T=>{T.key==="Enter"&&(T.preventDefault(),T.stopPropagation(),u.click())},n=document.createElement("div");n.innerHTML=`
        <div id="popupOverlay" class="popup-overlay">
            <div id="popupWindow" class="popup">
                <h3>Meerdere elementen bewerken</h3>
                <div id="fontSizeContainer" style="display: flex; margin-bottom: 30px; align-items: center;">
                    <label for="fontSizeInput" style="margin-right: 10px; display: inline-block; white-space: nowrap;">Tekengrootte (px):</label>
                    <input id="fontSizeInput" style="width: 100px;" type="number" min="1" max="72" step="11" value="11">
                </div> 
                <div style="display: flex; margin-bottom: 10px; align-items: center;">
                    <label for="scaleInput" style="margin-right: 10px; display: inline-block;">Schaal (%):</label>
                    <input id="scaleInput" style="width: 100px;" type="number" min="10" max="400" step="10" value="${String(globalThis.SITPLANVIEW_DEFAULT_SCALE*100)}">
                </div>
                <div style="display: flex; margin-bottom: 20px; align-items: center;">
                    <label for="rotationInput" style="margin-right: 10px; display: inline-block;">Rotatie (°):</label>
                    <input id="rotationInput" style="width: 100px;" type="number" min="0" max="360" step="10" value="0">
                </div>
                <div id="setDefaultContainer" style="display: flex; margin-bottom: 20px; align-items: flex-start;">
                    <input type="checkbox" id="setDefaultCheckbox">
                    <label for="setDefaultCheckbox" style="margin-left: 10px; flex-grow: 1; flex-wrap: wrap;">Zet tekengrootte en schaal als standaard voor alle toekomstige nieuwe symbolen.</label>
                </div>
                <div style="display: flex; justify-content: center; gap: 0px;">
                    <button id="okButton" class="rounded-button">OK</button>
                    <button id="cancelButton" class="rounded-button">Annuleren</button>
                </div>
            </div>
        </div>`;const o=n.querySelector("#popupOverlay"),c=o.querySelector("#popupWindow"),l=c.querySelector("#fontSizeInput"),d=c.querySelector("#scaleInput"),h=c.querySelector("#rotationInput"),p=c.querySelector("#setDefaultCheckbox"),u=c.querySelector("#okButton"),g=c.querySelector("#cancelButton");let b=null,_=null,v=null;for(let T of i)T.labelfontsize!=null&&(b==null?b=T.labelfontsize:b!=T.labelfontsize&&(b="multiple")),T.getscale()!=null&&(_==null?_=T.getscale():_!=T.getscale()&&(_="multiple")),T.rotate!=null&&(v==null?v=T.rotate:v!=T.rotate&&(v="multiple"));l.value=b!="multiple"?String(b):"",d.value=_!="multiple"&&_!=null?String(_*100):"",h.value=v!="multiple"?String(v):"",l.onkeydown=r,d.onkeydown=r,h.onkeydown=r,u.onclick=()=>{function T(m){return/^-?\d+(\.\d+)?$/.test(m)}let U=null,E=null,f=null;T(l.value)&&(U=Number(l.value)),T(d.value)&&(E=Number(d.value)/100),T(h.value)&&(f=Number(h.value)),p.checked&&(U!=null&&(globalThis.structure.sitplan.defaults.fontsize=Number(l.value)),E!=null&&(globalThis.structure.sitplan.defaults.scale=Number(d.value)/100)),a(),e(U,E,f)},g.onclick=()=>{a(),t()},document.body.appendChild(n),s()}class Ja{show(){const e=document.createElement("div");e.id="popupOverlay",Object.assign(e.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",visibility:"hidden",zIndex:"9999"});const t=document.createElement("div");Object.assign(t.style,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"5px 20px 20px",border:"1px solid #ccc",borderRadius:"8px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)",zIndex:"1000"}),t.innerHTML=`<h3>Aanpassing symbolen schakelaars</h3><p>Beste gebruiker. Uw situatieschema bevat symbolen voor schakelaars. Tot nogtoe werden die altijd afgebeeld met een klein lijntje (leiding) aan de zijkant.</p><table border="0" style="border-collapse:collapse"><tr><td><svg style="padding: 0px; margin: 0px; display:block" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" transform="scale(1,1)" viewBox="12 0 38 40" width="38" height="40"><defs><g id="signalisatielamp"><circle cx="0" cy="0" r="5" fill="white" stroke="black"></circle><line x1="-3" y1="-3" x2="3" y2="3" stroke="black"></line><line x1="-3" y1="3" x2="3" y2="-3" stroke="black"></line></g><g id="schakelaar_enkel"><line x1="0" y1="0" x2="10" y2="-20" stroke="black"></line><line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black"></line><circle cx="0" cy="0" r="5" fill="white" stroke="black"></circle></g></defs><line x1="1" x2="31" y1="25" y2="25" stroke="black"></line><use xlink:href="#schakelaar_enkel" x="31" y="25"></use></svg></td><td><svg style="padding: 0px; margin: 0px; display:block" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" transform="scale(1,1)" viewBox="12 0 38 40" width="38" height="40"><defs><g id="signalisatielamp"><circle cx="0" cy="0" r="5" fill="white" stroke="black"></circle><line x1="-3" y1="-3" x2="3" y2="3" stroke="black"></line><line x1="-3" y1="3" x2="3" y2="-3" stroke="black"></line></g><g id="schakelaar_enkel"><line x1="0" y1="0" x2="10" y2="-20" stroke="black"></line><line x1="10" y1="-20" x2="15" y2="-17.5" stroke="black"></line><circle cx="0" cy="0" r="5" fill="white" stroke="black"></circle></g></defs><use xlink:href="#schakelaar_enkel" x="31" y="25"></use></svg></td></tr></table><p>Op terechte vraag van enkele gebruikers zal dat voor toekomstige schema's niet meer het geval zijn en zullen de symbolen getekend worden zoals gangbaar in de meeste andere tekenprogramma's.</p><p>Doorgaans zal het dan ook niet langer noodzakelijk zijn om dergelijke schakelaars te roteren.</p><p>Voor dit schema kan u zelf nog kiezen hoe u de symbolen wenst weer te geven.</p>`;const s=t.querySelector("h3");s&&(s.style.color="#06F");const a=document.createElement("div");a.style.display="flex",a.style.flexDirection="column",a.style.marginTop="10px";const r=document.createElement("input");r.type="radio",r.name="symbolChoice",r.id="keepLegacy",r.checked=!0;const n=document.createElement("label");n.htmlFor="keepLegacy",n.style.display="flex",n.style.alignItems="start",n.style.marginBottom="10px",n.appendChild(r),n.appendChild(document.createTextNode("U behoudt de symbolen zoals voorheen voor dit schema.")),a.appendChild(n);const o=document.createElement("input");o.type="radio",o.name="symbolChoice",o.id="dropLegacy";const c=document.createElement("label");c.htmlFor="dropLegacy",c.style.display="flex",c.style.alignItems="start",c.style.marginBottom="10px",c.appendChild(o),c.appendChild(document.createTextNode("U gebruikt de nieuwe symbolen zonder lijntje. De oorspronkelijke rotatie wordt hersteld. Mogelijk zal u bepaalde symbolen zelf opnieuw moeten roteren.")),a.appendChild(c),t.appendChild(a);const l=document.createElement("button");return l.textContent="OK",Object.assign(l.style,{marginTop:"10px",padding:"10px 20px",cursor:"pointer",backgroundColor:"#3399FF",border:"none",borderRadius:"5px",marginLeft:"auto",marginRight:"auto",width:"100px"}),l.addEventListener("mouseover",()=>{l.style.backgroundColor="#06F"}),l.addEventListener("mouseout",()=>{l.style.backgroundColor="#3399FF"}),t.appendChild(l),e.appendChild(t),document.body.appendChild(e),e.style.visibility="visible",document.body.style.pointerEvents="none",e.style.pointerEvents="auto",new Promise(d=>{l.addEventListener("click",()=>{const h=document.querySelector('input[name="symbolChoice"]:checked');h&&h.id==="keepLegacy"?globalThis.structure.properties.legacySchakelaars=!0:h&&h.id==="dropLegacy"&&(globalThis.structure.properties.legacySchakelaars=!1,globalThis.structure.sitplan.dropLegacySchakelaars()),document.body.removeChild(e),document.body.style.pointerEvents="auto",d("OK clicked!")},{once:!0})})}}class Za{constructor(e,t,s){this.zoomfactor=1,this.canvas=null,this.paper=null,this.sideBar=new Ga(document.getElementById("sidebar")),this.contextMenu=null,this.pendingAddPos=null,this.isPanningCanvas=!1,this.panStart=null,this.previousCanvasCursorPan=null,this.panCaptureMouseDown=a=>{var h,p;if(this.isAddingDistanceLine||((h=document.getElementById("outerdiv"))==null?void 0:h.style.display)==="none"||document.getElementById("popupOverlay")!=null)return;const r=a.button===0||(a.buttons&1)===1,n=a.button===1||(a.buttons&4)===4;if(!(r&&(a.ctrlKey||a.metaKey))&&!n)return;const l=this.canvas.getBoundingClientRect();a.clientX>=l.left&&a.clientX<=l.right&&a.clientY>=l.top&&a.clientY<=l.bottom&&(a.preventDefault(),a.stopPropagation(),(p=a.stopImmediatePropagation)==null||p.call(a),this.startCanvasPan(a))},this.panCaptureContextMenu=a=>{var o,c;if(((o=document.getElementById("outerdiv"))==null?void 0:o.style.display)==="none"||document.getElementById("popupOverlay")!=null||!(a.ctrlKey||a.metaKey)&&!this.isPanningCanvas)return;const r=this.canvas.getBoundingClientRect();a.clientX>=r.left&&a.clientX<=r.right&&a.clientY>=r.top&&a.clientY<=r.bottom&&(a.preventDefault(),a.stopPropagation(),(c=a.stopImmediatePropagation)==null||c.call(a))},this.isAddingDistanceLine=!1,this.distanceLineFirstPoint=null,this.previousCanvasCursor=null,this.distanceLineCaptureMouseDown=a=>{var d;if(!this.isAddingDistanceLine||a.button!==0)return;const r=this.canvas.getBoundingClientRect();if(!(a.clientX>=r.left&&a.clientX<=r.right&&a.clientY>=r.top&&a.clientY<=r.bottom))return;a.preventDefault(),a.stopPropagation(),(d=a.stopImmediatePropagation)==null||d.call(a);const o=a.clientX-r.left,c=a.clientY-r.top,l=this.canvasPosToPaperPos(o,c);this.handleDistanceLinePoint(l)},this.distanceLineCaptureTouchStart=a=>{var h,p;if(!this.isAddingDistanceLine)return;const r=(h=a.touches[0])!=null?h:a.changedTouches[0];if(!r)return;const n=this.canvas.getBoundingClientRect();if(!(r.clientX>=n.left&&r.clientX<=n.right&&r.clientY>=n.top&&r.clientY<=n.bottom))return;a.preventDefault(),a.stopPropagation(),(p=a.stopImmediatePropagation)==null||p.call(a);const c=r.clientX-n.left,l=r.clientY-n.top,d=this.canvasPosToPaperPos(c,l);this.handleDistanceLinePoint(d)},this.distanceLineCaptureContextMenu=a=>{var o;if(!this.isAddingDistanceLine)return;const r=this.canvas.getBoundingClientRect();a.clientX>=r.left&&a.clientX<=r.right&&a.clientY>=r.top&&a.clientY<=r.bottom&&(a.preventDefault(),a.stopPropagation(),(o=a.stopImmediatePropagation)==null||o.call(a),this.cancelAddDistanceLine())},this.draggedBox=null,this.draggedHalo={left:0,top:0,right:0,bottom:0},this.selected=new Fa,this.showContextMenu=a=>{a.preventDefault(),a.stopPropagation();const r=a.currentTarget;if(r!=null&&!this.selected.includes(r)&&(this.clearSelection(),this.selectOneBox(r)),this.selected.length()<1)return;let n=this.selected.getLastSelected().sitPlanElementRef;if(n!=null){switch(this.contextMenu.clearMenu(),n.movable&&(this.contextMenu.addMenuItem("Draai rechts",()=>{this.rotateSelectedBoxes(90,!0)},"Ctrl →"),this.contextMenu.addMenuItem("Draai links",()=>{this.rotateSelectedBoxes(-90,!0)},"Ctrl ←"),this.contextMenu.addLine()),this.contextMenu.addMenuItem("Bewerk",this.editSelectedBox.bind(this),"Enter"),this.contextMenu.addMenuItem("Verberg",()=>{this.hideSelectedBoxes()},""),this.contextMenu.addLine(),this.getSelectionMovability()){case 0:this.contextMenu.addMenuItem("Vergrendel",this.toggleSelectedBoxesMovable.bind(this),"Ctrl L");break;case 1:this.contextMenu.addMenuItem("Ontgrendel",this.toggleSelectedBoxesMovable.bind(this),"Ctrl L");break;case 2:this.contextMenu.addMenuItem("Vergrendel",()=>{this.toggleSelectedBoxesMovable.bind(this)(1)},"Ctrl L"),this.contextMenu.addMenuItem("Ontgrendel",()=>{this.toggleSelectedBoxesMovable.bind(this)(0)},"");break}n.movable&&(this.contextMenu.addLine(),this.contextMenu.addMenuItem("Verwijder",()=>{this.deleteSelectedBoxes(),globalThis.undostruct.store()},"Del"),this.sitplan.numPages>1&&n.movable&&(this.contextMenu.addLine(),this.contextMenu.addMenuItem("Naar pagina..",this.changePageSelectedBoxes.bind(this),"PgUp/PgDn"))),this.contextMenu.show(a)}},this.showQuickAddMenu=a=>{const r=a.target;if(r!=null&&(r.closest(".box")||r.closest(".boxlabel")||r.closest(".context-menu")))return;a.preventDefault(),a.stopPropagation();const n=this.mouseEventToPaperPos(a);this.contextMenu.clearMenu(),this.contextMenu.addMenuItem("Uit bestand…",()=>{this.pendingAddPos=n;const o=document.getElementById("fileInput");o==null||o.click()}),this.contextMenu.addMenuItem("Verberg alles",()=>{this.hideAllElements()}),this.contextMenu.addMenuItem("Toon alles",()=>{this.showAllElements()}),this.contextMenu.addMenuItem("Uit schema…",()=>{this.openAddElectroItemPopupAt(n)}),this.contextMenu.addMenuItem("Los symbool…",()=>{this.openAddCustomItemPopupAt(n)}),this.contextMenu.addMenuItem("Afstandslijn…",()=>{this.startAddDistanceLine()}),this.contextMenu.show(a)},this.processCanvasPan=a=>{if(!this.isPanningCanvas||!this.panStart)return;a.preventDefault();const r=a.clientX-this.panStart.x,n=a.clientY-this.panStart.y;this.canvas.scrollLeft=this.panStart.scrollLeft-r,this.canvas.scrollTop=this.panStart.scrollTop-n},this.stopCanvasPan=a=>{var r;this.isPanningCanvas&&(document.removeEventListener("mousemove",this.processCanvasPan),document.removeEventListener("mouseup",this.stopCanvasPan),this.isPanningCanvas=!1,this.panStart=null,this.canvas.style.cursor=(r=this.previousCanvasCursorPan)!=null?r:"",this.previousCanvasCursorPan=null)},this.startDrag=a=>{if(a==null)return;const r=a.shiftKey;if(a.button==1)return;this.contextMenu.hide();let n=null,o=a.target.sitPlanElementRef;if(o!=null&&(a.target.classList.contains("box")?n=a.target:a.target.classList.contains("boxlabel")&&(n=o.boxref),n!=null&&(r?this.selectToggleBox(n):(this.selected.includes(n)||this.clearSelection(),this.selectBox(n)),a.stopPropagation(),a.button!=2&&n.classList.contains("selected")&&n.getAttribute("movable")!="false")))switch(this.draggedBox=n,this.draggedHalo=this.getDraggedHaloAroundElement(o),a.type){case"mousedown":this.mousedrag.startDrag(a.clientX,a.clientY,o.posx,o.posy),document.addEventListener("mousemove",this.processDrag),document.addEventListener("mouseup",this.stopDrag);break;case"touchstart":const c=a.touches[0];this.mousedrag.startDrag(c.clientX,c.clientY,o.posx,o.posy),document.addEventListener("touchmove",this.processDrag,{passive:!1}),document.addEventListener("touchend",this.stopDrag);break;default:console.error("Ongeldige event voor startDrag functie")}},this.stopDrag=a=>{function r(){new Pe(globalThis.appDocStorage).show("sitplan.arrowdrag",`<h3>Tip: Symbolen verplaatsen</h3>
            <p>Voor fijnere controle tijdens het verschuiven van symbolen kan u ook de pijltjes op het toetsenbord gebruiken.</p>`,!0)}switch(a.stopPropagation(),a.type){case"mouseup":document.removeEventListener("mousemove",this.processDrag),document.removeEventListener("mouseup",this.stopDrag),this.mousedrag.hassMoved&&(r(),globalThis.undostruct.store());break;case"touchend":document.removeEventListener("touchmove",this.processDrag),document.removeEventListener("touchend",this.stopDrag),this.mousedrag.hassMoved&&(r(),globalThis.undostruct.store());break;default:console.error("Ongeldige event voor stopDrag functie")}this.draggedBox=null},this.processDrag=a=>{if(this.draggedBox){a.preventDefault();const r=this.draggedBox.sitPlanElementRef;if(r===null)return;let n;if(a.type==="mousemove")n=this.mousedrag.returnNewPaperPos(a.clientX,a.clientY);else if(a.type==="touchmove"){const d=a.touches[0];n=this.mousedrag.returnNewPaperPos(d.clientX,d.clientY)}const o=parseFloat(getComputedStyle(this.paper).getPropertyValue("--paperPadding")),c={x:(this.canvas.scrollLeft-o)/this.zoomfactor,y:(this.canvas.scrollTop-o)/this.zoomfactor,width:this.canvas.offsetWidth/this.zoomfactor,height:this.canvas.offsetHeight/this.zoomfactor};n.x=Math.min(c.x+c.width,Math.max(c.x,this.draggedHalo.left-o/this.zoomfactor,n.x)),n.y=Math.min(c.y+c.height,Math.max(c.y,this.draggedHalo.top-o/this.zoomfactor,n.y));const l={x:n.x-r.posx,y:n.y-r.posy};for(let d of this.selected.getAllSelected()){if(d==null)continue;const h=d.sitPlanElementRef;h!=null&&h.movable!==!1&&(h.posx+=l.x,h.posy+=l.y,this.updateSymbolAndLabelPosition(h))}}},this.addElectroItem=(a,r,n,o,c,l,d,h=null,p=null,u={undoStore:!0})=>{u.undoStore==null&&(u.undoStore=!0);let g=this.canvasPosToPaperPos(50,50);if(h==null&&(h=g.x),p==null&&(p=g.y),a!=null){let b=this.sitplan.addElementFromElectroItem(a,this.sitplan.activePage,h,p,r,n,o,c,l,d);b!=null&&(this.syncToSitPlan(),this.clearSelection(),this.redraw(),this.selectOneBox(b.boxref),this.bringToFront(u.undoStore))}else alert("Geen geldig ID ingegeven!")},this.editSelectedBox=a=>{var r;if(this.contextMenu.hide(),this.unattachArrowKeys(),this.selected.length()==1){const n=this.selected.getLastSelected().sitPlanElementRef;if(!n)return;if(n.kind==="distanceLine"){const o=(r=n.distanceLine)==null?void 0:r.distanceCm,c=window.prompt("Afstand in centimeter (cm):",o==null?"":String(o));if(this.attachArrowKeys(),c==null){a&&a();return}const l=c.trim(),d=l===""?null:Number(l.replace(",","."));if(l!==""&&!(Number.isFinite(d)&&d>=0)){alert("Ongeldige afstand. Geef een getal in centimeters in."),a&&a();return}n.distanceLine||(n.distanceLine={x1:0,y1:0,x2:1,y2:1,distanceCm:null}),n.distanceLine.distanceCm=d,this.updateBoxContent(n),this.updateSymbolAndLabelPosition(n),globalThis.undostruct.store();return}ht(n,(o,c,l,d,h,p,u)=>{this.attachArrowKeys(),o!=null&&(n.setElectroItemId(o),n.setAdres(c,l,d)),n.labelfontsize=h,n.setscale(p),n.rotate=u,this.updateBoxContent(n),this.updateSymbolAndLabelPosition(n),globalThis.undostruct.store()},()=>{this.attachArrowKeys(),a&&a()},{toonElementZoeker:!1})}else if(this.selected.length()>1){const n=[];for(let o of this.selected.getAllSelected()){const c=o.sitPlanElementRef;c!=null&&n.push(c)}qa(n,(o,c,l)=>{this.attachArrowKeys();for(let d of n)o!=null&&(d.labelfontsize=o),c!=null&&d.setscale(c),l!=null&&(d.rotate=l),this.updateBoxContent(d),this.updateSymbolAndLabelPosition(d);globalThis.undostruct.store()},()=>{this.attachArrowKeys(),a&&a()})}},this.canvas=e,this.paper=t,this.contextMenu=new Ks,this.sitplan=s,this.paper.style.transformOrigin="top left",this.mousedrag=new Wa,this.event_manager=new zt,this.event_manager.addEventListener(e,"mousedown",a=>{this.handleCanvasPointerDown(a)}),this.event_manager.addEventListener(e,"touchstart",a=>{this.handleCanvasPointerDown(a)}),document.addEventListener("mousedown",this.panCaptureMouseDown,!0),document.addEventListener("contextmenu",this.panCaptureContextMenu,!0),this.event_manager.addEventListener(e,"mousedown",a=>{var r,n;this.isAddingDistanceLine||((r=document.getElementById("outerdiv"))==null?void 0:r.style.display)!=="none"&&document.getElementById("popupOverlay")==null&&a.button===0&&(a.ctrlKey||a.metaKey)&&(a.preventDefault(),a.stopPropagation(),(n=a.stopImmediatePropagation)==null||n.call(a),this.startCanvasPan(a))},{capture:!0}),this.event_manager.addEventListener(e,"contextmenu",this.showQuickAddMenu),this.event_manager.addEventListener(e,"contextmenu",a=>{this.isPanningCanvas&&(a.preventDefault(),a.stopPropagation())}),this.event_manager.addEventListener(e,"wheel",a=>{var l;if(((l=document.getElementById("outerdiv"))==null?void 0:l.style.display)==="none"||document.getElementById("popupOverlay")!=null||this.isAddingDistanceLine)return;a.preventDefault();const r=this.canvas.getBoundingClientRect(),n=a.clientX-r.left,o=a.clientY-r.top,c=-a.deltaY;Math.abs(c)<.5||this.zoomIncrement(c/2e3,n,o)},{passive:!1}),this.attachArrowKeys()}getVisibleCenterPaperPos(){return this.canvasPosToPaperPos(this.canvas.clientWidth/2,this.canvas.clientHeight/2)}mouseEventToPaperPos(e){const t=this.canvas.getBoundingClientRect(),s=e.clientX-t.left,a=e.clientY-t.top;return this.canvasPosToPaperPos(s,a)}openAddElectroItemPopupAt(e){this.contextMenu.hide(),this.unattachArrowKeys(),ht(null,(t,s,a,r,n,o,c)=>{this.attachArrowKeys(),this.addElectroItem(t,s,a,r,n,o,c,e.x,e.y)},()=>{this.attachArrowKeys()})}openAddCustomItemPopupAt(e){this.contextMenu.hide(),ts.showItemTypeSelectionPopup((t,s,a)=>{const r=globalThis.structure.createContainerIfNotExists(),n=globalThis.structure.createItem(t);globalThis.structure.insertChildAfterId(n,r.id);const o=globalThis.structure.sitplan.defaults.fontsize;this.addElectroItem(n.id,"manueel","","rechts",o,s,a,e.x,e.y)})}canvasPosToPaperPos(e,t){const s=parseFloat(getComputedStyle(this.paper).getPropertyValue("--paperPadding"));return{x:(e+this.canvas.scrollLeft-s)/this.zoomfactor,y:(t+this.canvas.scrollTop-s)/this.zoomfactor}}paperPosToCanvasPos(e,t){const s=parseFloat(getComputedStyle(this.paper).getPropertyValue("--paperPadding"));return{x:e*this.zoomfactor-this.canvas.scrollLeft+s,y:t*this.zoomfactor-this.canvas.scrollTop+s}}canvasAndPaperPosToScrollPos(e,t,s,a){const r=parseFloat(getComputedStyle(this.paper).getPropertyValue("--paperPadding"));return{x:s*this.zoomfactor-e+r+.5,y:a*this.zoomfactor-t+r+.5}}dispose(){this.event_manager.dispose();for(let e of this.sitplan.elements)e.boxref!=null&&e.boxref.remove(),e.boxlabelref!=null&&e.boxlabelref.remove()}syncToSitPlan(){this.sitplan.syncToEendraadSchema()}zoomToFit(e=parseFloat(getComputedStyle(this.paper).getPropertyValue("--paperPadding"))){parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--sideBarWidth"));const t=Math.min((this.canvas.offsetWidth-e*2)/this.paper.offsetWidth,(this.canvas.offsetHeight-e*2)/this.paper.offsetHeight);this.setzoom(t)}getZoomFactor(){return this.zoomfactor}setzoom(e=1){this.zoomfactor=e,this.paper.style.transform=`scale(${e})`}zoomIncrement(e=0,t=this.canvas.offsetWidth/2,s=this.canvas.offsetHeight/2){let a=this.canvasPosToPaperPos(t,s);this.setzoom(Math.min(globalThis.SITPLANVIEW_ZOOMINTERVAL.MAX,Math.max(globalThis.SITPLANVIEW_ZOOMINTERVAL.MIN,this.zoomfactor*(1+e))));const r=this.canvasAndPaperPosToScrollPos(t,s,a.x,a.y);this.canvas.scrollLeft=r.x,this.canvas.scrollTop=r.y}getSelectionMovability(){let e=3;for(let t of this.selected.getAllSelected()){let s=t.sitPlanElementRef;if(s!=null)switch(s.movable){case!0:e==3||e==0?e=0:e==1&&(e=2);break;case!1:default:e==3||e==1?e=1:e==0&&(e=2);break}}return e}toggleSelectedBoxesMovable(e=3){if(e==3){let t=this.getSelectionMovability();e=t==0||t==2?1:0}for(let t of this.selected.getAllSelected()){let s=t.sitPlanElementRef;if(s!=null){let a=s.boxlabelref;switch(e){case 1:s.movable=!1,t.setAttribute("movable","false"),a!=null&&a.setAttribute("movable","false");break;case 0:s.movable=!0,t.setAttribute("movable","true"),a!=null&&a.setAttribute("movable","true");break}}}this.selected.length()>0&&globalThis.undostruct.store()}changePageSelectedBoxes(){if(this.selected.length()>0){const e=Array.from({length:this.sitplan.numPages},(n,o)=>String(o+1)).filter(n=>n!==String(this.sitplan.activePage));let t=this.selected.getAllSelected().filter(n=>n!=null),s=t.filter(n=>n.sitPlanElementRef!=null&&n.sitPlanElementRef.movable),r=t.map(n=>n.sitPlanElementRef).filter(n=>n!=null).filter(n=>n.movable);(async()=>{const n=await ci("Nieuwe pagina:",e);if(n!==null){for(let o of r)o.changePage(+n);this.selectPage(+n);for(let o of s)this.selectBox(o);globalThis.undostruct.store()}})()}}startAddDistanceLine(){this.isAddingDistanceLine=!0,this.distanceLineFirstPoint=null,this.previousCanvasCursor==null&&(this.previousCanvasCursor=this.canvas.style.cursor),this.canvas.style.cursor="crosshair",this.paper.style.cursor="crosshair",document.body.classList.add("distance-line-mode"),this.clearSelection(),document.addEventListener("mousedown",this.distanceLineCaptureMouseDown,!0),document.addEventListener("touchstart",this.distanceLineCaptureTouchStart,{passive:!1,capture:!0}),document.addEventListener("contextmenu",this.distanceLineCaptureContextMenu,!0)}cancelAddDistanceLine(){this.isAddingDistanceLine&&(this.isAddingDistanceLine=!1,this.distanceLineFirstPoint=null,document.removeEventListener("mousedown",this.distanceLineCaptureMouseDown,!0),document.removeEventListener("touchstart",this.distanceLineCaptureTouchStart,!0),document.removeEventListener("contextmenu",this.distanceLineCaptureContextMenu,!0),this.previousCanvasCursor!=null?(this.canvas.style.cursor=this.previousCanvasCursor,this.previousCanvasCursor=null):this.canvas.style.cursor="",this.paper.style.cursor="",document.body.classList.remove("distance-line-mode"))}handleDistanceLinePoint(e){if(this.distanceLineFirstPoint==null){this.distanceLineFirstPoint=e;return}const t=this.distanceLineFirstPoint,s=e;this.distanceLineFirstPoint=null;const a=window.prompt("Afstand in centimeter (cm):","");if(a==null){this.cancelAddDistanceLine();return}const r=a.trim(),n=r===""?null:Number(r.replace(",","."));if(r!==""&&!(Number.isFinite(n)&&n>=0)){alert("Ongeldige afstand. Geef een getal in centimeters in."),this.cancelAddDistanceLine();return}this.addDistanceLine(t,s,n),this.cancelAddDistanceLine()}handleCanvasPointerDown(e){var s,a,r,n;if(this.contextMenu.hide(),!this.isAddingDistanceLine&&e.button!=null){const o=e;if(o.button===0&&(o.ctrlKey||o.metaKey)){(s=o.preventDefault)==null||s.call(o),(a=o.stopPropagation)==null||a.call(o),this.startCanvasPan(o);return}}if(!this.isAddingDistanceLine){this.clearSelection();return}(r=e.preventDefault)==null||r.call(e),(n=e.stopPropagation)==null||n.call(e);const t=(()=>{var o;if(e.touches!=null){const c=e,l=(o=c.touches[0])!=null?o:c.changedTouches[0];if(!l)return null;const d=this.canvas.getBoundingClientRect(),h=l.clientX-d.left,p=l.clientY-d.top;return this.canvasPosToPaperPos(h,p)}return this.mouseEventToPaperPos(e)})();t&&this.handleDistanceLinePoint(t)}startCanvasPan(e){this.isPanningCanvas||(this.isPanningCanvas=!0,this.panStart={x:e.clientX,y:e.clientY,scrollLeft:this.canvas.scrollLeft,scrollTop:this.canvas.scrollTop},this.previousCanvasCursorPan=this.canvas.style.cursor,this.canvas.style.cursor="grabbing",document.addEventListener("mousemove",this.processCanvasPan),document.addEventListener("mouseup",this.stopCanvasPan))}makeBox(e,t=null){let s=document.createElement("div");Object.assign(s,{id:e.id,className:"box",sitPlanElementRef:e}),s.setAttribute("movable",e.movable?"true":"false"),e.boxref=s;let a=document.createElement("div");Object.assign(a,{id:e.id+"_label",className:"boxlabel",sitPlanElementRef:e}),a.setAttribute("movable",e.movable?"true":"false"),a.innerHTML=y(e.getAdres()),e.boxlabelref=a,this.updateBoxContent(e),t?t.append(s,a):this.paper.append(s,a),s.addEventListener("mousedown",this.startDrag),s.addEventListener("touchstart",this.startDrag),a.addEventListener("mousedown",this.startDrag),a.addEventListener("touchstart",this.startDrag),s.addEventListener("contextmenu",this.showContextMenu),a.addEventListener("contextmenu",this.showContextMenu)}updateBoxContent(e){if(!e)return;const t=e.boxref,s=e.boxlabelref;if(t==null)return;let a=e.getScaledSVG();if(e.needsViewUpdate&&(e.needsViewUpdate=!1,a!=null?t.innerHTML=a:t.innerHTML=""),s!=null){let r=e.getAdres();e.labelfontsize!=null&&(s.style.fontSize=String(e.labelfontsize)+"px");let n=r!=null?y(r):"";n!=s.innerHTML&&(s.innerHTML=n)}}updateLabelPosition(e){if(!e)return;const t=e.boxlabelref;if(!t)return;const s=e.getscale(),a=sa(e.sizex*s+globalThis.SITPLANVIEW_SELECT_PADDING,e.sizey*s+globalThis.SITPLANVIEW_SELECT_PADDING,e.rotate),r=e.getAdresLocation();switch(r){case"links":e.labelposx=e.posx-a.width/2-t.offsetWidth/2;break;case"rechts":e.labelposx=e.posx+a.width/2+t.offsetWidth/2;break;default:e.labelposx=e.posx}const n=`${e.labelposx-t.offsetWidth/2}px`;t.style.left!=n&&(t.style.left=n);let o;switch(r){case"boven":{o=`${e.posy-a.height/2-t.offsetHeight*.8}px`,e.labelposy=e.posy-a.height/2-t.offsetHeight*.5/2;break}case"onder":{o=`${e.posy+a.height/2-t.offsetHeight*.2}px`,e.labelposy=e.posy+a.height/2+t.offsetHeight*.7/2;break}default:o=`${e.posy-t.offsetHeight/2}px`,e.labelposy=e.posy+1}t.style.top!=o&&(t.style.top=o),this.sitplan.activePage==e.page&&e.visible!==!1?t.classList.contains("hidden")&&t.classList.remove("hidden"):t.classList.contains("hidden")||t.classList.add("hidden")}updateSymbolPosition(e){function t(u){if(!u)return"";const[g,b]=u.berekenAfbeeldingsRotatieEnSpiegeling();return`rotate(${g}deg)`+(b?" scaleX(-1)":"")}if(!e)return;const s=e.boxref;if(!s)return;const a=e.getscale(),r=e.sizex*a,n=e.sizey*a,o=(e.posx-r/2-globalThis.SITPLANVIEW_SELECT_PADDING).toString()+"px";s.style.left!=o&&(s.style.left=o);const c=(e.posy-n/2-globalThis.SITPLANVIEW_SELECT_PADDING).toString()+"px";s.style.top!=c&&(s.style.top=c);const l=(r+globalThis.SITPLANVIEW_SELECT_PADDING*2).toString()+"px";s.style.width!=l&&(s.style.width=l);const d=(n+globalThis.SITPLANVIEW_SELECT_PADDING*2).toString()+"px";s.style.height!=d&&(s.style.height=d);const h=t(e);s.style.transform!=h&&(s.style.transform=h),this.sitplan.activePage==e.page&&e.visible!==!1?s.classList.contains("hidden")&&s.classList.remove("hidden"):s.classList.contains("hidden")||s.classList.add("hidden")}updateSymbolAndLabelPosition(e){e&&(this.updateSymbolPosition(e),this.updateLabelPosition(e))}redraw(){const e=performance.now();this.syncToSitPlan();const t=document.createDocumentFragment();let s=!1;for(let r of this.sitplan.elements)r.boxref||(this.makeBox(r,t),s=!0);s&&this.paper.append(t),this.showPage(this.sitplan.activePage);for(let r of this.sitplan.elements)r.page==this.sitplan.activePage&&(this.updateBoxContent(r),this.updateSymbolAndLabelPosition(r));this.updateRibbon(),this.sideBar.render();const a=performance.now();console.log(`Redraw took ${a-e}ms`)}getLastSelectedBoxOrdinal(){return this.selected.length()==0?null:this.sitplan.elements.findIndex(e=>e.boxref==this.selected.getLastSelected())}getSelectedBoxesOrdinals(){return this.selected.length()==0?[]:this.sitplan.elements.filter(e=>this.selected.includes(e.boxref)).map(e=>this.sitplan.elements.indexOf(e))}selectOneBox(e){e&&(e.classList.add("selected"),this.selected.selectOne(e),globalThis.undostruct.updateSelectedBoxes())}selectBox(e){e&&(e.classList.add("selected"),this.selected.select(e),globalThis.undostruct.updateSelectedBoxes())}selectToggleBox(e){e&&(this.selected.toggleButNeverRemoveLast(e),this.selected.includes(e)?e.classList.add("selected"):e.classList.remove("selected"),globalThis.undostruct.updateSelectedBoxes())}clearSelection(){document.querySelectorAll(".box").forEach(t=>t.classList.remove("selected")),this.selected.clear()}deleteSelectedBoxes(){if(this.selected.length()!=0){for(let e of this.selected.getAllSelected()){let t=e.sitPlanElementRef;t!=null&&t.movable!=!1&&(e.remove(),t.boxlabelref!=null&&t.boxlabelref.remove(),this.sitplan.removeElement(t))}this.selected.clear(),this.sideBar.render()}}sendToBack(){if(this.selected.length()!=0){for(let e of this.sitplan.elements)if(e.boxref!=null){let t;this.selected.includes(e.boxref)&&e.movable!=!1?t=0:t=(parseInt(e.boxref.style.zIndex)||0)+1,e.boxref.style.zIndex=t.toString(),e.boxlabelref!=null&&(e.boxlabelref.style.zIndex=t.toString())}this.sitplan.orderByZIndex(),globalThis.undostruct.store()}}bringToFront(e=!0){if(this.selected.length()==0)return;let t=0;for(let s of this.sitplan.elements)s.boxref!=null&&!this.selected.includes(s.boxref)&&(t=Math.max(t,parseInt(s.boxref.style.zIndex)||0));t+=1;for(let s of this.selected.getAllSelected()){let a=s.sitPlanElementRef;if(a==null){this.sitplan.syncToSitPlan();return}a.movable!=!1&&(s.style.zIndex=t.toString(),a.boxlabelref!=null&&(a.boxlabelref.style.zIndex=t.toString()))}this.sitplan.orderByZIndex(),e&&globalThis.undostruct.store()}getDraggedHaloAroundElement(e){let t=e.posx,s=e.posy,a=e.posx,r=e.posy;for(let o of this.selected.getAllSelected()){if(o==null||o===this.draggedBox)continue;const c=o.sitPlanElementRef;c!=null&&c.movable!=!1&&(t=Math.min(t,c.posx),s=Math.min(s,c.posy),a=Math.max(a,c.posx),r=Math.max(r,c.posy))}return{left:e.posx-t,right:a-e.posx,top:e.posy-s,bottom:r-e.posy}}selectPage(e){this.sitplan.activePage=e,this.redraw()}showPage(e){this.clearSelection();for(let t of this.sitplan.elements)t.page!=e||t.visible===!1?(t.boxref.classList.add("hidden"),t.boxlabelref.classList.add("hidden")):(t.boxref.classList.remove("hidden"),t.boxlabelref.classList.remove("hidden"));this.updateRibbon()}hideSelectedBoxes(){if(this.selected.length()!==0){for(let e of this.selected.getAllSelected()){const t=e==null?void 0:e.sitPlanElementRef;t&&(t.visible=!1,this.updateSymbolAndLabelPosition(t))}this.clearSelection(),this.sideBar.render(),globalThis.undostruct.store()}}showAllElements(){var e;for(let t of this.sitplan.elements)((e=t.getElectroItemId)==null?void 0:e.call(t))!=null&&(t.visible=!0);this.redraw(),globalThis.undostruct.store()}hideAllElements(){var e;for(let t of this.sitplan.elements)((e=t.getElectroItemId)==null?void 0:e.call(t))!=null&&(t.visible=!1);this.clearSelection(),this.redraw(),globalThis.undostruct.store()}rotateSelectedBoxes(e,t=!1){function s(a,r){const n=["boven","rechts","onder","links"];if(a==null)return;const o=n.indexOf(a.getAdresLocation());a.setAdresLocation(n[(o+r+4)%4])}for(let a of this.selected.getAllSelected()){let r=a.sitPlanElementRef;r!=null&&r.movable!=!1&&(r.rotate=(r.rotate+e)%360,t&&s.bind(this)(r,Math.round(e/90)),this.updateBoxContent(r),this.updateSymbolAndLabelPosition(r))}this.selected.length()>0&&globalThis.undostruct.store()}unattachArrowKeys(){this.event_manager.addEventListener(document,"keydown",()=>{})}attachArrowKeys(){this.event_manager.addEventListener(document,"keydown",e=>{if(this.contextMenu.hide(),document.getElementById("outerdiv").style.display=="none"||document.getElementById("popupOverlay")!=null)return;if(e.key==="Escape"&&this.isAddingDistanceLine){this.cancelAddDistanceLine();return}let t=this.selected.getAllSelected().filter(o=>o!=null),s=t.filter(o=>o.sitPlanElementRef!=null&&o.sitPlanElementRef.movable),a=t.map(o=>o.sitPlanElementRef).filter(o=>o!=null),r=a.filter(o=>o.movable);const n=parseFloat(getComputedStyle(this.paper).getPropertyValue("--paperPadding"));if(e.ctrlKey)switch(e.key){case"z":e.preventDefault(),globalThis.undostruct.undo();return;case"y":e.preventDefault(),globalThis.undostruct.redo();return;case"r":e.preventDefault(),new Pe(globalThis.appDocStorage).show("sitplan.Ctrl_r_key",`<h3>Ctrl-r genegeerd</h3>
                        <p>Om te vermijden dat u per ongeluk de pagina ververst en uw werk verliest is de refresh sneltoets uitgeschakeld in het situatieschema.</p>`,!0);return}if(this.selected.length()>0){e.preventDefault();const o=this.selected.getLastSelected().sitPlanElementRef;if(!o)return;const c=this.getDraggedHaloAroundElement(o);if(e.ctrlKey)switch(e.key){case"ArrowLeft":this.rotateSelectedBoxes(-90,!0);return;case"ArrowRight":this.rotateSelectedBoxes(90,!0);return;case"l":case"L":this.toggleSelectedBoxesMovable();return;default:return}else switch(e.key){case"ArrowLeft":{const h=Math.max(c.left-n/this.zoomfactor,o.posx-1)-o.posx;for(let p of r)p.posx+=h;globalThis.undostruct.store("arrowMove"+o.id);break}case"ArrowRight":const l=1;for(let h of r)h.posx+=l;globalThis.undostruct.store("arrowMove"+o.id);break;case"ArrowUp":{const h=Math.max(c.top-n/this.zoomfactor,o.posy-1)-o.posy;for(let p of r)p.posy+=h;globalThis.undostruct.store("arrowMove"+o.id);break}case"ArrowDown":const d=1;for(let h of r)h.posy+=d;globalThis.undostruct.store("arrowMove"+o.id);break;case"PageDown":{let h=o.page,p=o.page+1;if(p>this.sitplan.numPages&&(p=1),p==h)return;for(let u of r)u.changePage(p);this.selectPage(p);for(let u of s)this.selectBox(u);this.bringToFront(!1),globalThis.undostruct.store()}break;case"PageUp":{let h=o.page,p=o.page-1;if(p<1&&(p=this.sitplan.numPages),p==h)return;this.selected.getAllSelected();for(let u of r)u.changePage(p);this.selectPage(p);for(let u of s)this.selectBox(u);this.bringToFront(!1),globalThis.undostruct.store()}break;case"Escape":this.isAddingDistanceLine&&this.cancelAddDistanceLine(),this.clearSelection();break;case"Enter":this.editSelectedBox();return;case"Delete":this.selected.length()>0&&(this.deleteSelectedBoxes(),globalThis.undostruct.store());break;default:return}t=this.selected.getAllSelected().filter(l=>l!=null),s=t.filter(l=>l.sitPlanElementRef!=null&&l.sitPlanElementRef.movable),a=t.map(l=>l.sitPlanElementRef).filter(l=>l!=null),r=a.filter(l=>l.movable);for(let l of r)this.updateSymbolAndLabelPosition(l)}else switch(e.key){case"PageDown":{let o=this.sitplan.activePage,c=o+1;c>this.sitplan.numPages&&(c=1),this.selectPage(c),c!=o&&globalThis.undostruct.store("changePage")}break;case"PageUp":{let c=this.sitplan.activePage-1;c<1&&(c=this.sitplan.numPages),this.selectPage(c),c!=this.sitplan.activePage&&globalThis.undostruct.store("changePage")}break}})}attachDeleteButton(e){this.event_manager.addEventListener(e,"click",()=>{this.contextMenu.hide(),this.selected.length()>0&&(this.deleteSelectedBoxes(),new Pe(globalThis.appDocStorage).show("sitplan.deletekey",`<h3>Tip: Symbolen verwijderen</h3>
                <p>Bespaar tijd en gebruik de 'Delete' toets op het toetsenbord om symbolen te verwijderen.</p>`,!0),globalThis.undostruct.store())})}attachSendToBackButton(e){this.event_manager.addEventListener(e,"click",()=>{this.contextMenu.hide(),this.sendToBack()})}attachBringToFrontButton(e){this.event_manager.addEventListener(e,"click",()=>{this.contextMenu.hide(),this.bringToFront()})}attachZoomButton(e,t){this.event_manager.addEventListener(e,"click",()=>{this.contextMenu.hide(),this.zoomIncrement(t)})}attachZoomToFitButton(e){this.event_manager.addEventListener(e,"click",()=>{this.contextMenu.hide(),this.zoomToFit()})}attachAddElementFromFileButton(e,t){this.event_manager.addEventListener(e,"click",()=>{this.contextMenu.hide(),t.click()}),this.event_manager.addEventListener(t,"change",s=>{var c,l;const a=this.pendingAddPos;this.pendingAddPos=null;const r=(c=a==null?void 0:a.x)!=null?c:this.paper.offsetWidth/2,n=(l=a==null?void 0:a.y)!=null?l:this.paper.offsetHeight/2;let o=this.sitplan.addElementFromFile(s,this.sitplan.activePage,r,n,(()=>{this.syncToSitPlan(),this.clearSelection(),o.needsViewUpdate=!0;const d=o.scale;if(o.scaleSelectedBoxToPaperIfNeeded(this.paper.offsetWidth*.995,this.paper.offsetHeight*.995,this.sitplan.defaults.scale),this.redraw(),this.selectOneBox(o.boxref),t.value="",o.sizex==0||o.sizey==0){this.deleteSelectedBoxes(),new dt("Ongeldige afmetingen","<p>Dit bestand wordt door de browser herkend als een afbeelding met hoogte of breedte gelijk aan 0.</p><p>Dit bestand kan bijgevolg niet geladen worden.</p>").show();return}o.svg&&o.svg.length>5e6&&new dt("Zeer groot bestand","<p>Dit bestand is met "+(o.svg.length/1e6*6/8).toFixed(0)+"MB behoorlijk groot en kan uw browser vertragen of tot moeilijkheden leiden bij het opslaan en/of printen.</p><p>We raden aan het bestand te verkleinen tot beneden 5MB, bijvoorbeeld door het gebruik van het jpeg-bestandsformaat en/of verlagen van de resolutie.</p>").show(),this.bringToFront(),o.scale!=d&&new Pe(globalThis.appDocStorage).show("sitplan.scaledImageToFit",'<h3>Mededeling</h3><p>Deze afbeelding werd automatisch verkleind om binnen de tekenzone te blijven.</p><p>Kies "Bewerk" in het menu om de schaalfactor verder aan te passen indien gewenst.</p>',!0)}).bind(this))})}attachAddElectroItemButton(e){this.event_manager.addEventListener(e,"click",()=>{this.contextMenu.hide(),this.unattachArrowKeys(),ht(null,(t,s,a,r,n,o,c)=>{this.attachArrowKeys(),this.addElectroItem(t,s,a,r,n,o,c)},()=>{this.attachArrowKeys()})})}attachAddCustomItemButton(e){this.event_manager.addEventListener(e,"click",()=>{ts.showItemTypeSelectionPopup((t,s,a)=>{const r=globalThis.structure.createContainerIfNotExists(),n=globalThis.structure.createItem(t);globalThis.structure.insertChildAfterId(n,r.id);let o=globalThis.structure.sitplan.defaults.fontsize;this.addElectroItem(n.id,"manueel","","rechts",o,s,a)})})}addDistanceLine(e,t,s){const a=new Se;a.setVars({page:this.sitplan.activePage,movable:!0,labelfontsize:this.sitplan.defaults.fontsize}),a.setDistanceLineAbsolute(e,t,s),this.sitplan.addElement(a),this.syncToSitPlan(),this.clearSelection(),this.redraw(),this.selectOneBox(a.boxref),this.bringToFront(!0)}attachEditButton(e){this.event_manager.addEventListener(e,"click",()=>{this.editSelectedBox()})}wipePage(e){let t=this.sitplan.elements.filter(s=>s.page==e);for(let s of t)s!=null&&(s.boxref!=null&&s.boxref.remove(),s.boxlabelref!=null&&s.boxlabelref.remove(),this.sitplan.removeElement(s))}updateRibbon(){if(globalThis.structure.properties.currentView!="draw")return;let e="",t="";e+=`
            <div class="icon" ${globalThis.undostruct.undoStackSize()>0?'onclick="undoClicked()"':'style="filter: opacity(45%)"'}>
                <img src="gif/undo.png" alt="Ongedaan maken" class="icon-image">
                <span class="icon-text">Ongedaan maken</span>
            </div>
            <div class="icon"  ${globalThis.undostruct.redoStackSize()>0?'onclick="redoClicked()"':'style="filter: opacity(45%)"'}>
                <img src="gif/redo.png" alt="Opnieuw" class="icon-image">
                <span class="icon-text">Opnieuw</span>
            </div>`,e+=`
            <span style="display: inline-block; width: 30px;"></span>
            <div class="icon" id="button_Add">
                <span class="icon-image" style="font-size:24px">➕</span>
                <span class="icon-text">Uit bestand</span>
            </div>
            <div class="icon" id="button_Add_electroItem">
                <span class="icon-image" style="font-size:24px">➕</span>
                <span class="icon-text">Uit schema</span>
            </div>`,e+=`
            <div class="icon" id="button_Add_customItem">
                <span class="icon-image" style="font-size:24px">➕</span>
                <span class="icon-text">Los symbool</span>
            </div>`,e+=`
            <div class="icon" id="button_Add_distanceLine">
                <span class="icon-image" style="font-size:24px">📏</span>
                <span class="icon-text">Afstandslijn</span>
            </div>`,e+=`
            <div class="icon" id="button_Delete">
                <span class="icon-image" style="font-size:24px">🗑</span>
                <span class="icon-text">Verwijder</span>
            </div>`,e+=`
            <span style="display: inline-block; width: 10px;"></span>
            <div class="icon" id="button_edit">
                <span class="icon-image" style="font-size:24px">&#x2699;</span>
                <span class="icon-text">Bewerk</span>
            </div>`,e+=`
            <span style="display: inline-block; width: 10px;"></span>
            <div class="icon" id="sendBack">
                <span class="icon-image" style="font-size:24px">⬇⬇</span>
                <span class="icon-text">Naar achter</span>
            </div>
            <div class="icon" id="bringFront">
                <span class="icon-image" style="font-size:24px">⬆⬆</span>
                <span class="icon-text">Naar voor</span>
            </div>`,globalThis.autoSaver&&globalThis.autoSaver.hasChangesSinceLastManualSave()?e+=`
                <span style="display: inline-block; width: 10px;"></span>
                <div class="highlight-warning-big" style="width: 64px; display: inline-block; vertical-align: middle; text-align: center;" id="button_save" onclick="saveSchema()" onmouseover="this.style.cursor='pointer'" onmouseout="this.style.cursor='default'">
                    <span class="icon-image" style="font-size:24px">💾</span>
                    <span class="icon-text" style="display: inline-block; width: 100%;">Opslaan</span>
                </div>`:e+=`
                <span style="display: inline-block; width: 10px;"></span>
                <div class="highlight-ok-big" id="button_save" style="width: 64px; display: inline-block; vertical-align: middle; text-align: center;" onmouseover="this.style.cursor='pointer'" onmouseout="this.style.cursor='default'" onclick="topMenu.selectMenuItemByName('Bestand')">
                    <span class="icon-image" style="font-size:24px; filter: grayscale(100%); opacity: 0.5;">💾</span>
                    <span class="icon-text" style="display: inline-block; width: 100%;">Bestand</span>
                </div>`,e+=`
            <span style="display: inline-block; width: 50px;"></span>
            <div>
                <center>
                    <span style="display: inline-block; white-space: nowrap;">Pagina
                        <select id="id_sitplanpage">`;for(let s=1;s<=this.sitplan.numPages;s++)e+='<option value="'+s+'"'+(s==this.sitplan.activePage?" selected":"")+">"+s+"</option>";e+=`
                        </select>
                    </span><br><span style="display: inline-block; white-space: nowrap;">
                        <button id="btn_sitplan_addpage" ${this.sitplan.activePage!=this.sitplan.numPages?" disabled":""}>Nieuw</button>
                        <button id="btn_sitplan_delpage" style="background-color:red;" ${this.sitplan.numPages<=1?" disabled":""}>&#9851;</button>
                    </span>
                </center>
            </div>`,t+=`
            <span style="display: inline-block; width: 10px;"></span>
            <div class="icon" id="button_zoomin">
                <span class="icon-image" style="font-size: 24px;">🔍</span>
                <span class="icon-text">In</span>
            </div>
            <div class="icon" id="button_zoomout">
                <span class="icon-image" style="font-size: 24px;">🌍</span>
                <span class="icon-text">Uit</span>
            </div>
            <div class="icon" id="button_zoomToFit">
                <span class="icon-image" style="font-size: 24px;">🖥️</span>
                \x3C!--<img src="gif/scaleup.png" alt="Schermvullend" class="icon-image">-->
                <span class="icon-text">Schermvullend</span>
            </div>
            <span style="display: inline-block; width: 10px;"></span>`,document.getElementById("ribbon").innerHTML=`<div id="left-icons">${e}</div><div id="right-icons">${t}</div>`,document.getElementById("id_sitplanpage").onchange=s=>{this.contextMenu.hide();const a=s.target;this.selectPage(Number(a.value)),globalThis.undostruct.store("changePage")},document.getElementById("btn_sitplan_addpage").onclick=()=>{this.contextMenu.hide(),this.sitplan.numPages++,this.selectPage(this.sitplan.numPages),globalThis.undostruct.store()},document.getElementById("btn_sitplan_delpage").onclick=()=>{this.contextMenu.hide(),new dt("Pagina verwijderen",`Pagina ${this.sitplan.activePage} volledig verwijderen?`,[{text:"OK",callback:(()=>{this.wipePage(this.sitplan.activePage),this.sitplan.elements.forEach(a=>{a.page>this.sitplan.activePage&&a.page--}),this.sitplan.numPages>1&&this.sitplan.numPages--,this.selectPage(Math.min(this.sitplan.activePage,this.sitplan.numPages)),globalThis.undostruct.store()}).bind(this)},{text:"Annuleren",callback:()=>{}}]).show()},this.attachAddElementFromFileButton(document.getElementById("button_Add"),document.getElementById("fileInput")),this.attachAddElectroItemButton(document.getElementById("button_Add_electroItem")),this.attachAddCustomItemButton(document.getElementById("button_Add_customItem")),this.event_manager.addEventListener(document.getElementById("button_Add_distanceLine"),"click",()=>{this.contextMenu.hide(),this.startAddDistanceLine()}),this.attachDeleteButton(document.getElementById("button_Delete")),this.attachEditButton(document.getElementById("button_edit")),this.attachSendToBackButton(document.getElementById("sendBack")),this.attachBringToFrontButton(document.getElementById("bringFront")),this.attachZoomButton(document.getElementById("button_zoomin"),.1),this.attachZoomButton(document.getElementById("button_zoomout"),-.1),this.attachZoomToFitButton(document.getElementById("button_zoomToFit"))}}function Ns(){if(globalThis.toggleAppView("draw"),globalThis.structure.sitplan||(globalThis.structure.sitplan=new Mt),globalThis.structure.sitplanview||(document.querySelectorAll('[id^="SP_"]').forEach(t=>t.remove()),globalThis.structure.sitplanview=new Za(document.getElementById("canvas"),document.getElementById("paper"),globalThis.structure.sitplan),globalThis.structure.sitplanview.zoomToFit()),globalThis.structure.properties.legacySchakelaars==null)if(globalThis.structure.sitplan.heeftEenzameSchakelaars()){new Ja().show().then(()=>{globalThis.structure.sitplanview.redraw()});return}else globalThis.structure.properties.legacySchakelaars=!1;globalThis.structure.sitplanview.redraw(),new Pe(globalThis.appDocStorage).show("sitplan.introductie",`<h3>Situatieschema tekenen</h3>
    <p>Op deze pagina kan u een situatieschema tekenen.</p>
    <p>Laad een plattegrond met de knop "Uit bestand" en voeg symbolen toe met de knop "Uit schema".</p>
    <p>Klik <a href="Documentation/sitplandoc.pdf" target="_blank" rel="noopener noreferrer">hier</a> om in een nieuw venster de documentatie te bekijken.</p>
    <p>We werken elke dag om dit programma beter te maken. Opmerkingen en ideeën zijn welkom in het "contact"-formulier.</p>`)}function Xa(i,e,t,s,a="eendraadschema_print.pdf",r,n){const o=f=>{r&&(r.innerHTML=f)},c=f=>{try{let m=f;m=m.replace(/<svg\b(?![^>]*\bxmlns=)/,'<svg xmlns="http://www.w3.org/2000/svg"'),m=m.replace(/<(\/?)\s*([A-Za-z_][\w.-]*):([\w.-]+)/g,"<$1$3"),m=m.replace(/\b(?!xmlns:)([A-Za-z_][\w.-]*):([\w.-]+)=/g,"$2=");const w=new DOMParser().parseFromString(m,"image/svg+xml"),P=w.querySelector("svg");if(!P)return m;P.getAttribute("xmlns")||P.setAttribute("xmlns","http://www.w3.org/2000/svg"),P.getAttribute("xmlns:xlink")||P.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");for(const S of Array.from(w.querySelectorAll("svg")))S.getAttribute("xmlns")||S.setAttribute("xmlns","http://www.w3.org/2000/svg");const A="http://www.w3.org/1999/xlink";for(const S of Array.from(w.querySelectorAll("image"))){const N=S.getAttribute("href");N&&!S.getAttribute("xlink:href")&&S.setAttributeNS(A,"xlink:href",N)}return new XMLSerializer().serializeToString(P)}catch(m){return f}};let l;e.papersize==="A3"?l={paperwidth:420,paperheight:297,paper_margin:10,svg_padding:5,drawnby_box_height:5,owner_box_height:30,owner_box_width:80}:l={paperwidth:297,paperheight:210,paper_margin:10,svg_padding:5,drawnby_box_height:5,owner_box_height:30,owner_box_width:80};let d;const h=e.pages.length+n.numpages;d=Array(h).fill(null);const p=s.split(",").map(f=>f.trim());for(const f of p)if(f.includes("-")){const[m,x]=f.split("-").map(Number);if(!isNaN(m)&&!isNaN(x))for(let w=m;w<=x;w++)w>=1&&w<=h&&(d[w-1]=w)}else{const m=Number(f);!isNaN(m)&&m>=1&&m<=h&&(d[m-1]=m)}function u(f,m,x,w){const P=l.paperheight-2*l.paper_margin-l.owner_box_height-l.drawnby_box_height-l.svg_padding,A=l.paperwidth-2*l.paper_margin,S=t.dpi||300,N=P/25.4*S,W=A/25.4*S,M=Math.min(N/x,W/m);let L;if(f.replace(/^\s+/,"").startsWith("<svg"))try{const $=new DOMParser().parseFromString(f,"image/svg+xml").querySelector("svg");$?($.setAttribute("xmlns",$.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),$.setAttribute("width",String(m*M)),$.setAttribute("height",String(x*M)),$.getAttribute("viewBox")||$.setAttribute("viewBox",`0 0 ${m} ${x}`),L=new XMLSerializer().serializeToString($)):L=`<svg width="${m*M}" height="${x*M}" viewBox="0 0 ${m} ${x}" xmlns="http://www.w3.org/2000/svg">`+f+"</svg>"}catch(G){L=`<svg width="${m*M}" height="${x*M}" viewBox="0 0 ${m} ${x}" xmlns="http://www.w3.org/2000/svg">`+f+"</svg>"}else L=`<svg width="${m*M}" height="${x*M}" viewBox="0 0 ${m} ${x}" xmlns="http://www.w3.org/2000/svg">`+f+"</svg>";L=c(L);let C,q=!1;if(L.length>5e5){const G=new Blob([L],{type:"image/svg+xml;charset=utf-8"});C=URL.createObjectURL(G),q=!0}else C="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(L);const K=new Image;K.crossOrigin="anonymous";let O=!1;const Z=G=>{O||(O=!0,w(G,M))},Y=window.setTimeout(()=>Z(null),3e4);K.onload=function(){window.clearTimeout(Y);const G=document.createElement("canvas");G.width=K.width,G.height=K.height,G.crossOrigin="anonymous";const R=G.getContext("2d");if(!R){G.remove(),Z(null);return}R.drawImage(K,0,0);try{const $=G.toDataURL("image/png");Z($)}catch($){K.complete?alert("Er is een element in het (situatie)schema dat verwijst naar een andere website en dit veroorzaakt een security-error (CORS) in deze browser. Hierdoor kan die pagina niet in de PDF worden opgenomen als afbeelding."):alert("Het genereren van de PDF is vastgelopen bij het omzetten van SVG naar PNG."),Z(null)}finally{q&&C.startsWith("blob:")&&URL.revokeObjectURL(C),G.remove()}},K.onerror=function(){window.clearTimeout(Y),q&&C.startsWith("blob:")&&URL.revokeObjectURL(C),Z(null)},K.src=C}function g(f,m){function x(A){const S=document.createElement("div");return S.innerHTML=A,S.textContent||S.innerText||""}let w=[];m=m.replace(/<div>/g,"");let P=m.split(/<br>|<\/div>/).map(x);for(let A of P){let S=f.splitTextToSize(A,l.owner_box_width-4-3);w=w.concat(S)}return w}function b(){const{jsPDF:f}=window.jspdf;let m;return e.papersize==="A3"?m=new f("landscape","mm","a3",!0):m=new f("landscape","mm","a4",!0),m}function _(f,m,x,w,P,A=0){u(m,x,w,function(S,N){let W=l.paperwidth-2*l.paper_margin,M=l.paperheight-2*l.paper_margin-l.owner_box_height-l.drawnby_box_height-l.svg_padding;if(S&&x*w>0)try{if(x/w>W/M){let G=(l.paperheight-2*l.paper_margin-l.owner_box_height-l.drawnby_box_height-l.svg_padding-w/x*W)/2;f.addImage(S,"PNG",l.paper_margin,l.paper_margin+G,W,w/x*W,void 0,"FAST")}else f.addImage(S,"PNG",l.paper_margin,l.paper_margin,x/w*M,M,void 0,"FAST")}catch(Y){}f.setProperties({title:"Eendraadschema.pdf",subject:"Eendraadschema",author:"eendraadschema.goethals-jacobs.be",keywords:"eendraadschema, online",creator:"eendraadschema.goethals-jacobs.be"});let L=l.paperwidth-(297-l.paper_margin);f.rect(L,l.paperheight-l.paper_margin-l.drawnby_box_height,3*l.owner_box_width,l.drawnby_box_height),f.rect(L,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height,l.owner_box_width,l.owner_box_height),f.rect(L+l.owner_box_width,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height,l.owner_box_width,l.owner_box_height),f.rect(L+2*l.owner_box_width,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height,l.owner_box_width,l.owner_box_height),f.rect(L+3*l.owner_box_width,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height,l.paperwidth-l.paper_margin-L-3*l.owner_box_width,l.drawnby_box_height+l.owner_box_height);const j=8,C=j*.352778;f.setFont("helvetica","bold"),f.setFontSize(j),f.text("Getekend met https://eendraadschema.goethals-jacobs.be",L+2,l.paperheight-l.paper_margin-(l.drawnby_box_height-C)/2-C/6);let q=A+1,K=e.pages.length+n.numpages;f.text("pagina. "+q+"/"+K,L+3*l.owner_box_width+2,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height-C/6+C+1.5);let O=A<e.pages.length?"Eendraadschema":"Situatieschema";f.text(O,L+3*l.owner_box_width+2,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height-C/6+C*(1+1.2)+1.5),f.text(g(f,"Erkend Organisme"),L+2,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height-C/6+C+1.5),f.text(g(f,"Plaats van de elektrische installatie"),L+l.owner_box_width+2,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height-C/6+C+1.5),f.text(g(f,"Installateur"),L+2*l.owner_box_width+2,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height-C/6+C+1.5),f.setFont("helvetica","normal"),f.text(g(f,t.control).slice(0,8),L+2+3,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height-C/6+C*(1+1.2)+1.5),f.text(g(f,t.owner).slice(0,8),L+l.owner_box_width+2+3,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height-C/6+C*(1+1.2)+1.5),f.text(g(f,t.installer).slice(0,8),L+2*l.owner_box_width+2+3,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height-C/6+C*(1+1.2)+1.5);let te=(A<e.pages.length?e.pages[A].info||t.info||"":t.info||"").replace("https://www.eendraadschema.goethals-jacobs.be","eendraadschema");f.text(g(f,te).slice(0,8),L+3*l.owner_box_width+2+3,l.paperheight-l.paper_margin-l.drawnby_box_height-l.owner_box_height-C/6+C*(1+3*1.2)+1.5),P(f,A+1)})}function v(f,m){let x=e.pages[m].start,w=e.pages[m].stop-x,P=e.starty,A=e.stopy-P,S=`${x} ${P} ${w} ${A}`;return`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" transform="scale(1,1)" style="border:1px solid white" height="${A}" width="${w}" viewBox="${S}">`+f+"</svg>"}function T(f,m=0){let x=!1,w=d.findIndex(P=>P!==null);if(m===w&&(x=!0),m<e.pages.length)if(d[m]==null)T(f,m+1);else{o("Pagina "+d[m]+" wordt gegenereerd. Even geduld.."),x||f.addPage();let P=e.pages[d[m]-1].stop-e.pages[d[m]-1].start,A=e.stopy-e.starty;_(f,v(i,d[m]-1),P,A,T,m)}else if(m<d.length)if(d[m]==null)T(f,m+1);else{o("Pagina "+(m+1)+" wordt gegenereerd. Even geduld.."),x||f.addPage();let P=n.pages[m-e.pages.length];_(f,P.svg,P.sizex,P.sizey,T,m)}else U(f)}function U(f){try{const m=f.output("blob"),x=URL.createObjectURL(m);try{const w=document.createElement("a");w.href=x,w.download=a,w.rel="noopener",w.style.display="none",document.body.appendChild(w),w.click(),w.remove()}catch(w){}o('PDF is klaar. Indien de download niet start: <a href="'+x+'" download="'+a.replace(/"/g,"&quot;")+'">klik hier om te downloaden</a>.'),setTimeout(()=>URL.revokeObjectURL(x),120*1e3)}catch(m){f.save(a),o("PDF is klaar. Kijk in uw Downloads folder indien deze niet spontaan wordt geopend.")}}o("PDF wordt gegenereerd. Even geduld..");let E=b();T(E,0)}globalThis.HLDisplayPage=()=>{globalThis.structure.print_table.displaypage=parseInt(document.getElementById("id_select_page").value)-1,fe()};globalThis.dosvgdownload=()=>{const i=document.getElementById("printsvgarea");let e;if(i==null)return;let t=i.innerHTML;document.getElementById("dosvgname")==null?e="eendraadschema.svg":e=document.getElementById("dosvgname").value,Hs(t,e,"data:image/svg+xml;charset=utf-8")};function Ya(i,e=globalThis.structure.print_table.displaypage){var t=1,s=globalThis.structure.print_table.pages[e].start,a=globalThis.structure.print_table.pages[e].stop-s,r=globalThis.structure.print_table.getstarty(),n=globalThis.structure.print_table.getstopy()-r,o=""+s+" "+r+" "+a+" "+n,c='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" transform="scale(1,1)" style="border:1px solid white" height="'+n*t+'" width="'+a*t+'" viewBox="'+o+'">'+Pt(i.data)+"</svg>";return c}function fe(){function i(){typeof globalThis.structure.properties.dpi=="undefined"&&(globalThis.structure.properties.dpi=300);let h=Pt(globalThis.structure.toSVG(0,"horizontal").data);const p=globalThis.structure.print_table.pages.length+(globalThis.structure.sitplan?globalThis.structure.sitplan.getNumPages():0),u=document.getElementById("print_page_mode"),g=document.getElementById("print_page_range");if(!globalThis.structure.print_table.canPrint()){u.value="all",g.value="",g.style.display="none";let v=document.getElementById("print_range_error");v&&(v.style.display="none")}let b="1-"+p;u&&u.value==="custom"&&g&&g.value.trim()!==""&&(b=g.value.trim());const _=globalThis.structure.sitplan?globalThis.structure.sitplan.toSitPlanPrint():{numpages:0,pages:[]};if(globalThis.structure.print_table.enableAutopage){const v=globalThis.structure.properties.info;for(let T of globalThis.structure.print_table.pages)T.info=v}Xa(h,globalThis.structure.print_table,globalThis.structure.properties,b,document.getElementById("dopdfname").value,document.getElementById("progress_pdf"),_)}function e(h){const p=document.getElementById("printarea");p!=null&&(p.innerHTML='<div id="printsvgarea">'+Ya(h)+"</div>")}function t(h){const p=globalThis.structure.sitplan.toSitPlanPrint(),u=document.getElementById("printarea");u!=null&&(u.innerHTML='<div id="printsvgarea">'+p.pages[h].svg+"</div>")}var s=new H;s=globalThis.structure.toSVG(0,"horizontal");var a=s.yup+s.ydown,r=s.xleft+s.xright;globalThis.structure.print_table.setHeight(a),globalThis.structure.print_table.setMaxWidth(r+10);let n="";var o="";const c=document.getElementById("configsection");c!=null&&(c.innerHTML='<div><button id="button_pdfdownload">Genereer PDF</button>&nbsp;<span id="select_papersize"></span>&nbsp;<span id="select_dpi"></span>&nbsp;<input id="dopdfname" size="20" value="eendraadschema_print.pdf">&nbsp;<span id="progress_pdf"></span></div><div id="select_page_range"></div>');const l=document.getElementById("button_pdfdownload");l!=null&&(l.onclick=i),globalThis.structure.print_table.insertHTMLselectPaperSize(document.getElementById("select_papersize"),fe),globalThis.structure.print_table.insertHTMLselectdpi(document.getElementById("select_dpi"),fe),globalThis.structure.print_table.insertHTMLselectPageRange(document.getElementById("select_page_range"),fe),n='<div><span style="margin-right: 2em" id="check_autopage"></span><span style="margin-right: 2em" id="id_verticals"></span><span id="id_suggest_xpos_button"></span></div>',c!=null&&c.insertAdjacentHTML("beforeend",n),globalThis.structure.print_table.insertHTMLcheckAutopage(document.getElementById("check_autopage"),fe),globalThis.structure.print_table.enableAutopage||(globalThis.structure.print_table.insertHTMLchooseVerticals(document.getElementById("id_verticals"),fe),globalThis.structure.print_table.insertHTMLsuggestXposButton(document.getElementById("id_suggest_xpos_button"),fe)),globalThis.structure.print_table.enableAutopage||(n=`<br><table border="0"><tr><td style="vertical-align:top;"><div id="id_print_table"></div></td><td style="vertical-align:top;padding:5px"><div>Klik op de groene pijl om het schema over meerdere pagina's te printen en kies voor elke pagina de start- en stop-positie in het schema (in pixels).</div><div>Je kan eventueel ook de tekst (info) aanpassen die op elke pagina rechts onderaan komt te staan.</div><div>Onderaan kan je bekijken welk deel van het schema op welke pagina belandt.</div></td></tr></table><br>`,c!=null&&c.insertAdjacentHTML("beforeend",n),globalThis.structure.print_table.insertHTMLposxTable(document.getElementById("id_print_table"),fe)),o+="<hr>";const d=globalThis.structure.print_table.pages.length+(globalThis.structure.sitplan?globalThis.structure.sitplan.getNumPages():0);globalThis.structure.print_table.displaypage>=d&&(globalThis.structure.print_table.displaypage=d-1),o+='<b>Printvoorbeeld: </b>Pagina <select onchange="HLDisplayPage()" id="id_select_page">';for(let h=0;h<d;h++)h==globalThis.structure.print_table.displaypage?o+="<option value="+(h+1)+" selected>"+(h+1)+"</option>":o+="<option value="+(h+1)+">"+(h+1)+"</option>";o+='</select>&nbsp;&nbsp;(Enkel tekening, kies "Genereer PDF" om ook de tekstuele gegevens te zien)',o+="<br><br>",o+='<table border="0"><tr><td style="vertical-align:top"><button onclick="dosvgdownload()">Zichtbare pagina als SVG opslaan</button></td><td>&nbsp;</td><td style="vertical-align:top"><input id="dosvgname" size="20" value="eendraadschema_print.svg"></td><td>&nbsp;&nbsp;</td><td>Sla tekening hieronder op als SVG en converteer met een ander programma naar PDF (bvb Inkscape).</td></tr></table><br>',o+=globalThis.displayButtonPrintToPdf(),o+='<div id="printarea"></div>',c!=null&&c.insertAdjacentHTML("beforeend",o),globalThis.structure.print_table.displaypage<globalThis.structure.print_table.pages.length?e(s):t(globalThis.structure.print_table.displaypage-globalThis.structure.print_table.pages.length),globalThis.toggleAppView("config")}var Qa=`<html>
  <head>
    <title>Eendraadschema online</title>
    <link rel="stylesheet" href="css/about.css" style="text/css" />
  </head>
  <body>
    <h2>Een &eacute;&eacute;ndraadschema tekenen.</h2>
    <p class="ondertitel">Een cr&eacute;atie van <a target="_blank" href="https://ivan.goethals-jacobs.be">Ivan Goethals</a></p>
    <p>Dit is een standalone versie (development) waarbij enkele functionaliteiten zijn uitgeschakeld.</p>
    <p>Gebruik de online versie op <a href="https://eendraadschema.goethals-jacobs.be">https://eendraadschema.goethals-jacobs.be</a> om toegang te krijgen tot het contactformulier.</p>
    <p>Kies <b>Bewerken</b> in het menu om verder te gaan met tekenen.</p>
  </body>
</html>`;function er(){return'<br><h2>Expert ontwikkel opties, Gebruik enkel indien u weet wat u doet.</h2><textarea id="HL_loadfromtext" style="width: 80%; height: 8em;"></textarea><br><button onclick="loadFileFromText()">Load from input</button>'}globalThis.loadFileFromText=()=>{let i=document.getElementById("HL_loadfromtext").value;ne(i),globalThis.fileAPIobj.clear()};globalThis.displayButtonPrintToPdf=()=>"";globalThis.handleButtonPrintToPdf=()=>0;globalThis.propUpload=i=>0;class pt{run(){}}function tr(){let i=`
    <table border="1px" style="border-collapse:collapse" align="center" width="100%">
      <tr>
        <td width="100%" align="center" bgcolor="LightGrey">
          <b>Handleiding</b>
        </td>
      </tr>
      <tr>
        <td width="100%" align="left">
            <table border=0>
              <tr>
                <td width=100 style="vertical-align:top;padding:5px">
                  <button style="font-size:14px" id="Btn_downloadManual">Eéndraadschema</button>
                </td>
                <td style="vertical-align:top;padding:7px">
                  Een volledige handleiding is beschikbaar in PDF formaat.
                  Klik links om deze in een ander venster te openen.
                  <br>
                  Het programma is in volle ontwikkeling dus delen van de handleiding zijn
                  mogelijk ietwat verouderd.  
                </td>
              </tr>
              <tr>
                <td width=100 style="vertical-align:top;padding:5px">
                  <button style="font-size:14px" id="Btn_downloadSitPlanManual">Situatieschema</button>
                </td>
                <td style="vertical-align:top;padding:7px">
                  Specifiek voor het werken met het situatieschema werd een ander korter document opgesteld.
                  Klik link om deze in een ander venster te openen.
                </td>
              </tr>
            </table>
        </td>
      </tr>
    </table>`;const e=document.getElementById("configsection");e!=null&&(e.innerHTML=i),globalThis.toggleAppView("config"),document.getElementById("Btn_downloadManual").onclick=()=>{window.open("Documentation/edsdoc.pdf","_blank")},document.getElementById("Btn_downloadSitPlanManual").onclick=()=>{window.open("Documentation/sitplandoc.pdf","_blank")}}class sr{constructor(){this.sessionKey="SessionJS",this.newUser=!1;const e=localStorage.getItem(this.sessionKey);e?this.sessionId=e:(this.sessionId=this.generateRandomBase64String(22),localStorage.setItem(this.sessionKey,this.sessionId),this.newUser=!0)}generateRandomBase64String(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";let s="";const a=t.length;for(let r=0;r<e;r++){const n=Math.floor(Math.random()*a);s+=t[n]}return s}getSessionId(){return this.sessionId}isNewUser(){return this.newUser}}class ir{constructor(e,t){this.storageKey=e,this.data=this.loadFromStorage()||Be(t),this.memoryData=Be(t)}loadFromStorage(){const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):null}saveToStorage(){localStorage.setItem(this.storageKey,JSON.stringify(this.data))}get(e){const t=e.split(".");let s=this.memoryData;for(const a of t)if(s&&typeof s=="object"&&a in s)s=s[a];else{s=void 0;break}if(s!==void 0)return s;s=this.data;for(const a of t)if(s&&typeof s=="object"&&a in s)s=s[a];else return;return s}set(e,t,s=!1){const a=e.split(".");let r=s?this.memoryData:this.data;for(let n=0;n<a.length-1;n++){const o=a[n];(!r[o]||typeof r[o]!="object")&&(r[o]={}),r=r[o]}r[a[a.length-1]]=t,s||this.saveToStorage()}delete(e){const t=e.split(".");let s=this.memoryData;for(let a=0;a<t.length-1;a++){const r=t[a];if(!s[r]||typeof s[r]!="object")break;s=s[r]}delete s[t[t.length-1]],s=this.data;for(let a=0;a<t.length-1;a++){const r=t[a];if(!s[r]||typeof s[r]!="object")return;s=s[r]}delete s[t[t.length-1]],this.saveToStorage()}getAll(){return V(V({},this.data),this.memoryData)}clear(){this.data={},this.memoryData={},localStorage.removeItem(this.storageKey)}}class ss{constructor(e=100){this.maxSteps=e,this.undoStack=[],this.redoStack=[]}store(e,t=!1){t&&this.undoStack.length>0&&this.undoStack.pop(),this.undoStack.length>=this.maxSteps&&this.undoStack.shift(),this.undoStack.push(e),this.redoStack=[]}replace(e){this.undoStack.length>0?this.undoStack[this.undoStack.length-1]=e:this.store(e)}undo(){if(this.undoStack.length<=1)return null;const e=this.undoStack.pop();return this.redoStack.push(e),this.undoStack.length>0?this.undoStack[this.undoStack.length-1]:null}redo(){if(this.redoStack.length===0)return null;let e=this.redoStack.pop();return this.undoStack.push(e),e}clear(){this.undoStack=[],this.redoStack=[]}undoStackSize(){return Math.max(this.undoStack.length-1,0)}redoStackSize(){return Math.max(this.redoStack.length,0)}}class ar{constructor(){this.data=[]}push(e){return this.data.push(e),this.data.length-1}pushIfNotExists(e){let t=this.data.indexOf(e);return t==-1?(this.data.push(e),this.data.length-1):t}get(e){return this.data[e]}clear(){this.data=[]}}class rr{constructor(e=100){this.largeStrings=new ar,this.samenVoegSleutel=null,this.historyEds=new ss(e),this.historyOptions=new ss(e)}replaceSVGsByStringStore(){if(globalThis.structure.sitplan!=null)for(let e of globalThis.structure.sitplan.getElements())e.isEendraadschemaSymbool()||(e.svg=this.largeStrings.pushIfNotExists(e.getUnscaledSVGifNotElectroItem()).toString())}replaceStringStoreBySVGs(){if(globalThis.structure.sitplan!=null)for(let e of globalThis.structure.sitplan.getElements())e.isEendraadschemaSymbool()||(e.svg=this.largeStrings.get(parseInt(e.svg)))}getOptions(){let e={};return globalThis.structure.sitplanview!=null&&(e.selectedBoxesOrdinals=globalThis.structure.sitplanview.getSelectedBoxesOrdinals(),globalThis.structure.sitplanview.sideBar.getUndoRedoOptions!=null&&Object.assign(e,globalThis.structure.sitplanview.sideBar.getUndoRedoOptions())),JSON.stringify(e)}store(e=null){let t=!1;e!=null&&e==this.samenVoegSleutel&&(t=!0),this.samenVoegSleutel=e,this.replaceSVGsByStringStore(),t?(this.historyEds.replace(globalThis.structure.toJsonObject(!1)),this.historyOptions.replace(this.getOptions())):(this.historyEds.store(globalThis.structure.toJsonObject(!1)),this.historyOptions.store(this.getOptions())),this.replaceStringStoreBySVGs(),globalThis.structure.properties.currentView=="draw"&&globalThis.structure.sitplanview!=null?globalThis.structure.sitplanview.updateRibbon():globalThis.structure.properties.currentView=="2col"&&globalThis.structure.updateRibbon()}updateSelectedBoxes(){this.historyOptions.store(this.getOptions(),!0)}reload(e,t){this.samenVoegSleutel=null;let s=globalThis.structure.properties.currentView,a=globalThis.structure.mode;switch(e!=null&&Ms(e,0,!1),this.replaceStringStoreBySVGs(),globalThis.structure.reSort(),globalThis.structure.mode=a,globalThis.structure.properties.currentView!=s&&globalThis.toggleAppView(globalThis.structure.properties.currentView),globalThis.structure.properties.currentView){case"draw":if(globalThis.topMenu.selectMenuItemByOrdinal(3),Ns(),globalThis.structure.sitplanview.sideBar.setUndoRedoOptions!=null&&globalThis.structure.sitplanview.sideBar.setUndoRedoOptions(t),t.selectedBoxesOrdinals==null)break;for(let r of t.selectedBoxesOrdinals){if(globalThis.structure.sitplan.getElements().length<=r)break;let n=globalThis.structure.sitplan.getElements()[r];if(n==null)break;let o=n.id;if(o==null)break;let c=document.getElementById(o);c!=null&&globalThis.structure.sitplanview.selectBox(c)}break;case"2col":globalThis.topMenu.selectMenuItemByOrdinal(2),globalThis.HLRedrawTree();break;case"config":globalThis.topMenu.selectMenuItemByOrdinal(4),fe();break}}undo(){let e=this.historyEds.undo(),t=this.historyOptions.undo(),s=t?JSON.parse(t):{};this.reload(e,s)}redo(){let e=this.historyEds.redo(),t=this.historyOptions.redo(),s=t?JSON.parse(t):{};this.reload(e,s)}clear(){this.samenVoegSleutel=null,this.historyEds.clear(),this.historyOptions.clear(),this.largeStrings.clear(),globalThis.structure.updateRibbon()}undoStackSize(){return this.historyEds.undoStackSize()}redoStackSize(){return this.historyEds.redoStackSize()}}const ut=[{date:"2025-09-18",msg:"Eerste stapjes om symbolen toe te voegen aan het situatieschema die niet in het ééndraadschema zitten."},{date:"2025-08-22",msg:"Aftakdoos kan nu meerdere kinderen bevatten."},{date:"2025-08-19",msg:'Kring en Aansluiting kennen nu ook de bescherming "zekeringscheider".'},{date:"2025-07-29",msg:"Bij handmatig pagineren kan voor iedere pagina van het ééndraadschema een andere info-tekst gekozen worden om rechts onder te tonen bij het afprinten."},{date:"2025-07-28",msg:"Voor elementen op het hoogste niveau kan gekozen worden om tijdens het printen altijd een nieuwe pagina te starten."},{date:"2025-07-20",msg:'Micro-omvormer optie toegevoegd. Voor omvormers met maximaal één aansluiting kan nu "micro" worden aangevinkt, wat resulteert in een dunnere lijndikte in het schema.'},{date:"2025-07-20",msg:"Mogelijkheid om slechts bepaalde pagina's af te drukken uit het schema."},{date:"2025-07-07",msg:"Symbool voor afzuigkap (in Ventilator) en aarding (in Zeldzame symbolen)."},{date:"2025-07-05",msg:"Verbeteringen en meer mogelijkheden aan het contact/contactor symbool (binnen Kring, of Schakelaars)."},{date:"2025-07-01",msg:"Automatische nummering en automatische naamgeving voor kringen."},{date:"2025-06-26",msg:"De elecktriciteitsmeter van een aansluiting kan nu ook in het situatieschema worden toegevoegd."},{date:"2025-06-24",msg:"Mogelijkheid om files op te slaan zonder compressie."},{date:"2025-06-21",msg:'Wijzigingen aan het symbool voor "Omvormer". Zowel zonnepanelen als een batterij kunnen nu aan dezelfde omvormer worden gehangen.'},{date:"2025-06-08",msg:"De externe sturing van een domotica gestuurde verbruiker kan nu ook op het situatieplan worden toegevoegd (schakelaar/drukkknop)."},{date:"2025-05-25",msg:'Omvormer kan nu ook "in kring" worden geplaatst indien deze als backup kan dienen.'},{date:"2025-05-19",msg:"Support om meerdere elementen in het situatieschema tegelijkertijd te selecteren (met shift-click) en tegelijkertijd te bewerken."},{date:"2025-05-01",msg:"Automatisch opslaan van schema's in de browsercache (crash of ongewenste browser refresh recovery)."},{date:"2025-04-06",msg:"Bij kringen kan nu ook de fase worden ingesteld (Fase 1, Fase 2, Fase 3)."},{date:"2025-03-01",msg:`Inbouwen functionaliteit om meerdere eendraadschema's samen te voegen op het "Bestand"-scherm.`},{date:"2025-03-01",msg:"Mogelijkheid tot vergrendelen van symbolen in het situatieschema (Ctrl L)."},{date:"2025-02-28",msg:"Borden kunnen nu ook worden toegevoegd aan het situatieschema."},{date:"2025-02-16",msg:"Toevoegen sidebar in het situatieschema om makkelijker symbooltjes toe te voegen."}],Os="eds.theme",Vs="eds-theme-changed";function Ds(i){return i==="light"||i==="dark"}function is(){return typeof window=="undefined"||typeof window.matchMedia!="function"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function as(){try{const i=localStorage.getItem(Os);return Ds(i)?i:null}catch(i){return null}}function nr(i){try{window.dispatchEvent(new CustomEvent(Vs,{detail:i}))}catch(e){}}function or(){return document.documentElement.dataset.theme==="dark"?"dark":"light"}function Xe(i,e){var s;const t=(s=e==null?void 0:e.persist)!=null?s:!0;if(document.documentElement.dataset.theme=i,document.documentElement.style.colorScheme=i,t)try{localStorage.setItem(Os,i)}catch(a){}nr(i)}function lr(){const e=or()==="dark"?"light":"dark";Xe(e,{persist:!0})}function cr(){const i=as();if(i?Xe(i,{persist:!1}):Xe(is(),{persist:!1}),typeof window.matchMedia=="function"){const e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>{as()||Xe(is(),{persist:!1})};typeof e.addEventListener=="function"?e.addEventListener("change",t):typeof e.addListener=="function"&&e.addListener(t)}}function dr(i){window.addEventListener(Vs,e=>{const s=e.detail;Ds(s)&&i(s)})}function hr(i){return i?{Authorization:`Bearer ${i}`}:{}}function Kt(i){if(!i)return"";try{return new Date(i).toLocaleString()}catch(e){return i}}function pr(i){return`${window.location.href.split("#")[0]}#share=${encodeURIComponent(i)}`}function Ue(i){var e,t;try{const s=(t=(e=globalThis.appDocStorage)==null?void 0:e.get)==null?void 0:t.call(e,`shareNames.${i}`);return s?String(s):""}catch(s){return""}}function ur(i,e){var t,s,a,r;try{const n=String(e||"").trim();n?(r=(a=globalThis.appDocStorage)==null?void 0:a.set)==null||r.call(a,`shareNames.${i}`,n):(s=(t=globalThis.appDocStorage)==null?void 0:t.delete)==null||s.call(t,`shareNames.${i}`)}catch(n){}}async function $s(i){try{return await navigator.clipboard.writeText(i),!0}catch(e){return prompt("Kopieer deze tekst:",i),!1}}function gr(i){const e=document.getElementById("configsection");if(!e)throw new Error("configsection not found");e.innerHTML=i,globalThis.toggleAppView("config")}async function fr(){if(!D.isEnabled())return alert("Beheer vereist OIDC login, maar OIDC is niet geconfigureerd."),null;const i=await D.getAccessToken();return i||(confirm("Aanmelden is nodig om shares/teams te beheren. Nu aanmelden?")&&await D.login(),null)}function mr(i){return`
<table border="1px" style="border-collapse:collapse" align="center" width="100%">
  <tr>
    <td width="100%" align="center" bgcolor="LightGrey">
      <b>Beheer - Delen & Teams</b>
    </td>
  </tr>
  <tr>
    <td width="100%" align="left" style="padding:10px">
      <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
        <span><b>Ingelogd als:</b> <span id="stm_profile">${i}</span></span>
        <button type="button" style="font-size:14px" id="stm_back">Terug</button>
        <button type="button" style="font-size:14px" id="stm_copy_current">Kopieer deel-link (huidig schema)</button>
      </div>
      <div style="margin-top:8px" class="highlight-warning" id="stm_global_status" hidden></div>
    </td>
  </tr>
</table>
<br>

<table border="1px" style="border-collapse:collapse" align="center" width="100%">
  <tr>
    <td width="100%" align="center" bgcolor="LightGrey"><b>Mijn shares</b></td>
  </tr>
  <tr>
    <td width="100%" align="left" style="padding:10px">
      <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
        <button type="button" style="font-size:14px" id="stm_refresh_shares">Vernieuwen</button>
        <span id="stm_shares_status"></span>
      </div>
      <div style="overflow:auto; margin-top:10px">
        <table border="1px" style="border-collapse:collapse" width="100%">
          <thead>
            <tr bgcolor="LightGrey">
                            <th align="left">Naam</th>
              <th align="left">Team</th>
              <th align="left">Aangepast</th>
              <th align="left">Acties</th>
            </tr>
          </thead>
          <tbody id="stm_shares_body"></tbody>
        </table>
      </div>
    </td>
  </tr>
</table>
<br>

<table border="1px" style="border-collapse:collapse" align="center" width="100%">
  <tr>
    <td width="100%" align="center" bgcolor="LightGrey"><b>Teams</b></td>
  </tr>
  <tr>
    <td width="100%" align="left" style="padding:10px">
      <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
        <button type="button" style="font-size:14px" id="stm_refresh_teams">Vernieuwen</button>
        <span id="stm_teams_status"></span>
      </div>

      <div style="margin-top:10px; display:flex; gap:20px; flex-wrap:wrap; align-items:flex-start;">
        <div style="min-width:320px; flex:1;">
          <b>Mijn teams</b>
          <div style="overflow:auto; margin-top:8px">
            <table border="1px" style="border-collapse:collapse" width="100%">
              <thead>
                <tr bgcolor="LightGrey">
                  <th align="left">Team ID</th>
                  <th align="left">Naam</th>
                  <th align="left">Rol</th>
                </tr>
              </thead>
              <tbody id="stm_teams_body"></tbody>
            </table>
          </div>
        </div>

        <div style="min-width:320px; flex:1;">
          <b>Team aanmaken</b>
          <div style="margin-top:8px; display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
            <input type="text" id="stm_new_team_name" placeholder="Team naam" style="min-width:220px" />
            <button type="button" style="font-size:14px" id="stm_create_team">Aanmaken</button>
          </div>
          <div id="stm_create_team_status" style="margin-top:6px"></div>

          <hr style="margin:12px 0" />

          <b>Invite maken (owner)</b>
          <div style="margin-top:8px; display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
            <input type="text" id="stm_invite_team_id" placeholder="Team ID" style="min-width:220px" />
            <input type="text" id="stm_invite_email" placeholder="Email (optioneel)" style="min-width:220px" />
            <button type="button" style="font-size:14px" id="stm_create_invite">Maak invite</button>
          </div>
          <div style="margin-top:8px; display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
            <input type="text" id="stm_invite_token" placeholder="Invite token" style="min-width:260px" readonly />
            <button type="button" style="font-size:14px" id="stm_copy_invite">Kopieer</button>
          </div>
          <div id="stm_invite_status" style="margin-top:6px"></div>

          <hr style="margin:12px 0" />

          <b>Invite accepteren</b>
          <div style="margin-top:8px; display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
            <input type="text" id="stm_accept_token" placeholder="Invite token" style="min-width:260px" />
            <button type="button" style="font-size:14px" id="stm_accept_invite">Accepteren</button>
          </div>
          <div id="stm_accept_status" style="margin-top:6px"></div>
        </div>
      </div>
    </td>
  </tr>
</table>
<br>

`}async function be(i,e,t){const s=await fetch(i,me(V({},t),{headers:V(V({},(t==null?void 0:t.headers)||{}),hr(e))}));if(!s.ok){const a=await s.text();throw new Error(`${s.status} ${a}`)}return await s.json()}function he(i,e){const t=document.getElementById(i);t&&(t.textContent=e)}function ye(i,e){const t=document.getElementById(i);t&&(t.innerHTML=e)}function Ee(){const i=document.getElementById("stm_share_versions_modal_overlay");i&&i.parentElement&&i.parentElement.removeChild(i)}function rs(){const i=document.getElementById("stm_confirm_modal_overlay");i&&i.parentElement&&i.parentElement.removeChild(i)}async function yr(i){return rs(),await new Promise(e=>{const t=document.createElement("div");t.id="stm_confirm_modal_overlay",t.classList.add("popup-overlay");const s=document.createElement("div");s.classList.add("popup"),s.style.width="min(640px, calc(100vw - 24px))";const a=document.createElement("h3");a.textContent=i.title;const r=document.createElement("div");r.innerHTML=i.messageHtml,r.style.marginTop="8px";const n=document.createElement("div");n.style.display="flex",n.style.gap="10px",n.style.marginTop="14px",n.style.justifyContent="flex-end";const o=document.createElement("button");o.type="button",o.textContent=i.cancelText||"Annuleer";const c=document.createElement("button");c.type="button",c.textContent=i.confirmText||"Bevestig";const l=h=>{window.removeEventListener("keydown",d),rs(),e(h)};o.addEventListener("click",()=>l(!1)),c.addEventListener("click",()=>l(!0));const d=h=>{h.key==="Escape"&&l(!1)};window.addEventListener("keydown",d),t.addEventListener("mousedown",h=>{h.target===t&&l(!1)}),n.appendChild(o),n.appendChild(c),s.appendChild(a),s.appendChild(r),s.appendChild(n),t.appendChild(s),document.body.appendChild(t),t.style.visibility="visible",t.style.pointerEvents="auto",setTimeout(()=>c.focus(),0)})}async function br(i,e){Ee();const t=document.createElement("div");t.id="stm_share_versions_modal_overlay",t.classList.add("popup-overlay");const s=document.createElement("div");s.classList.add("popup"),s.style.width="min(980px, calc(100vw - 24px))",s.style.maxHeight="min(80vh, 720px)",s.style.overflow="auto";const a=document.createElement("h3");a.textContent="Share versies";const r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.gap="10px";const n=document.createElement("div");n.innerHTML=`Share: <code>${i}</code>`;const o=document.createElement("button");o.type="button",o.textContent="Sluiten",o.style.marginLeft="auto",o.addEventListener("click",()=>Ee()),r.appendChild(n),r.appendChild(o);const c=document.createElement("div");c.id="stm_share_versions_status",c.style.marginTop="8px",c.textContent="Laden...";const l=document.createElement("div");l.style.marginTop="10px",s.appendChild(a),s.appendChild(r),s.appendChild(c),s.appendChild(l),t.appendChild(s),document.body.appendChild(t),t.style.visibility="visible",t.style.pointerEvents="auto",t.addEventListener("mousedown",E=>{E.target===t&&Ee()}),window.addEventListener("keydown",function E(f){f.key==="Escape"&&(window.removeEventListener("keydown",E),Ee())});let d=[];try{d=await be(`/api/shares/${encodeURIComponent(i)}/versions`,e,{method:"GET"})}catch(E){c.innerHTML=`<span class="highlight-warning">Fout: ${String((E==null?void 0:E.message)||E)}</span>`;return}if(!Array.isArray(d)||d.length===0){c.textContent="Geen versies";return}c.textContent=`${d.length} versies`;const h=document.createElement("div");h.style.overflow="auto";const p=document.createElement("table");p.setAttribute("border","1px"),p.style.borderCollapse="collapse",p.style.width="100%";const u=document.createElement("thead"),g=document.createElement("tr");g.setAttribute("bgcolor","LightGrey");const b=document.createElement("th");b.align="left",b.textContent="Gemaakt";const _=document.createElement("th");_.align="left",_.textContent="Versie";const v=document.createElement("th");v.align="left",v.textContent="Door";const T=document.createElement("th");T.align="left",T.textContent="Acties",g.appendChild(b),g.appendChild(_),g.appendChild(v),g.appendChild(T),u.appendChild(g);const U=document.createElement("tbody");for(const E of d.slice(0,200)){const f=document.createElement("tr"),m=document.createElement("td");m.textContent=Kt(E.createdAt);const x=document.createElement("td"),w=document.createElement("code");w.textContent=E.id,x.appendChild(w);const P=document.createElement("td");P.textContent=E.createdBySub?String(E.createdBySub):"";const A=document.createElement("td"),S=document.createElement("button");S.type="button",S.style.fontSize="14px",S.textContent="Open",S.addEventListener("click",async()=>{if(confirm("Dit zal je huidige schema vervangen. Doorgaan?"))try{const M=await be(`/api/shares/${encodeURIComponent(i)}/versions/${encodeURIComponent(E.id)}`,e,{method:"GET"});if(!(M!=null&&M.schema)){alert("Versie bevat geen schema.");return}globalThis.currentShareId=i,ne(M.schema,!0,!0),globalThis.fileAPIobj.clear(),Ee(),globalThis.topMenu.selectMenuItemByName("Eéndraadschema")}catch(M){alert(`Kon versie niet openen: ${String((M==null?void 0:M.message)||M)}`)}});const N=document.createElement("button");N.type="button",N.style.fontSize="14px",N.style.marginLeft="8px",N.textContent="Herstel",N.addEventListener("click",async()=>{if(confirm("Herstellen zal de share in de cloud overschrijven. Doorgaan?"))try{await be(`/api/shares/${encodeURIComponent(i)}/versions/${encodeURIComponent(E.id)}/restore`,e,{method:"POST"}),alert("Hersteld."),Ee(),await it(e)}catch(M){alert(`Kon niet herstellen: ${String((M==null?void 0:M.message)||M)}`)}}),A.appendChild(S),A.appendChild(N),f.appendChild(m),f.appendChild(x),f.appendChild(P),f.appendChild(A),U.appendChild(f)}p.appendChild(u),p.appendChild(U),h.appendChild(p),l.appendChild(h)}async function it(i){he("stm_shares_status","Laden...");const e=document.getElementById("stm_shares_body");if(!e)return;e.innerHTML="";let t=[];try{t=await be("/api/shares/mine",i,{method:"GET",headers:{"Content-Type":"application/json"}})}catch(s){he("stm_shares_status",""),alert(`Kon shares niet laden: ${String((s==null?void 0:s.message)||s)}`);return}if(!Array.isArray(t)||t.length===0){he("stm_shares_status","Geen shares");return}he("stm_shares_status",`${t.length} shares`);for(const s of t){const a=document.createElement("tr");a.dataset.shareId=s.id;const r=document.createElement("td");r.textContent=s.teamId?String(s.teamId):"-";const n=document.createElement("td"),o=document.createElement("span");o.textContent=Ue(s.id)||"-",n.appendChild(o);const c=document.createElement("td");c.textContent=Kt(s.updatedAt);const l=document.createElement("td"),d=document.createElement("button");d.type="button",d.style.fontSize="14px",d.textContent="Naam",d.addEventListener("click",async()=>{const b=Ue(s.id),_=prompt("Geef een naam voor deze share (leeg = wissen):",b);_!==null&&(ur(s.id,_),o.textContent=Ue(s.id)||"-")});const h=document.createElement("button");h.type="button",h.style.fontSize="14px",h.style.marginLeft="8px",h.textContent="Versies",h.addEventListener("click",async()=>{const b=await D.getAccessToken();if(!b){alert("Niet ingelogd.");return}await br(s.id,b)});const p=document.createElement("button");p.type="button",p.style.fontSize="14px",p.textContent="Open",p.addEventListener("click",async()=>{if(confirm("Dit zal je huidige schema vervangen. Doorgaan?"))try{const _=await fetch(`/api/shares/${encodeURIComponent(s.id)}`);if(!_.ok){alert(`Kon share niet laden: ${_.status} ${await _.text()}`);return}const v=await _.json();if(!(v!=null&&v.schema)){alert("Share bevat geen schema.");return}globalThis.currentShareId=s.id,ne(v.schema,!0,!0),globalThis.fileAPIobj.clear(),globalThis.topMenu.selectMenuItemByName("Eéndraadschema")}catch(_){alert(`Kon share niet laden: ${String((_==null?void 0:_.message)||_)}`)}});const u=document.createElement("button");u.type="button",u.style.fontSize="14px",u.style.marginLeft="8px",u.textContent="Kopieer link",u.addEventListener("click",async()=>{const b=pr(s.id);await $s(b)});const g=document.createElement("button");g.type="button",g.style.fontSize="14px",g.style.marginLeft="8px",g.textContent="Verwijder",g.addEventListener("click",async()=>{const b=await D.getAccessToken();if(!b){alert("Niet ingelogd.");return}const _=Ue(s.id);if(await yr({title:"Share verwijderen",messageHtml:`Weet je zeker dat je deze share wilt verwijderen?${_?`<br><br><b>Naam:</b> ${_}`:""}<br><br><b>Opgelet:</b> dit kan niet ongedaan gemaakt worden.`,confirmText:"Verwijder",cancelText:"Annuleer"}))try{g.disabled=!0,await be(`/api/shares/${encodeURIComponent(s.id)}`,b,{method:"DELETE"}),globalThis.currentShareId===s.id&&(globalThis.currentShareId=null),await it(b)}catch(T){alert(`Kon share niet verwijderen: ${String((T==null?void 0:T.message)||T)}`)}finally{g.disabled=!1}}),l.appendChild(d),l.appendChild(h),l.appendChild(p),l.appendChild(u),l.appendChild(g),a.appendChild(n),a.appendChild(r),a.appendChild(c),a.appendChild(l),e.appendChild(a)}}async function Ge(i){he("stm_teams_status","Laden...");const e=document.getElementById("stm_teams_body");if(!e)return[];e.innerHTML="";let t=[];try{t=await be("/api/teams",i,{method:"GET"})}catch(s){return he("stm_teams_status",""),alert(`Kon teams niet laden: ${String((s==null?void 0:s.message)||s)}`),[]}if(!Array.isArray(t)||t.length===0)return he("stm_teams_status","Geen teams"),[];he("stm_teams_status",`${t.length} teams`);for(const s of t){const a=document.createElement("tr"),r=document.createElement("td"),n=document.createElement("code");n.textContent=s.id,r.appendChild(n);const o=document.createElement("td");o.textContent=s.name;const c=document.createElement("td");c.textContent=s.role,a.appendChild(r),a.appendChild(o),a.appendChild(c),e.appendChild(a)}return t}async function kr(){const i=await fr();if(!i)return;const e=await D.getProfile(),t=(e==null?void 0:e.name)||(e==null?void 0:e.email)||(e==null?void 0:e.sub)||"";gr(mr(t));const s=document.getElementById("stm_back");s==null||s.addEventListener("click",()=>{globalThis.topMenu.selectMenuItemByName("Bestand")});const a=document.getElementById("stm_copy_current");a==null||a.addEventListener("click",async()=>{typeof globalThis.copyShareLink=="function"?await globalThis.copyShareLink():alert("copyShareLink is niet beschikbaar.")});const r=document.getElementById("stm_refresh_shares");r==null||r.addEventListener("click",async()=>{const h=await D.getAccessToken();if(!h){alert("Niet ingelogd.");return}await it(h)});const n=document.getElementById("stm_refresh_teams");n==null||n.addEventListener("click",async()=>{const h=await D.getAccessToken();if(!h){alert("Niet ingelogd.");return}await Ge(h)});const o=document.getElementById("stm_create_team");o==null||o.addEventListener("click",async()=>{const h=await D.getAccessToken();if(!h){alert("Niet ingelogd.");return}const p=document.getElementById("stm_new_team_name"),u=((p==null?void 0:p.value)||"").trim();if(!u){ye("stm_create_team_status",'<span class="highlight-warning">Naam is verplicht.</span>');return}he("stm_create_team_status","Bezig...");try{const g=await be("/api/teams",h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:u})});p&&(p.value=""),ye("stm_create_team_status",`Team aangemaakt: <code>${g.id}</code> (${g.name})`),await Ge(h)}catch(g){ye("stm_create_team_status",`<span class="highlight-warning">Fout: ${String((g==null?void 0:g.message)||g)}</span>`)}});const c=document.getElementById("stm_create_invite");c==null||c.addEventListener("click",async()=>{var b,_;const h=await D.getAccessToken();if(!h){alert("Niet ingelogd.");return}const p=(((b=document.getElementById("stm_invite_team_id"))==null?void 0:b.value)||"").trim(),u=(((_=document.getElementById("stm_invite_email"))==null?void 0:_.value)||"").trim(),g=document.getElementById("stm_invite_token");if(!p){ye("stm_invite_status",'<span class="highlight-warning">Team ID is verplicht.</span>');return}he("stm_invite_status","Bezig..."),g&&(g.value="");try{const v=await be(`/api/teams/${encodeURIComponent(p)}/invites`,h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u||""})});g&&(g.value=v.token),ye("stm_invite_status",`Invite gemaakt (vervalt ${Kt(v.expiresAt)}).`)}catch(v){ye("stm_invite_status",`<span class="highlight-warning">Fout: ${String((v==null?void 0:v.message)||v)}</span>`)}});const l=document.getElementById("stm_copy_invite");l==null||l.addEventListener("click",async()=>{const h=document.getElementById("stm_invite_token"),p=((h==null?void 0:h.value)||"").trim();p&&await $s(p)});const d=document.getElementById("stm_accept_invite");d==null||d.addEventListener("click",async()=>{var u;const h=await D.getAccessToken();if(!h){alert("Niet ingelogd.");return}const p=(((u=document.getElementById("stm_accept_token"))==null?void 0:u.value)||"").trim();if(!p){ye("stm_accept_status",'<span class="highlight-warning">Token is verplicht.</span>');return}he("stm_accept_status","Bezig...");try{const g=await be("/api/invites/accept",h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:p})});ye("stm_accept_status",`Toegevoegd aan team: <code>${g.teamId}</code>`),await Ge(h)}catch(g){ye("stm_accept_status",`<span class="highlight-warning">Fout: ${String((g==null?void 0:g.message)||g)}</span>`)}}),await it(i),await Ge(i)}function xr(i){return i?{Authorization:`Bearer ${i}`}:{}}function wr(i){const e=document.getElementById("configsection");if(!e)throw new Error("configsection not found");e.innerHTML=i,globalThis.toggleAppView("config")}function He(i,e){const t=document.getElementById(i);t&&(t.textContent=e)}function js(i,e){const t=document.getElementById(i);t&&(t.innerHTML=e)}function Rs(i){if(!i)return"";try{return new Date(i).toLocaleString()}catch(e){return i}}function vr(i){return`${window.location.href.split("#")[0]}#share=${encodeURIComponent(i)}`}async function _r(i){try{await navigator.clipboard.writeText(i)}catch(e){prompt("Kopieer deze tekst:",i)}}async function Tr(){if(!D.isEnabled())return alert("Admin vereist OIDC login, maar OIDC is niet geconfigureerd."),null;const i=await D.getAccessToken();return i||(confirm("Aanmelden is nodig voor admin. Nu aanmelden?")&&await D.login(),null)}async function $e(i,e,t){const s=await fetch(i,me(V({},t),{headers:V(V({},(t==null?void 0:t.headers)||{}),xr(e))}));if(!s.ok){const a=await s.text();throw new Error(`${s.status} ${a||s.statusText}`)}return await s.json()}function Sr(i){return`
<table border="1px" style="border-collapse:collapse" align="center" width="100%">
  <tr>
    <td width="100%" align="center" bgcolor="LightGrey"><b>Admin</b></td>
  </tr>
  <tr>
    <td width="100%" align="left" style="padding:10px">
      <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
        <span><b>Ingelogd als:</b> <span id="adm_profile">${i}</span></span>
        <button type="button" style="font-size:14px" id="adm_back">Terug</button>
      </div>
      <div style="margin-top:8px" class="highlight-warning" id="adm_status" hidden></div>
    </td>
  </tr>
</table>
<br>

<table border="1px" style="border-collapse:collapse" align="center" width="100%">
  <tr>
    <td width="100%" align="center" bgcolor="LightGrey"><b>Users</b></td>
  </tr>
  <tr>
    <td width="100%" align="left" style="padding:10px">
      <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
        <button type="button" style="font-size:14px" id="adm_users_refresh">Vernieuwen</button>
        <span id="adm_users_status"></span>
      </div>
      <div style="overflow:auto; margin-top:10px">
        <table border="1px" style="border-collapse:collapse" width="100%">
          <thead>
            <tr bgcolor="LightGrey">
              <th align="left">Sub</th>
              <th align="left">Naam</th>
              <th align="left">Email</th>
              <th align="left">Admin</th>
              <th align="left">Laatste login</th>
              <th align="left">Acties</th>
            </tr>
          </thead>
          <tbody id="adm_users_body"></tbody>
        </table>
      </div>
    </td>
  </tr>
</table>
<br>

<table border="1px" style="border-collapse:collapse" align="center" width="100%">
  <tr>
    <td width="100%" align="center" bgcolor="LightGrey"><b>Alle schemas</b></td>
  </tr>
  <tr>
    <td width="100%" align="left" style="padding:10px">
      <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
        <button type="button" style="font-size:14px" id="adm_shares_refresh">Vernieuwen</button>
        <span id="adm_shares_status"></span>
      </div>
      <div style="overflow:auto; margin-top:10px">
        <table border="1px" style="border-collapse:collapse" width="100%">
          <thead>
            <tr bgcolor="LightGrey">
              <th align="left">Share ID</th>
              <th align="left">Owner</th>
              <th align="left">Team</th>
              <th align="left">Aangepast</th>
              <th align="left">Acties</th>
            </tr>
          </thead>
          <tbody id="adm_shares_body"></tbody>
        </table>
      </div>
    </td>
  </tr>
</table>
`}async function St(i){He("adm_users_status","Bezig...");const e=document.getElementById("adm_users_body");e&&(e.innerHTML="");try{const t=await $e("/api/admin/users",i);if(!Array.isArray(t)||t.length===0){He("adm_users_status","Geen users");return}if(He("adm_users_status",`${t.length} users`),!e)return;for(const s of t){const a=document.createElement("tr"),r=document.createElement("td"),n=document.createElement("code");n.textContent=s.sub,r.appendChild(n);const o=document.createElement("td");o.textContent=s.name||"";const c=document.createElement("td");c.textContent=s.email||"";const l=document.createElement("td");l.textContent=s.isAdmin?"Ja":"Nee";const d=document.createElement("td");d.textContent=Rs(s.lastSeenAt);const h=document.createElement("td"),p=document.createElement("button");p.type="button",p.style.fontSize="14px",p.textContent=s.isAdmin?"Maak geen admin":"Maak admin",p.addEventListener("click",async()=>{const u=!s.isAdmin;confirm(`${u?"Admin rechten geven aan":"Admin rechten verwijderen van"} ${s.sub}?`)&&(await $e(`/api/admin/users/${encodeURIComponent(s.sub)}`,i,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isAdmin:u})}),await St(i))}),h.appendChild(p),a.appendChild(r),a.appendChild(o),a.appendChild(c),a.appendChild(l),a.appendChild(d),a.appendChild(h),e.appendChild(a)}}catch(t){js("adm_users_status",`<span class="highlight-warning">Fout: ${String((t==null?void 0:t.message)||t)}</span>`)}}async function ns(i){He("adm_shares_status","Bezig...");const e=document.getElementById("adm_shares_body");e&&(e.innerHTML="");try{const t=await $e("/api/admin/shares",i);if(!Array.isArray(t)||t.length===0){He("adm_shares_status","Geen shares");return}if(He("adm_shares_status",`${t.length} shares`),!e)return;for(const s of t){const a=document.createElement("tr"),r=document.createElement("td"),n=document.createElement("code");n.textContent=s.id,r.appendChild(n);const o=document.createElement("td"),c=(s.ownerName||s.ownerEmail||"").trim();o.textContent=c||s.ownerSub||"";const l=document.createElement("td");l.textContent=s.teamId||"";const d=document.createElement("td");d.textContent=Rs(s.updatedAt);const h=document.createElement("td"),p=document.createElement("button");p.type="button",p.style.fontSize="14px",p.textContent="Open",p.addEventListener("click",async()=>{const g=await $e(`/api/admin/shares/${encodeURIComponent(s.id)}`,i),b=ne(g.schema);globalThis.load_from_txt(b),globalThis.currentShareId=g.id,globalThis.topMenu.selectMenuItemByName("Schema")});const u=document.createElement("button");u.type="button",u.style.fontSize="14px",u.textContent="Kopieer link",u.style.marginLeft="6px",u.addEventListener("click",async()=>{await _r(vr(s.id))}),h.appendChild(p),h.appendChild(u),a.appendChild(r),a.appendChild(o),a.appendChild(l),a.appendChild(d),a.appendChild(h),e.appendChild(a)}}catch(t){js("adm_shares_status",`<span class="highlight-warning">Fout: ${String((t==null?void 0:t.message)||t)}</span>`)}}async function Lr(){const i=await Tr();if(!i)return;const e=await D.getProfile(),t=(e==null?void 0:e.name)||(e==null?void 0:e.email)||(e==null?void 0:e.sub)||"";try{const n=await $e("/api/me",i);if(!(n!=null&&n.isAdmin)){alert("Geen toegang: admin vereist.");return}}catch(n){alert(`Kon admin status niet controleren: ${String((n==null?void 0:n.message)||n)}`);return}wr(Sr(t));const s=document.getElementById("adm_back");s==null||s.addEventListener("click",()=>{globalThis.topMenu.selectMenuItemByName("Bestand")});const a=document.getElementById("adm_users_refresh");a==null||a.addEventListener("click",async()=>{const n=await D.getAccessToken();n&&await St(n)});const r=document.getElementById("adm_shares_refresh");r==null||r.addEventListener("click",async()=>{const n=await D.getAccessToken();n&&await ns(n)}),await St(i),await ns(i)}function Me(i){return i?{Authorization:`Bearer ${i}`}:{}}globalThis.authLogin=async()=>{try{await D.login()}catch(i){console.error("OIDC login failed",i);const e=i!=null&&i.message?String(i.message):String(i);alert(`Aanmelden mislukt: ${e}`)}};globalThis.authLogout=async()=>{await D.logout()};globalThis.authWhoAmI=async()=>{if(!D.isEnabled()){alert("OIDC is niet geconfigureerd.");return}const i=await D.getProfile();if(!i){alert("Niet ingelogd.");return}alert(`Ingelogd als: ${i.name||i.email||i.sub}`)};globalThis.openShareManager=async()=>{if(!D.isEnabled()){alert("Share beheer vereist OIDC login, maar OIDC is niet geconfigureerd.");return}const i=await D.getAccessToken();if(!i){confirm("Aanmelden is nodig om je shares te bekijken. Nu aanmelden?")&&await D.login();return}const e=await fetch("/api/shares/mine",{method:"GET",headers:V({"Content-Type":"application/json"},Me(i))});if(!e.ok){alert(`Kon shares niet laden: ${e.status} ${await e.text()}`);return}const t=await e.json();if(!Array.isArray(t)||t.length===0){alert("Geen shares gevonden.");return}const s=window.location.href.split("#")[0],a=t.slice(0,50).map(r=>`${r.id}  (updated ${r.updatedAt})  ->  ${s}#share=${r.id}`);prompt("Je shares (kopieer wat je nodig hebt):",a.join(`
`))};globalThis.openTeamManager=async()=>{if(!D.isEnabled()){alert("Teams vereisen OIDC login, maar OIDC is niet geconfigureerd.");return}const i=await D.getAccessToken();if(!i){confirm("Aanmelden is nodig voor teams. Nu aanmelden?")&&await D.login();return}const e=prompt(`Team acties:
1 = List teams
2 = Create team
3 = Invite to team (by team id)
4 = Accept invite (token)`,"1");if(e){if(e==="1"){const t=await fetch("/api/teams",{headers:Me(i)});if(!t.ok){alert(`Kon teams niet laden: ${t.status} ${await t.text()}`);return}const a=(await t.json()).map(r=>`${r.id}  ${r.name}  (${r.role})`);prompt("Teams:",a.join(`
`));return}if(e==="2"){const t=prompt("Team naam:","Mijn team");if(!t)return;const s=await fetch("/api/teams",{method:"POST",headers:V({"Content-Type":"application/json"},Me(i)),body:JSON.stringify({name:t})});if(!s.ok){alert(`Kon team niet aanmaken: ${s.status} ${await s.text()}`);return}const a=await s.json();alert(`Team aangemaakt: ${a.name} (${a.id})`);return}if(e==="3"){const t=prompt("Team id:","");if(!t)return;const s=prompt("Invite email (optioneel):",""),a=await fetch(`/api/teams/${encodeURIComponent(t)}/invites`,{method:"POST",headers:V({"Content-Type":"application/json"},Me(i)),body:JSON.stringify({email:s||""})});if(!a.ok){alert(`Kon invite niet maken: ${a.status} ${await a.text()}`);return}const r=await a.json();prompt("Invite token (deel dit):",r.token);return}if(e==="4"){const t=prompt("Invite token:","");if(!t)return;const s=await fetch("/api/invites/accept",{method:"POST",headers:V({"Content-Type":"application/json"},Me(i)),body:JSON.stringify({token:t})});if(!s.ok){alert(`Kon invite niet accepteren: ${s.status} ${await s.text()}`);return}alert("Invite geaccepteerd.")}}};globalThis.openShareTeamsScreen=async()=>{await kr()};globalThis.openAdminScreen=async()=>{await Lr()};async function Er(){await D.init();try{if(D.isEnabled()){const i=await D.getAccessToken();i&&await fetch("/api/me",{headers:Me(i)})}}catch(i){}}cr();console.log("20260214-185530");globalThis.session=new sr;globalThis.appDocStorage=new ir("appDocStorage",{});globalThis.undostruct=new rr(100);globalThis.fileAPIobj=new $a;globalThis.currentShareId=null;globalThis.treeEditInModal=!0;globalThis.SITPLANVIEW_SELECT_PADDING=parseInt(I(getComputedStyle(document.documentElement).getPropertyValue("--selectPadding")));globalThis.SITPLANVIEW_ZOOMINTERVAL={MIN:.1,MAX:1e3};globalThis.SITPLANVIEW_DEFAULT_SCALE=.7;globalThis.CONFIGPAGE_LEFT=`
    <table border="1px" style="border-collapse:collapse;" align="center" width="100%"><tr><td style="padding-top: 0; padding-right: 10px; padding-bottom: 10px; padding-left: 10px;">
        <p><font size="+2">
          <b>Welkom op ééndraadschema</b>
        </font></p>
      <p><font size="+1">  
           Deze gratis tool laat toe zowel ééndraadschema's als situatieschema's te tekenen, inclusief complexere schema's
           met bijvoorbeeld domotica. De schema's kunnen als PDF bestand worden geëxporteerd en geprint.
           Voor de experts kunnen schema's eveneens worden omgezet in SVG vectorformaat om in andere programma's verder te bewerken.
      </font></p>
      <p><font size="+1">  
           Kies één van onderstaande voorbeelden om van te starten of start van een leeg schema (optie 3).
      </font></p>
      <font size="+1">
        <i>
          <b>Tip: </b>Om de mogelijkheden van het programma te leren kennen is het vaak beter eerst een voorbeeldschema te
          bekijken alvorens van een leeg schema te vertrekken.
        </i>
      </font>
    </td></tr></table>
    <div id="autoSaveRecover"></div>
    <br>
    <table border="1px" style="border-collapse:collapse" align="center" width="100%">
      <tr>
        <td width="25%" align="center" bgcolor="LightGrey">
          <b>Voorbeeld 1</b>
        </td>
        <td width="25%" align="center" bgcolor="LightGrey">
          <b>Voorbeeld 2</b>
        </td>
        <td width="25%" align="center" bgcolor="LightGrey">
          <b>Leeg schema</b>
        </td>
        <td width="25%" align="center" bgcolor="LightGrey">
          <b>Openen</b>
        </td>
      </tr>
      <tr>
        <td width="25%" align="center">
          <br>
          <img src="examples/example000.svg" height="300px"><br><br>
          Eenvoudig schema, enkel contactdozen en lichtpunten.
          <br><br>
        </td>
        <td width="25%" align="center">
          <br>
          <img src="examples/example001.svg" height="300px"><br><br>
          Iets complexer schema met teleruptoren, verbruikers achter contactdozen en gesplitste kringen.
          <br><br>
        </td>
        <td width="25%" align="center">
          <br>
          <img src="examples/gear.svg" height="100px"><br><br>
`;globalThis.CONFIGPAGE_RIGHT=`
          <br><br>
        </td>
        <td width="25%" align="center">
          <br>
          <img src="examples/import_icon.svg" height="100px"><br><br>
          Open een schema dat u eerder heeft opgeslagen op uw computer (EDS-bestand). Enkel bestanden aangemaakt na 12 juli 2019 worden herkend.
          <br><br>
        </td>
      </tr>
      <tr>
        <td width="25%" align="center">
          <br>
          <button onclick="load_example(0)">Verdergaan met deze optie</button>
          <br><br>
        </td>
        <td width="25%" align="center">
          <br>
          <button onclick="load_example(1)">Verdergaan met deze optie</button>
          <br><br>
        </td>
        <td width="25%" align="center">
          <br>
          <button onclick="read_settings()">Verdergaan met deze optie</button>
          <br><br>
        </td>
        <td width="25%" align="center">
          <br>
          <button onclick="loadClicked()">Verdergaan met deze optie</button>
          <br><br>
        </td>
      </tr>
    </table>
  `;globalThis.CONFIGPRINTPAGE="<div></div><br>";globalThis.EXAMPLE0="EDS0040000eJztWW1v2zYQ/iuCvk4L9JZkNoZhSQZ0Q7ehQIZsQFEItHS2GVGkQVF2XpD99t2RsiWjrptqcbYUAYJAOpLH4/M8vKOpez9vtAZprjis/LHvB74AOTNzfxyNAr9ghvnj9/c+L9AQ+AtGff1xGPhcFuvHXAnBFjVgnykTNWA/rRa1P773pUanP/HpFB2zxij7XjHZAIjW9FZzOfudsWqrxdwuAA1nTNai4Qa7UHcmDRPZQmGM2BijaQJ1PgddUYexX+BMQCHy1n+1AM1m5CkNW69ZySYgMskyA0IABRTfRCfYujU6K0AYlvU8JCG5YIWG2iFlvW1PiRFjA2K6hIwWVzFmXOdt57zOahCQ49t0g1qptLGrXeKC1MyuMcGh0oGzHf9SKd2tANvmDa/nqsGw+XXpj41u0OWU1RS6/xD4tWp0jo01BiQbIR4CR2vc0Rp1tEafp3UgpedKF/iGCMyAMXxuQ+1WuYF4T9SkznXYcRd2fLCwbePTahAtf12de8mbODh+jPxoMJR1KygnA6FyhgPQVBsmCwvoFyrTOUI+uMwmKKINbv9CsnvF2JsS0VzBHZ9tHLYqsCljn2jDnmpHHf/JM8p2O+JH6va0J9vwU7p1cA0Jm94HaNYJwnC0bSs23qnYiwv2eNX2ZfsWmhJD+Fi8v0hvhfL9lHR3Kfdip3QddM+q3K30dbaP/KTH/ukXiTbq09+S/FnJXiikPTeFUvWuhIuGkkJAXLnoFuLEsp6zq3atiAgKwrvgILMKQKOBBm/lnznA1GCnGUxUsyogQ2GxEgQ2bxaI08+ZmK6YAV3wfG76LT3HrdG5RDR3zL0eJzMks0AMJmqzQffQkcZD6Yhf6TgAHUlHR9qr6enBcvqV5tfgueTUJak/CYJSlXiwCvwldclsU9aOulPEkleywvaYK83viFoBGaYTTBvSJdUco9fg+li0elkWsgk2FYb8zZEoMlOm7qwnoRPJEraYwDRY99PYY2pOGg3VefKq8wPoPBxKR/pKx9PTkYyG0nH8SsfT03Hysg7I9uLgEwfk6MsPyFegBcHuwvpqT8nne3/a9yRwcvhT8q+Ed851jqvspNDtjbp1bCHvbxm/aCa4TBSNLd29Xem2Be4CyXB5RJ5Axq/hEdvMDUW0S8FLPIJ8PBDPFOWOndvGbdWzaKSxVEV7cT4divOg4+9jcI534gyyfMEwJ/FQmAedvobL+WXDHEe7C0f6AgvHgJuVc1aUrLI/Nr7aqnGxl//eNot7F9nHr5cr/8k5Lk4H8/F6u3IIPkaD+XjmOrT7WHW54DCzE/zP69EH7I3pcIlu31uRHewfzkTMvo+COIhGAVa90yA5DdI4SJMgjYI0DPDH7UmAB2o86+E5BHnHNIk7Mx59IJK5NJlhEwFE9Rz4jKA6PsFMWrGbFS/oM3D6XUo5v14IdruwlQeLK0gadYYacKa2rOJzbT8Xb/nCvaLdh+Ia+1uPBBL1rphGFmqHHM6qCkByDM/tnmRCAG1m6+B24+G29btgWAtrfme/E6fEBcmWhoPV7pRjUcaaSEebGyRaQBiGR1CQS7WS9rvplVKaqot3hsSCffx+on+4NBoLoRfSMw4KPQwVcLsAGf4AMfa+SWIP7es/sr+5/G1t326AbyvGccyyneyIbSb7sVAVcHk0AUpaElfaftDlBVRUmTGraUVgkCPbZ6ooRXo3XpyEV97fx6H3852r4d13fAengBnLby/7W85lBOpsb6KOHeaEUGG3ac0NEi3XHtrX61pJmw2a6p3jOFqL/J3lH18LmLJGGIc8Ru2IibClRjZJNkf4e0Mrw+h6M8Qg8NhQYcSkmA8Pm7mWmwU8/ANHMC6N";globalThis.EXAMPLE1="EDS0040000eJztWm1v2zYQ/iuGvk4LrBc7iTEMS1KgHdoOBVIEA4pCoK2zzYgSDYpyXor0t++OlC0ptR1HjdO0cxEUMl+Ox+d5eDxS+uKMCqUg0xccrpyB47iOgGyip84g8FwnZpo5g09fHB47A/w9Y9TWGXRdh2fx4nEkhWCzHLDNmIkcsJ2Ss9wZfHEyhUZf8fEYDbNCS/M7ZVkBIMqit4pnk38YSxs1+mYGWHDCslwUXGMTas4yzUQ0k+gjVvpYNIR8NAWVUoOBE+NIQC7y0n46A8UmZCnsllajhA1BRBmLNAgB5JB/7fWxttE7ikFoFtUsBF0ywWIFuUXKWGsOiR5jBWI6h4gmlzKmbeOmcZ5HOQgY4a/xErVEKm1mO8cJyYmZY4BdMwtO0/+5lKqaAdZNC55PZYFu88vEGWhVoMkxy8l15851clmoEVbm6FBWCHHnWlr9ilavotV7mNaWlJ5KFeMvRGACjOFz6Wo1yyXEG7z2jiu3/cptf2dum8qn1SCW/Htx2gle+25vG/lRZ0jyUlBWBkKOGHbAolyzLDaAPlKZ1hDywbNoiCJa4vYdkt0oxtqQiOYV3PLJ0mCpAhMyNom2W1PtccV/8IyybXq8pW4Pa7LtrtOthauN2/S7hWatIDTHsqZi/ZWKPRux7VVbl+1bloLqeCvU+3fWuUL9rtPuKumerdSuxe5ZpduIXyeb2D+q2D98DtGezwTXeSmCLdRZC6pHlX/hjxXnBLBiC1W2UmSbQPpMcfQJwujGHbSWz9UiaO9hMXp1uktSH5TimUSaRzqWMl+1+2NBQi4grFxUi8qKYzFmlXqVoiEoCO+YQxalAAoLqHODwynAWGOjCQxlcRVDhOJiCQisXk4Qh58yMb5iGlTMR1Ndr6kZLgutSURzxdiLflmEXMaIwVAud4tNdARt6fD3dDw9HWFYSzCCio/+zmL1ez5SciLFWM5tvNsmC/bbiib4AaLxf3XRBOEWdKzaP8M2bLwH8k1BB30cqoInoPItdRP0KkfJ6d2r+3zJV15Rn9cKbUwx+22dWycuhrjJYXbAJ035WP6QrozhBGnvFrjLX8IWerBdEbZE8ARh+7ajVpgf3JfYJkD7zw3oPoA/sJ92d5rLtr8f2Kezu0lnayHN6z5qL+ztE6gdrL+wNR/9PR9Pz0f/57p4Mhfyay6evLYXT/6vfPF0ujE61ujvr7t5WsV+q7P+d2SmYe1Wwuuv27f3menWmWnoPzeg72hGswIHuR9fLba4XG4xpJWR7eO7b6OvwZqmvip9yaSMESBBo9gg8tpmVAgOrWTbbxn1NwK9KWhvwjT4X2K6Xr0W7e/C1DtsGaFaXX8ZPEdcjTAMr1v1/spVD1nyQhb90m2xEIfZSryNB3+/Jcqt7ou2QXl1bNW4a6pipqX6GVEOey1RbnUP9EqmUnPMjCaQ66LAnbe27y7QhWsEJEOUdaHsCl8nZAQiVozFgjLpxsoWMmECUyRVJEkmGwFhAjiRiWIpJapxs1sM2mRA95j4xqMHo24thyGEX3zUfVPAvcAr4MlC7lPsY763+lDwg1/4tToUtLgsOWVxQueCX/lUcLbxK4rabuB7jzqj798B7uL9wXFrPvYvAXfxErB2hxzUXujs7lb/QvFL6NgAVQWqN4Qa7q8mVM2pSWSqorLXrSSWOgmLTYupVPyWqMXNGgMKBo7MBtYReq/AtjFo1SItREOsijXZmyJRVEzRuirt9axI5tBgAgNhXg9k25zy/fZCf+ZE9AUd8h+ViX7G1rjBzNHsJ7NsX+R/6CXJ4ZPn+q537GIOcugeuceu57le4Iah6/luELpBzw36rtd1vZ7rhS4+9t3Qc0PfxZM4HhzxVIMJIeaHqCXc03Cp4sr1jz+TdniGy4QNBZCCpsAnREQvxNNmyq6veEyfOveOe7RH5zPBbmYmU8CFDxn1OkFp2aIyDcLn3HwS3bCFsU3Zj6FzTZkxWiQKqHXKlLn/MrzgqDIGpJ4SdoqhTAig4GsM3Cwt3JR2ZwxzlxyzTGx6EhLTtBqoO5glMeaYRGEOQ/n8NcpIQLfrHUBMJuVVZr4NvpBSUTbQOUHZgHn8Y6j+PNeY5etOl567+A+PDxgxUVRU8BHEoPNb4HewfPFH5a/P3y/KmxXwe8o49pmXgx2w5WB/xTIFnh0MKRvmGc60/GiZx5BSJoWhSkkCgwyZNmNJW1rnuuMH3YvO11638+bW5lzVt+oWTgETNrqp3+GVgYYamxh+ZDEnhGKz+nOukehsYaH8eZnLzASZIv1gOfYWS+iD4Z8+h4cxK4S2yKPXlhj6kCpHNkk2B8iZkppRwOyiE5jmpegxKebz3XKs+XICd/8BlbFDJw==";globalThis.EXAMPLE_DEFAULT="EDS0040000eJytVN9v00AM/leieyWM/GgniBCivICE4GVoL9MUuTk3PfVyF91dunbT+NuxkzZZAQ0VqKLq4rM/f/7s+EFoNHVYi2IWCwkBRHHzIJQURRqLFhyaIIokFsrI47GyWkPrkXxWoD2Sn7OtF8WDME4UQsQi7Fuk0wKM150KytRkBDABdNlayiiKLBZL9NUaXcPXhZBqtULOpxA1uzctOqgJ53I+IJYbWKIuDZQBtUbOle3SS/I9iS0l6gDlFJ8nxBqkQz+xK0/T9faqc1ssoQu2AQiD7RRZ+dKjxoreVmP1G+tCX+aWarE1F8eRBqB5km/gvrXWTezFYyy87VyFWnlKaDqtH+NB/mySP53kT8+R/4N1kt6IdI0AdC6C6/Aps1GUZ4jkE5FsIpKdQ+Sz+68T8LvO/NpzisCNP7RxUF/bCsidTF9fLc4chAGBtFSmXHbKj0X//YSMkKTLHd6regw4duiZtsymtuRTW/J/m4+f0v9hQG7pngrdEtZNP1mnf3TNRG/SOIvzeHbLRJQJZYClRqaDhk8LkrntezZM5xpVveZRv3wTiwZ2d0ryekpfp6y1bzXsB/eEFaiZHm2skygfwA27yhN2H8tk2bsBt0HnhwoI30qkpgRVAfce6MP04gCwHxH2B9wWaLy8uu9324w1YWk5HHt9V4oGGxq+RjTSAUie7wYuUDKsvTP9d39NW4A1jhbVOmB/fLt0764CRYQo4XNCv4joEk5ANnxDXUQv8iwi+/Fh+8erL0f76QW+bEBRzPaQ7ALGZO+lbVCZiyVy+w1Ve1hISmLD829NcJYFYaDeZ2V520a7KMuT6+j7PIk+3bMA9Klwk+eDlFy4VEE8/gDGURmI";globalThis.forceUndoStore=()=>{globalThis.undostruct.store()};globalThis.HLCollapseExpand=(i,e)=>{let t;t=globalThis.structure.getOrdinalById(i),t!=null&&(e==null?globalThis.structure.data[t].collapsed=!globalThis.structure.data[t].collapsed:globalThis.structure.data[t].collapsed=e,globalThis.undostruct.store(),ce()?globalThis.HLRedrawTree():(globalThis.structure.updateHTMLinner(i),globalThis.HLRedrawTreeSVG()))};function Fe(){const i=document.getElementById("edsKeybindsModalOverlay");i&&i.parentElement&&i.parentElement.removeChild(i)}function Ir(){Fe();const i=document.createElement("div");i.id="edsKeybindsModalOverlay",i.classList.add("popup-overlay","eds-keybinds-modal-overlay");const e=document.createElement("div");e.classList.add("popup","eds-keybinds-modal"),e.innerHTML=`
        <div class="eds-keybinds-header">
            <h3 class="eds-keybinds-title">Keybinds</h3>
            <button type="button" class="eds-keybinds-close" title="Sluiten">×</button>
        </div>
        <div class="eds-keybinds-body">
            <div class="eds-keybinds-note">
                Shortcuts apply to the element you are hovering in the SVG drawing (EDS). If you're typing in a text field, normal browser copy/paste wins.
            </div>

            <div class="eds-keybinds-grid">
                <div class="eds-keybinds-key">Ctrl/Cmd + C</div>
                <div class="eds-keybinds-desc">Copy settings</div>

                <div class="eds-keybinds-key">Ctrl/Cmd + V</div>
                <div class="eds-keybinds-desc">Paste settings (same type), or confirm to replace type</div>

                <div class="eds-keybinds-key">Shift + Ctrl/Cmd + C</div>
                <div class="eds-keybinds-desc">Copy component (including sub-elements)</div>

                <div class="eds-keybinds-key">Shift + Ctrl/Cmd + V</div>
                <div class="eds-keybinds-desc">Paste component after hovered element (same parent)</div>

                <div class="eds-keybinds-key">Shift + Alt + Ctrl/Cmd + V</div>
                <div class="eds-keybinds-desc">Paste component before hovered element</div>

                <div class="eds-keybinds-key">Ctrl/Cmd + Click</div>
                <div class="eds-keybinds-desc">Highlight element in tree</div>
            </div>

            <div class="eds-keybinds-note">
                Note: some browsers reserve Ctrl/Cmd+Shift+C for DevTools “Inspect”. If that happens, choose the context menu instead.
            </div>
        </div>
    `,i.appendChild(e),document.body.appendChild(i),i.style.visibility="visible",i.style.pointerEvents="auto";const t=e.querySelector(".eds-keybinds-close");t==null||t.addEventListener("click",()=>Fe()),i.addEventListener("mousedown",s=>{s.target===i&&Fe()}),window.addEventListener("keydown",function s(a){a.key==="Escape"&&(window.removeEventListener("keydown",s),Fe())})}function Ce(){const i=document.getElementById("edsTreeModalOverlay");i&&i.parentElement&&i.parentElement.removeChild(i),document.body.style.pointerEvents="auto",globalThis._edsTreeModalOpenId=null}function os(i,e){var a;const t=i.querySelector(".eds-tree-modal-preview");if(!t)return;const s=globalThis.structure.getElectroItemById(e);if(s==null||typeof s.updateSituationPlanElement!="function"){t.innerHTML="";return}try{const r=new Se;r.setElectroItemId(e),r.rotate=0,r.setscale(1),s.updateSituationPlanElement(r),t.innerHTML=(a=r.svg)!=null?a:"";const n=t.querySelector("svg");n&&(n.removeAttribute("width"),n.removeAttribute("height"),n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.setAttribute("preserveAspectRatio","xMidYMid meet"))}catch(r){t.innerHTML=""}}function Ar(i){if(i.querySelector(".eds-prop-grid"))return;let e=i.innerHTML;if(e.trim()==="")return;e=e.replace(/<br\s*\/?>/gi,'<span class="eds-prop-section-break"></span>'),e=e.replace(/,\s+/g,'<span class="eds-prop-delim"></span>'),i.innerHTML=e;const t=Array.from(i.childNodes),s=document.createElement("div");s.className="eds-prop-grid";const a=c=>{var l;for(const d of Array.from(c.childNodes))if(d.nodeType===Node.ELEMENT_NODE||d.nodeType===Node.TEXT_NODE&&((l=d.textContent)!=null?l:"").trim()!=="")return!0;return!1},r=c=>{a(c)&&s.appendChild(c)},n=c=>{var d,h;const l=Array.from(c.querySelectorAll('input[type="checkbox"]'));for(const p of l){if(p.closest("label"))continue;const u=p.closest(".eds-prop-row");if(!u)continue;const g=[];let b=p.previousSibling;for(;b;){if(b.nodeType===Node.ELEMENT_NODE){const T=b.tagName;if(T==="LABEL"||T==="INPUT"||T==="SELECT"||T==="TEXTAREA"||T==="BUTTON")break}b.nodeType===Node.TEXT_NODE&&((d=b.textContent)!=null?d:"").trim(),g.push(b),b=b.previousSibling}if(!g.some(T=>{var U;return T.nodeType!==Node.TEXT_NODE||((U=T.textContent)!=null?U:"").trim()!==""}))continue;g.reverse();const v=document.createElement("label");v.className="eds-inline-checkbox-label",u.insertBefore(v,(h=g[0])!=null?h:p);for(const T of g)v.appendChild(T);v.appendChild(p)}};let o=document.createElement("div");o.className="eds-prop-row";for(const c of t){if(c.nodeType===Node.ELEMENT_NODE){const l=c;if(l.classList.contains("eds-prop-delim")){r(o),o=document.createElement("div"),o.className="eds-prop-row";continue}if(l.classList.contains("eds-prop-section-break")){r(o);const d=document.createElement("div");d.className="eds-prop-section-spacer",s.appendChild(d),o=document.createElement("div"),o.className="eds-prop-row";continue}}o.appendChild(c)}r(o),i.innerHTML="",i.appendChild(s),n(s)}function Te(i){if(globalThis.treeEditInModal!==!0)return;const e=globalThis.structure.getElectroItemById(i);if(e===null)return;Ce();const t=document.createElement("div");t.id="edsTreeModalOverlay",t.classList.add("popup-overlay","eds-tree-modal-overlay");const s=document.createElement("div");s.classList.add("popup","eds-tree-modal");const a=`${I(e.getType())||"Element"} — ${I(e.getReadableAdres())||`ID ${i}`}`,r=le!=null&&I(le.type)!==""&&I(le.type)===I(e.getType());s.innerHTML=`
        <div class="eds-tree-modal-header">
            <div class="eds-tree-modal-title">${a}</div>
            <div class="eds-tree-modal-actions">
                <button type="button" class="eds-tree-modal-action" data-eds-action="copy-settings" title="Copy settings">Copy</button>
                <button type="button" class="eds-tree-modal-action" data-eds-action="paste-settings" title="Paste settings" ${r?"":"disabled"}>Paste</button>
                <button type="button" class="eds-tree-modal-action" data-eds-action="replace-settings" title="Replace settings">Replace</button>
            </div>
            <div class="eds-tree-modal-preview" aria-hidden="true"></div>
            <button type="button" class="eds-tree-modal-close" title="Sluiten">×</button>
        </div>
        <div class="eds-tree-modal-body">
            ${e.toHTML(globalThis.structure.mode)}
        </div>
    `,t.appendChild(s),document.body.appendChild(t);const n=s.querySelector(".eds-tree-modal-body");n&&Ar(n),os(s,i),t.style.visibility="visible",document.body.style.pointerEvents="none",t.style.pointerEvents="auto",globalThis._edsTreeModalOpenId=i;const o=s.querySelector(".eds-tree-modal-close");o==null||o.addEventListener("click",()=>Ce());const c=s.querySelector(".eds-tree-modal-actions");c==null||c.addEventListener("click",l=>{var p;const d=l.target,h=(p=d==null?void 0:d.getAttribute)==null?void 0:p.call(d,"data-eds-action");if(h){if(l.preventDefault(),l.stopPropagation(),h==="copy-settings"){Ot(i),Te(i);return}if(h==="paste-settings"){Ke(i,{replaceType:!1});return}if(h==="replace-settings"){if(le==null){alert("No copied settings yet. Use Copy first.");return}const u=I(le.type),g=I(e.getType());if(!(u!==""&&u!==g?confirm(`Replace this element (type ${g||"unknown"}) with copied settings (type ${u})?`):!0))return;Ke(i,{replaceType:!0});return}}}),s.addEventListener("change",l=>{ii(l.target),os(s,i);const d=l.target;if(d&&typeof d.id=="string"&&/_type$/.test(d.id)){const h=globalThis._edsTreeModalOpenId;h!=null&&h===i&&Te(i)}}),t.addEventListener("mousedown",l=>{l.target===t&&Ce()}),window.addEventListener("keydown",function l(d){d.key==="Escape"&&(window.removeEventListener("keydown",l),Ce())})}function Us(i){i._treeModalEditingBound!==!0&&(i._treeModalEditingBound=!0,i.addEventListener("click",e=>{var n;if(globalThis.treeEditInModal!==!0)return;const t=e.target;if(t==null)return;const s=t.tagName;if(s==="INPUT"||s==="SELECT"||s==="TEXTAREA"||s==="BUTTON"||t.closest(".hl-collapse-cell")||t.closest(".tree-drag-handle"))return;const a=(n=t.closest("[data-hl-open-id]"))==null?void 0:n.getAttribute("data-hl-open-id");let r=null;if(a!=null){const o=Number(a);Number.isFinite(o)&&o>0&&(r=o)}if(r==null){const o=t.closest("table.html_edit_table[data-hl-id]"),c=o==null?void 0:o.getAttribute("data-hl-id"),l=c!=null?Number(c):NaN;Number.isFinite(l)&&l>0&&(r=l)}r!=null&&Te(r)}))}globalThis.HLDelete=i=>{const e=globalThis.structure.getElectroItemById(i);if(e===null)return;const t=e.getParent();globalThis.structure.deleteById(i),globalThis.undostruct.store(),globalThis._edsTreeModalOpenId===i&&Ce(),t!==null&&!ce()?(globalThis.structure.reNumber(),globalThis.structure.updateHTMLinner(t.id),globalThis.HLRedrawTreeSVG()):globalThis.HLRedrawTree()};globalThis.HLAdd=()=>{globalThis.structure.addItem(""),globalThis.undostruct.store(),globalThis.HLRedrawTree()};globalThis.HLInsertBefore=i=>{const e=globalThis.structure.getElectroItemById(i);if(e===null)return;const t=e.getParent(),s=globalThis.structure.curid;globalThis.structure.insertItemBeforeId(new B(globalThis.structure),i),globalThis.undostruct.store(),t!==null&&!ce()?(globalThis.structure.reNumber(),globalThis.structure.updateHTMLinner(t.id),globalThis.HLRedrawTreeSVG()):globalThis.HLRedrawTree(),globalThis.treeEditInModal===!0&&globalThis.structure.curid!==s&&Te(s)};globalThis.HLInsertAfter=i=>{const e=globalThis.structure.getElectroItemById(i);if(e===null)return;const t=e.getParent(),s=globalThis.structure.curid;globalThis.structure.insertItemAfterId(new B(globalThis.structure),i),globalThis.undostruct.store(),t!==null&&!ce()?(globalThis.structure.reNumber(),globalThis.structure.updateHTMLinner(t.id),globalThis.HLRedrawTreeSVG()):globalThis.HLRedrawTree(),globalThis.treeEditInModal===!0&&globalThis.structure.curid!==s&&Te(s)};globalThis.HLMoveDown=i=>{const e=globalThis.structure.getElectroItemById(i);if(e===null)return;const t=e.getParent();globalThis.structure.moveDown(i),globalThis.undostruct.store(),t!==null&&!ce()?(globalThis.structure.reNumber(),globalThis.structure.updateHTMLinner(t.id),globalThis.HLRedrawTreeSVG()):globalThis.HLRedrawTree()};globalThis.HLMoveUp=i=>{const e=globalThis.structure.getElectroItemById(i);if(e===null)return;const t=e.getParent();globalThis.structure.moveUp(i),globalThis.undostruct.store(),t!==null&&!ce()?(globalThis.structure.reNumber(),globalThis.structure.updateHTMLinner(t.id),globalThis.HLRedrawTreeSVG()):globalThis.HLRedrawTree()};globalThis.HLClone=i=>{const e=globalThis.structure.getElectroItemById(i);if(e===null)return;const t=e.getParent();globalThis.structure.clone(i),globalThis.undostruct.store(),t!==null&&!ce()?(globalThis.structure.reNumber(),globalThis.structure.updateHTMLinner(t.id),globalThis.HLRedrawTreeSVG()):globalThis.HLRedrawTree()};globalThis.HLInsertChild=i=>{const e=globalThis.structure.curid;globalThis.structure.insertChildAfterId(new B(globalThis.structure),i),globalThis.structure.reNumber(),globalThis.HLCollapseExpand(i,!1),globalThis.treeEditInModal===!0&&globalThis.structure.curid!==e&&Te(e)};globalThis.HL_editmode=()=>{globalThis.structure.mode=document.getElementById("edit_mode").value,globalThis.HLRedrawTreeHTML()};globalThis.HL_toggleTreeEditModal=()=>{const i=document.getElementById("hl_tree_edit_in_modal");globalThis.treeEditInModal=(i==null?void 0:i.checked)===!0,Ce(),globalThis.HLRedrawTreeHTML()};globalThis.HLExpand=i=>{let e=globalThis.structure.getElectroItemById(i);e!==null&&e.expand(),globalThis.structure.reSort(),globalThis.undostruct.store(),globalThis.HLRedrawTree()};globalThis.HL_changeparent=i=>{var r,n;let e=document.getElementById("id_parent_change_"+i).value,t=0,s=0;di(e)||(t=1);let a=parseInt(e);if(a!=0)if(s=globalThis.structure.getOrdinalById(a),s==null)t=1;else if(!globalThis.structure.active[s]||a==i)t=1;else{let o=a;for(;o!=0;)o=(n=(r=globalThis.structure.getElectroItemById(o))==null?void 0:r.parent)!=null?n:0,o==i&&(t=2)}switch(t){case 1:alert("Dat is geen geldig moeder-object. Probeer opnieuw.");break;case 2:alert("Circulaire referentie. Nieuwe moeder kan geen afstammeling van het te verplaatsen element zijn.");break;default:const o=globalThis.structure.getOrdinalById(i);o!==null&&(globalThis.structure.data[o].parent=a)}globalThis.structure.reSort(),globalThis.undostruct.store(),globalThis.HLRedrawTree()};globalThis.HL_cancelFilename=()=>{const i=document.getElementById("settings");i!==null&&(i.innerHTML="<code>"+globalThis.structure.properties.filename+'</code><br><button style="font-size:14px" onclick="saveSchema()">Opslaan</button>&nbsp;<button style="font-size:14px" onclick="HL_enterSettings()">Naam wijzigen</button>')};globalThis.HL_changeFilename=()=>{var i=new RegExp("^.*\\.eds$"),e=document.getElementById("filename").value;const t=document.getElementById("settings");t!==null&&(i.test(e)?(globalThis.structure.properties.setFilename(document.getElementById("filename").value),t.innerHTML="<code>"+globalThis.structure.properties.filename+'</code><br><button style="font-size:14px" onclick="HL_enterSettings()">Wijzigen</button>&nbsp;<button style="font-size:14px" onclick="saveSchema()">Opslaan</button>'):(globalThis.structure.properties.setFilename(document.getElementById("filename").value+".eds"),t.innerHTML="<code>"+globalThis.structure.properties.filename+'</code><br><button style="font-size:14px" onclick="HL_enterSettings()">Wijzigen</button>&nbsp;<button style="font-size:14px" onclick="saveSchema()">Opslaan</button>'))};globalThis.HL_enterSettings=()=>{const i=document.getElementById("settings");i!=null&&(i.innerHTML='<input type="text" id="filename" onchange="HL_changeFilename()" value="'+globalThis.structure.properties.filename+'" pattern="^.*\\.eds$"><br><i>Gebruik enkel alphanumerieke karakters a-z A-Z 0-9, streepjes en spaties. <b>Eindig met ".eds"</b>. Druk daarna op enter.</i><br><button onclick="HL_cancelFilename()">Annuleer</button>&nbsp;<button onclick="HL_changeFilename()">Toepassen</button>')};globalThis.HLRedrawTreeHTML=()=>{globalThis.toggleAppView("2col");const i=document.getElementById("settings");i!==null&&(i.innerHTML="");var e=globalThis.structure.toHTML(0)+"<br>"+Js();const t=document.getElementById("left_col_inner");t!==null&&(t.innerHTML=e,Gs(t),Us(t))};globalThis.HLRedrawTreeHTMLLight=()=>{var i=globalThis.structure.toHTML(0)+"<br>"+Js();const e=document.getElementById("left_col_inner");e!==null&&(e.innerHTML=i,Gs(e),Us(e))};function Gs(i){if(i._treeDragDropBound===!0)return;i._treeDragDropBound=!0;let e=null,t=null,s=null;const a=()=>{t!=null&&t.classList.remove("tree-drop-before","tree-drop-after"),t=null,s=null};i.addEventListener("dragstart",r=>{if(globalThis.structure.mode!=="move"){r.preventDefault();return}const n=r.target;if(n==null)return;const o=n.tagName;if(o==="INPUT"||o==="SELECT"||o==="TEXTAREA"||o==="BUTTON"){r.preventDefault();return}const c=n.closest('table.html_edit_table[data-hl-id][draggable="true"]');if(c==null)return;const l=c.getAttribute("data-hl-id"),d=l!=null?Number(l):NaN;!Number.isFinite(d)||d<=0||(e=d,c.classList.add("tree-dragging"),r.dataTransfer&&(r.dataTransfer.setData("text/plain",String(d)),r.dataTransfer.effectAllowed="move"))}),i.addEventListener("dragend",()=>{const r=i.querySelectorAll("table.html_edit_table.tree-dragging");for(let n=0;n<r.length;n++)r[n].classList.remove("tree-dragging");e=null,a()}),i.addEventListener("dragover",r=>{if(globalThis.structure.mode!=="move"||e==null)return;const n=r.target;if(n==null)return;const o=n.closest('table.html_edit_table[data-hl-id][draggable="true"]');if(o==null){a();return}const c=o.getAttribute("data-hl-id"),l=c!=null?Number(c):NaN;if(!Number.isFinite(l)||l<=0)return;if(l===e){a();return}r.preventDefault(),r.dataTransfer&&(r.dataTransfer.dropEffect="move");const d=o.getBoundingClientRect(),h=r.clientY<d.top+d.height/2?"before":"after";(t!==o||s!==h)&&(a(),t=o,s=h,o.classList.add(h==="before"?"tree-drop-before":"tree-drop-after"))}),i.addEventListener("drop",r=>{var b;if(globalThis.structure.mode!=="move")return;const n=r.target;if(n==null)return;const o=n.closest('table.html_edit_table[data-hl-id][draggable="true"]');if(o==null)return;const c=o.getAttribute("data-hl-id"),l=c!=null?Number(c):NaN;if(!Number.isFinite(l)||l<=0)return;const d=(b=r.dataTransfer)==null?void 0:b.getData("text/plain"),h=d!=null&&d!==""?Number(d):e;if(h==null||!Number.isFinite(h)||h<=0||h===l)return;r.preventDefault();const p=o.getBoundingClientRect(),u=r.clientY<p.top+p.height/2?"before":"after",g=globalThis.structure.moveSubtreeRelativeToId(h,l,u,!1);a(),e=null,g&&(globalThis.undostruct.store(),globalThis.HLRedrawTree(),ve(h))})}globalThis.HLRedrawTreeSVG=()=>{let i='<div class="eds-drawing-header"><b>Tekening: </b>Ga naar het print-menu om de tekening af te printen of te exporteren als SVG vector graphics.<button type="button" id="edsKeybindsHelpButton" class="eds-keybinds-help-button" title="Keybinds">?</button></div><br><div id="EDS">'+Pt(globalThis.structure.toSVG(0,"horizontal").data,10)+`</div><h2>Legende:</h2><button class="button-insertBefore"></button> Item hierboven invoegen (zelfde niveau)<br><button class="button-insertAfter"></button> Item hieronder invoegen (zelfde niveau)<br><button class="button-insertChild"></button> Afhankelijk item hieronder toevoegen (niveau dieper)<br><button class="button-delete-garbage-can"></button> Item verwijderen<br><i><br><small>Versie: 20260214-185530 (C) Ivan Goethals -- <a href="license.html" target="popup" onclick="window.open('license.html','popup','width=800,height=600'); return false;">Terms</a></small></i><br><br>`;const e=document.getElementById("right_col_inner");e!=null&&(e.innerHTML=i),e!=null&&e._edsKeybindsHelpBound!==!0&&(e._edsKeybindsHelpBound=!0,e.addEventListener("click",t=>{const s=t.target;s!=null&&s.closest("#edsKeybindsHelpButton")!=null&&(t.preventDefault(),t.stopPropagation(),Ir())})),Mr()};const We=new Map;function Pr(i){var e;try{const t=globalThis.structure;if(t==null)return!1;let s=!1,a=i;for(;Number.isFinite(a)&&a>0;){const r=t.getOrdinalById(a);if(r==null)break;const n=(e=t.data[r])==null?void 0:e.parent;if(n==null||n===0)break;const o=t.getOrdinalById(n);if(o==null)break;const c=t.data[o];c!=null&&c.collapsed&&(c.collapsed=!1,s=!0),a=n}return s}catch(t){return!1}}function ve(i){var r,n;if(!Number.isFinite(i)||i<=0)return;const e=Pr(i);let t=document.getElementById("id_elem_"+i);if(t==null&&((n=(r=globalThis.structure)==null?void 0:r.properties)==null?void 0:n.currentView)!=="2col")try{globalThis.toggleAppView("2col"),globalThis.HLRedrawTreeHTMLLight(),t=document.getElementById("id_elem_"+i)}catch(o){}if(e)try{globalThis.HLRedrawTreeHTMLLight(),t=document.getElementById("id_elem_"+i)}catch(o){}if(t==null)return;try{t.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}catch(o){}const s=We.get(i);s!=null&&(clearTimeout(s),We.delete(i)),t.classList.remove("eds-tree-flash"),t.offsetWidth,t.classList.add("eds-tree-flash");const a=window.setTimeout(()=>{t.classList.remove("eds-tree-flash"),We.delete(i)},2600);We.set(i,a)}function Mr(){const i=document.getElementById("right_col_inner");if(i!=null&&i._edsClickToTreeFlashBound!==!0){if(i._edsClickToTreeFlashBound=!0,Br(i),window._edsModifierKeyBound!==!0){window._edsModifierKeyBound=!0;const e=t=>{const s=!!(t&&(t.ctrlKey||t.metaKey));document.documentElement.classList.toggle("eds-modifier-active",s)};window.addEventListener("keydown",t=>e(t)),window.addEventListener("keyup",t=>e(t)),window.addEventListener("blur",()=>document.documentElement.classList.remove("eds-modifier-active"))}i.addEventListener("click",e=>{const t=e.target;if(t==null||t.closest("#EDS")==null)return;const s=t.closest("#EDS");if(s==null)return;const a=Vt(e,t,s);if(a!=null){if(Ws(a),e.ctrlKey||e.metaKey){ve(a);return}globalThis.treeEditInModal===!0&&Te(a)}}),Hr(),Kr(i)}}let Ie=null,se=null,Oe=null,Fs=null,Ye=null,Nt=0;function Ws(i){Fs=i,Nt=Date.now()+6e4}function gt(i){Ye=i,i!=null&&(Nt=Date.now()+6e4)}function Cr(i){const e=i;if(e==null)return!1;if(e.isContentEditable)return!0;const t=e.tagName;if(!t)return!1;const s=t.toUpperCase();return s==="INPUT"||s==="TEXTAREA"||s==="SELECT"}function Hr(){window._edsKeyboardCopyPasteBound!==!0&&(window._edsKeyboardCopyPasteBound=!0,window.addEventListener("keydown",i=>{var c;if(!(i.ctrlKey||i.metaKey)||Cr(i.target))return;const e=((c=i.key)!=null?c:"").toLowerCase();if(e!=="c"&&e!=="v")return;const t=Ye!=null?Ye:Fs;if(t==null||Date.now()>Nt)return;const s=globalThis.structure.getElectroItemById(t);if(s==null)return;if(i.shiftKey&&e==="c"){Oe=t,ve(t),i.preventDefault(),i.stopPropagation();return}if(i.shiftKey&&e==="v"){if(Oe==null)return;const l=Oe,d=i.altKey?"before":"after";Lt(t,d,l),ve(t),i.preventDefault(),i.stopPropagation();return}if(e==="c"){Ot(t),ve(t),i.preventDefault(),i.stopPropagation();return}if(le==null)return;const a=I(le.type),r=I(s.getType());if(a!==""&&a===r){Ke(t,{replaceType:!1}),ve(t),i.preventDefault(),i.stopPropagation();return}const n=qs(s,t);confirm(`Replace settings of ${n} with copied ${a||"element"} settings?

If the type differs, the element type will be updated too.`)&&(Ke(t,{replaceType:!0}),ve(t),i.preventDefault(),i.stopPropagation())}))}function Br(i){if(i._edsHoverTargetTrackingBound===!0)return;i._edsHoverTargetTrackingBound=!0;let e=0;i.addEventListener("mousemove",t=>{const s=Date.now();if(s-e<40)return;e=s;const a=t.target;if(a==null)return;const r=a.closest("#EDS");if(r==null){gt(null);return}const n=Vt(t,a,r);n!=null&&gt(n)}),i.addEventListener("mouseleave",()=>{gt(null)})}let le=null;function zr(i,e){const t=Be(e!=null?e:{});return I(i)!=="Vrije tekst"&&t&&typeof t=="object"&&(delete t.tekst,delete t.Tekst),t}function Ot(i){var s,a;const e=globalThis.structure.getElectroItemById(i);if(e==null)return;const t=I((a=(s=e.getType)==null?void 0:s.call(e))!=null?a:"");le={type:t,props:zr(t,e.props)}}function Ke(i,e={}){var h,p,u,g,b,_,v,T,U,E;if(le==null)return;const t=globalThis.structure.getElectroItemById(i);if(t==null)return;const s=(h=t.props)==null?void 0:h.nr,a=(p=t.props)==null?void 0:p.adres,r=(u=t.props)==null?void 0:u.isAttribuut,n=(g=t.props)==null?void 0:g.tekst,o=I(le.type),c=I((_=(b=t.getType)==null?void 0:b.call(t))!=null?_:"");e.replaceType===!0&&o!==""&&o!==c&&globalThis.structure.adjustTypeById(i,o);const l=globalThis.structure.getElectroItemById(i);if(l==null)return;const d=Be((v=le.props)!=null?v:{});if(s!=null&&(d.nr=s),a!=null&&(d.adres=a),r!=null&&(d.isAttribuut=r),!Object.prototype.hasOwnProperty.call(d!=null?d:{},"tekst")&&n!=null&&(d.tekst=n),d.type=I((E=(U=(T=l.getType)==null?void 0:T.call(l))!=null?U:d.type)!=null?E:""),l.props=d,l.getType()=="Domotica gestuurde verbruiker"&&globalThis.structure.voegAttributenToeAlsNodigEnReSort(),globalThis.undostruct.store(),ce())globalThis.HLRedrawTreeHTML();else{globalThis.structure.reNumber();const f=l.getParent();f!==null?globalThis.structure.updateHTMLinner(f.id):globalThis.structure.updateHTMLinner(i)}if(globalThis.HLRedrawTreeSVG(),globalThis.treeEditInModal===!0){const f=globalThis._edsTreeModalOpenId;f!=null&&f===i&&Te(i)}}function ls(i){if(i==null)return!1;const e=i.getType();return e==="Zekering"||e==="Kring"}function qs(i,e){var a,r,n,o;const t=i.getType();if(t==="Kring"){const c=I((r=(a=i.props)==null?void 0:a.naam)!=null?r:"");return c!==""?`Kring ${c}`:`Kring #${e}`}const s=I((o=(n=i.getReadableAdres)==null?void 0:n.call(i))!=null?o:"");return s!==""?`${t} ${s}`:`${t} #${e}`}function Kr(i){i._edsRightClickCopyPasteBound!==!0&&(i._edsRightClickCopyPasteBound=!0,window.addEventListener("click",()=>{se&&se.hide()}),i.addEventListener("contextmenu",e=>{const t=e.target;if(t==null)return;const s=t.closest("#EDS");if(s==null)return;e.preventDefault();const a=Vt(e,t,s);if(a==null)return;Ws(a);const r=globalThis.structure.getElectroItemById(a);if(r==null)return;se==null&&(se=new Ks(document.body)),se.clearMenu();const n=qs(r,a);if(se.addMenuItem("Copy settings",()=>{Ot(a)}),le!=null){const o=I(le.type),c=I(r.getType());o!==""&&o===c?se.addMenuItem("Paste settings",()=>{Ke(a,{replaceType:!1})}):se.addMenuItem("Replace with copied settings",()=>{confirm(`Replace settings of ${n} with copied ${o||"element"} settings?

If the type differs, the element type will be updated too.`)&&Ke(a,{replaceType:!0})})}if(ls(r)&&(se.addLine(),se.addMenuItem("Copy circuit",()=>{Ie=a})),se.addLine(),se.addMenuItem("Delete "+n+"…",()=>{confirm("Delete "+n+`?

This will also delete child elements.`)&&(Ie===a&&(Ie=null),Oe===a&&(Oe=null),globalThis.HLDelete(a))}),Ie!=null){const o=globalThis.structure.getElectroItemById(Ie);ls(o)&&(se.addLine(),se.addMenuItem("Paste left of "+n,()=>{Lt(a,"before")}),se.addMenuItem("Paste right of "+n,()=>{Lt(a,"after")}))}se.addLine(),se.addMenuItem("Tip: click-highlight in tree",null,"Ctrl/Cmd",{disabled:!0,hint:!0}),se.show(e)}))}function Lt(i,e,t){const s=t!=null?t:Ie;if(s==null)return;const a=globalThis.structure.getElectroItemById(i);if(a==null)return;const r=a.getParent(),n=globalThis.structure.cloneRelativeToId(s,i,e);n!=null&&(globalThis.undostruct.store(),r!==null&&!ce()?(globalThis.structure.reNumber(),globalThis.structure.updateHTMLinner(r.id),globalThis.HLRedrawTreeSVG()):globalThis.HLRedrawTree(),ve(n))}function Vt(i,e,t){const s=i;if(typeof s.composedPath=="function"){const r=s.composedPath();for(let n=0;n<r.length;n++){const o=r[n];if(o&&typeof o.getAttribute=="function"){const c=o.getAttribute("data-eds-id"),l=c!=null?Number(c):NaN;if(Number.isFinite(l)&&l>0)return l}if(o===t)break}}const a=e.closest("[data-eds-id]");if(a!=null){const r=a.getAttribute("data-eds-id"),n=r!=null?Number(r):NaN;if(Number.isFinite(n)&&n>0)return n}if(typeof document.elementsFromPoint=="function"){const r=document.elementsFromPoint(i.clientX,i.clientY);for(let n=0;n<r.length;n++){const o=r[n];if(o.closest("#EDS")==null)continue;const c=o.closest("[data-eds-id]");if(c!=null){const l=c.getAttribute("data-eds-id"),d=l!=null?Number(l):NaN;if(Number.isFinite(d)&&d>0)return d}}}return Nr(t,i.clientX,i.clientY,14)}function Nr(i,e,t,s){const a=i.querySelectorAll("[data-eds-id]");let r=null,n=s*s;for(let o=0;o<a.length;o++){const c=a[o],l=c.getAttribute("data-eds-id");if(l==null||l===""||l==="0")continue;const d=Number(l);if(!Number.isFinite(d)||d<=0)continue;const h=c.getBoundingClientRect();if(h.width===0&&h.height===0)continue;const p=e<h.left?h.left-e:e>h.right?e-h.right:0,u=t<h.top?h.top-t:t>h.bottom?t-h.bottom:0,g=p*p+u*u;g<=n&&(n=g,r=d)}return r}globalThis.HLRedrawTree=()=>{globalThis.HLRedrawTreeHTML(),globalThis.HLRedrawTreeSVG()};function Or(i){let e=0;switch(i.addItem("Aansluiting"),i.data[0].props.type="Aansluiting",i.data[0].props.naam="",i.data[0].props.bescherming="differentieel",i.data[0].props.aantal_polen=Ve,i.data[0].props.amperage=Et,i.data[0].props.type_kabel_na_teller=Ve+"x16",i.data[0].props.differentieel_delta_amperage=ei,e++,i.insertChildAfterId(new yt(i),e),i.data[e].props.type="Bord",e++,i.insertChildAfterId(new us(i),e),i.data[e].props.type="Kring",i.data[e].props.autoKringNaam="manueel",i.data[e].props.bescherming="differentieel",i.data[e].props.aantal_polen=Qs,i.data[e].props.amperage=Et,i.data[e].props.kabel_is_aanwezig=!1,i.data[e].props.differentieel_delta_amperage=$r,e++,i.insertChildAfterId(new yt(i),e),i.data[e].props.type="Bord",i.data[e].props.is_geaard=!1,e++,Ve){case 2:i.properties.info="2 x 230V ~50 Hz";break;case 3:i.properties.info="3 x 230V ~50 Hz";break;case 4:i.properties.info="3 x 400V + N ~50 Hz"}}function Vr(){globalThis.structure!=null&&globalThis.structure.dispose(),globalThis.structure=new fs,Or(globalThis.structure),globalThis.topMenu.selectMenuItemByName("Eéndraadschema"),globalThis.undostruct.clear(),globalThis.undostruct.store()}function Js(){var i="";return globalThis.structure.properties.control||(globalThis.structure.properties.control="<br>"),i='Plaats van de elektrische installatie<table width="90%" cols="1" rows="1" style="border-collapse: collapse;border-style: solid; border-width:thin;" cellpadding="5"><tr><td style="border-style: solid; border-width:thin;" contenteditable="true" valign="top" id="conf_owner" onblur="javascript:forceUndoStore()" onkeyup="javascript:changeAddressParams()">'+globalThis.structure.properties.owner+'</td></tr></table><br>Installateur<table width="90%" cols="1" rows="1" style="border-collapse: collapse;border-style: solid; border-width:thin;" cellpadding="5"><tr><td style="border-style: solid; border-width:thin;" contenteditable="true" valign="top" id="conf_installer" onblur="javascript:forceUndoStore()" onkeyup="javascript:changeAddressParams()">'+globalThis.structure.properties.installer+'</td></tr></table><br>Erkend organisme (keuring)<table width="90%" cols="1" rows="1" style="border-collapse: collapse;border-style: solid; border-width:thin;" cellpadding="5"><tr><td style="border-style: solid; border-width:thin;" contenteditable="true" valign="top" id="conf_control" onblur="javascript:forceUndoStore()" onkeyup="javascript:changeAddressParams()">'+globalThis.structure.properties.control+'</td></tr></table><br>Info <i>(wordt overschreven bij handmatig pagineren in het print-menu)</i><table width="90%" cols="1" rows="1" style="border-collapse: collapse;border-style: solid; border-width:thin;" cellpadding="5"><tr><td style="border-style: solid; border-width:thin;" contenteditable="true" valign="top" id="conf_info" onblur="javascript:forceUndoStore()" onkeyup="javascript:changeAddressParams()">'+globalThis.structure.properties.info+"</td></tr></table>",i}globalThis.changeAddressParams=()=>{globalThis.structure.properties.owner=document.getElementById("conf_owner").innerHTML,globalThis.structure.properties.installer=document.getElementById("conf_installer").innerHTML,globalThis.structure.properties.control=document.getElementById("conf_control").innerHTML,globalThis.structure.properties.info=document.getElementById("conf_info").innerHTML};function Dr(){var i=Qa;i=i.replace(/Bewerken/g,"Eéndraadschema");const e=document.getElementById("configsection");e!=null&&(e.innerHTML=i),globalThis.toggleAppView("config")}function Zs(){globalThis.currentShareId=null;var i=globalThis.CONFIGPAGE_LEFT;if(i+=`
      Hoofddifferentieel (in mA) <input id="differentieel_droog" type="text" size="5" maxlength="5" value="300"><br><br>
      Hoofdzekering (in A) <input id="hoofdzekering" type="text" size="4" maxlength="4" value="65"><br><br>
      Aantal fazen:
      <select id="aantal_fazen_droog"><option value="2">2p</option><option value="3">3p</option><option value="4">4p (3p+n)</option></select>`,i+=globalThis.CONFIGPAGE_RIGHT,i+=er(),i+="<h2>Recent toegevoegde functionaliteiten</h2>",Array.isArray(ut)){i+='<table style="width:100%;border-collapse:collapse;">';for(let t=0;t<Math.min(10,ut.length);t++){const s=ut[t];i+=`
                <tr>
                    <td style="vertical-align:top; font-weight:bold; white-space:nowrap; padding-right:10px;">${s.date}</td>
                    <td style="vertical-align:top;">${s.msg}</td>
                </tr>
            `}i+="</table>"}const e=document.getElementById("configsection");e!=null&&(e.innerHTML=i),globalThis.toggleAppView("config"),hi()&&alert("Deze appicatie werkt niet in Internet Explorer. Wij raden aan een moderne browser te gebruiken zoals Edge, Firefox, Google Chrome, Opera, Vivaldi, ...")}globalThis.toggleAppView=i=>{let e=globalThis.structure.properties.currentView;globalThis.structure.sitplanview!=null&&globalThis.structure.sitplanview.contextMenu!=null&&globalThis.structure.sitplanview.contextMenu.hide(),globalThis.structure.properties.currentView=i;const t=document.getElementById("configsection"),s=document.getElementById("outerdiv"),a=document.getElementById("ribbon"),r=document.getElementById("canvas_2col"),n=document.getElementById("left_col_inner"),o=document.getElementById("EDSSVG");if(i==="2col"){if(t==null||s==null||a==null||r==null)return;r.style.display==="none"&&(a.style.display="flex",r.style.display="flex",t.style.display="none",s.style.display="none",t.innerHTML="",globalThis.structure.updateRibbon())}else if(i==="config"){if(t==null||s==null||a==null||n==null||r==null)return;t.style.display==="none"&&(t.style.display="block",s.style.display="none",a.style.display="none",a.innerHTML=""),n.innerHTML="",r.style.display="none"}else if(i==="draw"){if(t==null||s==null||a==null||n==null||r==null)return;s.style.display==="none"&&(s.style.display="flex",a.style.display="flex",t.style.display="none",r.style.display="none",t.innerHTML="",n.innerHTML="",o!==null&&(o.innerHTML=""))}["2col","draw"].includes(i)&&["2col","draw"].includes(e)&&i!==e&&globalThis.undostruct.store()};globalThis.load_example=i=>{switch(globalThis.currentShareId=null,i){case 0:ne(globalThis.EXAMPLE0),globalThis.fileAPIobj.clear();break;case 1:ne(globalThis.EXAMPLE1),globalThis.fileAPIobj.clear();break}};globalThis.undoClicked=()=>{globalThis.structure.sitplanview!=null&&globalThis.structure.sitplanview.contextMenu!=null&&globalThis.structure.sitplanview.contextMenu.hide(),globalThis.undostruct.undo()};globalThis.redoClicked=()=>{globalThis.structure.sitplanview!=null&&globalThis.structure.sitplanview.contextMenu!=null&&globalThis.structure.sitplanview.contextMenu.hide(),globalThis.undostruct.redo()};globalThis.read_settings=()=>{Ve=parseInt(document.getElementById("aantal_fazen_droog").value),Qs=Ve,Et=parseInt(document.getElementById("hoofdzekering").value),ei=parseInt(document.getElementById("differentieel_droog").value),globalThis.fileAPIobj.clear(),Vr()};const Xs=document.getElementById("container");if(Xs==null)throw new Error("HTML element container is null");Xs.innerHTML=`
<div id="topmenu"><ul id="minitabs"></ul></div>
<div id="app">
<svg id="svgdefs"></svg> \x3C!-- Bevat SVG patronen die app-wide gebruikt worden -->
<div id="configsection" class="configsection">
    <div style="display:flex;align-items:center;justify-content:center;height:100vh;font-size:larger;font-weight:bold; text-align: center;">
    De App wordt geladen.<br><br>Even geduld..
    </div>
</div> \x3C!-- Full page configuratie --> 
<div id="ribbon" style="display:none;">
    <div id="left-icons" class="left-icons"></div>
    <div id="right-icons" class="right-icons"></div>
</div> \x3C!-- Ribbon -->
<div id="canvas_2col" style="display:none;"> \x3C!-- Eendraadschema-->
    <div id="left_col">
    <div id="left_col_inner"></div>
    </div>
    <div id="right_col">
    <div id="right_col_inner"></div>
    </div>
</div>
<div id="outerdiv" style="display:none;"> \x3C!-- Situatieschets -->
    <div id="sidebar"></div>
    <div id="canvas">
    <div id="paper"></div>
    </div>
</div>
</div>`;const Ys=document.getElementById("svgdefs");if(Ys==null)throw new Error("HTML element svgdefs is null");Ys.innerHTML='<pattern id="VerticalStripe" x="5" y="0" width="5" height="10" patternUnits="userSpaceOnUse" ><line x1="0" y1="0" x2="0" y2="10" stroke="black" /></pattern>';document.getElementById("importfile")||(document.body.innerHTML+=`
    <input id="importfile" type="file" accept=".eds" onchange="importjson(event)" style="display:none;">
    <input id="appendfile" type="file" accept=".eds" onchange="appendjson(event)" style="display:none;">
    <input type="file" id="fileInput" accept="image/*" style="display:none;">
  `);var Ve=2,Qs=2,Et=65,ei=300,$r=30;let ti;const It=[{name:"Nieuw",callback:Zs},{name:"Bestand",callback:Bs},{name:"Eéndraadschema",callback:globalThis.HLRedrawTree},{name:"Situatieschema",callback:Ns},{name:"Print",callback:fe},{name:"Documentatie",callback:tr},{name:"Info/Contact",callback:Dr}];function jr(i){return i?{Authorization:`Bearer ${i}`}:{}}async function Rr(i){try{const e=await fetch("/api/me",{headers:jr(i)});if(!e.ok)return!1;const t=await e.json();return!!(t!=null&&t.isAdmin)}catch(e){return!1}}async function cs(){if(!D.isEnabled())return;const i=await D.getAccessToken(),e=!!i,t=i?await Rr(i):!1,s=[...It.slice(0,2),...e?[{name:"Beheer",callback:()=>{var a;(a=globalThis.openShareTeamsScreen)==null||a.call(globalThis)}}]:[],...t?[{name:"Admin",callback:()=>{var a;(a=globalThis.openAdminScreen)==null||a.call(globalThis)}}]:[],...It.slice(2)];globalThis.topMenu.setMenuItems(s)}ti=[...It];globalThis.topMenu=new oi("minitabs","menu-item",ti);let At=null;const ds=document.getElementById("minitabs");if(ds){const i=document.createElement("li");i.className="menu-item menu-item-right";const e=document.createElement("button");e.type="button",e.className="theme-toggle topmenu-hamburger",e.id="topmenu-hamburger",e.textContent="☰",e.setAttribute("aria-label","Menu"),e.title="Menu";const t=document.createElement("div");t.className="topmenu-dropdown",t.hidden=!0;const s=o=>{t.hidden=!o,e.setAttribute("aria-expanded",o?"true":"false")},a=()=>s(t.hidden),r=document.createElement("button");r.type="button",r.id="theme-toggle",r.className="theme-toggle";const n=o=>{const c=o==="dark"?"Licht":"Donker";r.textContent=c,r.setAttribute("aria-label",`Schakel naar ${c.toLowerCase()}e modus`),r.title=`Schakel naar ${c.toLowerCase()}e modus`};if(r.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),lr(),s(!1)}),t.appendChild(r),D.isEnabled()){const o=document.createElement("span");o.className="topmenu-auth-user";const c=document.createElement("button");c.type="button",c.className="theme-toggle",c.textContent="Beheer",c.setAttribute("aria-label","Beheer delen en teams"),c.title="Beheer delen en teams",c.style.display="none",c.onclick=async h=>{h.preventDefault(),h.stopPropagation(),typeof globalThis.openShareTeamsScreen=="function"?await globalThis.openShareTeamsScreen():alert("Beheer scherm is niet beschikbaar."),s(!1)};const l=document.createElement("button");l.type="button",l.className="theme-toggle";const d=async()=>{const h=await D.getProfile();h?(o.textContent=h.name||h.email||h.sub,o.style.display="",c.style.display="",l.textContent="Afmelden",l.setAttribute("aria-label","Afmelden"),l.title="Afmelden",l.onclick=async p=>{p.preventDefault(),p.stopPropagation(),await D.logout(),await d(),await cs(),s(!1)}):(o.textContent="",o.style.display="none",c.style.display="none",l.textContent="Aanmelden",l.setAttribute("aria-label","Aanmelden"),l.title="Aanmelden",l.onclick=async p=>{p.preventDefault(),p.stopPropagation(),await D.login()}),await cs()};At=d,d(),t.appendChild(o),t.appendChild(c),t.appendChild(l)}e.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),a()}),document.addEventListener("click",o=>{if(t.hidden)return;const c=o.target;c&&i.contains(c)||s(!1)}),window.addEventListener("keydown",o=>{o.key==="Escape"&&s(!1)}),i.appendChild(e),i.appendChild(t),ds.appendChild(i),dr(n),n(document.documentElement.dataset.theme==="dark"?"dark":"light")}const si=document.querySelector("#left_col_inner");if(si==null)throw new Error("HTML element left_col_inner is null");function Ur(i,e,t,s){const a=globalThis.structure.getElectroItemById(i);if(a!=null){switch(t){case"select-one":if(e=="type")if(globalThis.structure.adjustTypeById(i,s),ce())globalThis.HLRedrawTreeHTML();else{globalThis.structure.reNumber();const r=a.getParent();r!==null?globalThis.structure.updateHTMLinner(r.id):globalThis.structure.updateHTMLinner(i)}else a.props[e]=s,ce()?globalThis.HLRedrawTreeHTML():(globalThis.structure.reNumber(),globalThis.structure.updateHTMLinner(i));break;case"text":a.props[e]=s,globalThis.structure.reNumber(),e==="kortsluitvermogen"&&(ce()?globalThis.HLRedrawTreeHTML():globalThis.structure.updateHTMLinner(i));break;case"checkbox":a.props[e]=s,ce()?globalThis.HLRedrawTreeHTML():(globalThis.structure.reNumber(),globalThis.structure.updateHTMLinner(i));break}a.getType()=="Domotica gestuurde verbruiker"&&globalThis.structure.voegAttributenToeAlsNodigEnReSort(),globalThis.undostruct.store(),globalThis.HLRedrawTreeSVG()}}function ii(i){const e=i;if(e==null||typeof e.id!="string"||!e.id.startsWith("HL_edit_"))return;const t=e.id,s=e.type,a=s==="checkbox"?e.checked:e.value,r=t.match(/^HL_edit_(\d+)_(.+)$/),n=r?r[1]:null,o=r?r[2]:null;n==null||o==null||Ur(parseInt(n),o,s,a)}si.addEventListener("change",function(i){ii(i.target)});async function Gr(){try{let i=function(){try{const o=window.location.href.split("#")[0];window.history.replaceState(null,document.title,o)}catch(o){}},e=function(o){try{const c=document.getElementById("eds_share_toast");c&&c.remove();const l=document.createElement("div");l.id="eds_share_toast",l.textContent=o,l.style.position="fixed",l.style.right="16px",l.style.bottom="16px",l.style.zIndex="99999",l.style.padding="10px 12px",l.style.borderRadius="8px",l.style.background="rgba(0,0,0,0.85)",l.style.color="white",l.style.fontSize="13px",l.style.maxWidth="60vw",l.style.boxShadow="0 8px 24px rgba(0,0,0,0.25)",l.style.pointerEvents="none",document.body.appendChild(l),setTimeout(()=>{l.remove()},2600)}catch(c){}},t=function(o){let c=o.replace(/-/g,"+").replace(/_/g,"/");for(;c.length%4!==0;)c+="=";return c},s=function(o){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o)};const a=window.location.hash&&window.location.hash.startsWith("#")?window.location.hash.slice(1):window.location.hash;if(!a)return!1;const r=new URLSearchParams(a),n=r.get("share")||r.get("s");if(!n)return!1;if(n.startsWith("EDS")&&n.length>10){globalThis.currentShareId=null;const o=n.substring(0,10),c=n.substring(10),l=o+t(c);return ne(l,!0,!0),globalThis.structure.sitplan&&(globalThis.structure.sitplan.activePage=1),i(),e("Schema geladen uit deel-link."),!0}if(n.startsWith("TXT")&&n.length>10){globalThis.currentShareId=null;const o=n.substring(0,10),c=n.substring(10),l=o+decodeURIComponent(c);return ne(l,!0,!0),globalThis.structure.sitplan&&(globalThis.structure.sitplan.activePage=1),i(),e("Schema geladen uit deel-link."),!0}if(s(n)){const o=n;globalThis.currentShareId=o;const c=await fetch(`/api/shares/${o}`,{credentials:"include"});if(!c.ok)return console.warn("Share API error:",c.status,await c.text()),alert("Kon het schema niet laden uit de deel-link (serverfout)."),!1;const l=await c.json();return!l||typeof l.schema!="string"||l.schema.length<10?(alert("Kon het schema niet laden uit de deel-link (ongeldig antwoord)."),!1):(ne(l.schema,!0,!0),globalThis.structure.sitplan&&(globalThis.structure.sitplan.activePage=1),i(),e("Schema geladen uit deel-link."),!0)}return console.warn("Onbekend share-formaat in URL."),!1}catch(i){return console.error("Fout bij laden van deel-link:",i),alert("Kon het schema niet laden uit de deel-link (de link is mogelijk beschadigd of te oud)."),!1}}ne(globalThis.EXAMPLE_DEFAULT,!1);globalThis.autoSaver=new Tt(5,()=>globalThis.structure);globalThis.autoSaver.setCallbackAfterSave((()=>{let i=globalThis.autoSaver.getSavedType();function e(){const t=globalThis.autoSaver.getSavedType();i!==t&&(i=t,globalThis.structure.updateRibbon(),globalThis.structure.sitplanview&&globalThis.structure.sitplanview.updateRibbon())}return e})());let hs=!1,qe=null,Je=null;(async()=>{await Er(),At&&await At(),[qe,Je]=await globalThis.autoSaver.loadLastSaved();try{const i=Je;globalThis.currentShareId=i!=null&&i.shareId?String(i.shareId):null}catch(i){globalThis.currentShareId=null}qe!=null&&(hs=!0)})().then(async()=>{if(await Gr()){new pt().run(),globalThis.autoSaver.start();return}if(!hs)ne(globalThis.EXAMPLE_DEFAULT,!1),Zs(),new pt().run();else{if(new Pe(globalThis.appDocStorage).show("file.autoRecovered",`<h3>Laatste schema geladen uit browsercache</h3><p>Deze tool vond een schema in de browsercache. Dit schema dateert van <b>${Je.currentTimeStamp}</b> met als naam <b>${Je.filename}</b>. U kan op dit gerecupereerde schema verder werken of een ander schema laden in het "Bestand"-menu.</p><p><b>Opgelet! </b>De browsercache is een tijdelijke opslag, en wordt occasioneel gewist. Het blijft belangrijk uw werk regelmatig op te slaan om gegevensverlies te voorkomen.</p>`,!1,(()=>{new pt().run()}).bind(void 0)),qe==null)return;ne(qe,!0,!0),globalThis.structure.sitplan&&(globalThis.structure.sitplan.activePage=1)}globalThis.autoSaver.start()});</script>
    <style rel="stylesheet" crossorigin>:root{--selectPadding: 2;--paperPadding: 10px;--menu-height: 40px;--ribbon-height: 68px;--status-bar-height: 0px;--sideBarWidth: 260px;--total-offset: calc(var(--menu-height) + var(--ribbon-height) + var(--status-bar-height));--EDStekenFoutKleur: #8C5A00;--bg: #ffffff;--text: #111827;--muted-text: #6b7280;--surface-1: #f8f8f8;--surface-2: #e8e8e8;--border: #c8c8c8;--border-strong: #b8b8b8;--hover: #cccccc;--menu-bg: var(--surface-2);--ribbon-bg: var(--surface-1);--canvas-bg: var(--bg);--popup-bg: var(--bg);--context-bg: #f0f0f0;--context-hover: #e0e0e0;--link: #0066ff;--menu-link: #555565;--menu-link-hover: #333333;--menu-current: #0066ff;--menu-accent: #ff6600;--eds-ink: #000000;--eds-ink-on-dark: #e5e7eb;color-scheme:light}html[data-theme=dark]{--bg: #0b1220;--text: #e5e7eb;--muted-text: #9ca3af;--surface-1: #0f172a;--surface-2: #111c33;--border: #26324b;--border-strong: #33415e;--hover: #1f2a44;--menu-bg: var(--surface-2);--ribbon-bg: var(--surface-1);--canvas-bg: #0b1220;--popup-bg: #0f172a;--context-bg: #0f172a;--context-hover: #142041;--link: #7aa7ff;--menu-link: #cbd5e1;--menu-link-hover: #ffffff;--menu-current: #7aa7ff;--menu-accent: #ff9a3c;--eds-ink: var(--eds-ink-on-dark);color-scheme:dark}html[data-theme=dark] #EDS{background-color:#fff;color:#000;--eds-ink: #000000;display:inline-block;padding:12px;border-radius:8px;box-shadow:0 2px 10px #00000059}#EDS svg,#EDSSVG{color:var(--eds-ink)}#EDS svg text,#EDSSVG text,.svg-icon text{fill:var(--eds-ink)!important}#EDS svg [stroke=black],#EDS svg [stroke="#000"],#EDS svg [stroke="#000000"],#EDSSVG [stroke=black],#EDSSVG [stroke="#000"],#EDSSVG [stroke="#000000"],.svg-icon [stroke=black],.svg-icon [stroke="#000"],.svg-icon [stroke="#000000"],#EDS svg [style*="stroke:black"],#EDS svg [style*="stroke: black"],#EDSSVG [style*="stroke:black"],#EDSSVG [style*="stroke: black"],.svg-icon [style*="stroke:black"],.svg-icon [style*="stroke: black"]{stroke:var(--eds-ink)!important}#EDS svg [fill=black],#EDS svg [fill="#000"],#EDS svg [fill="#000000"],#EDSSVG [fill=black],#EDSSVG [fill="#000"],#EDSSVG [fill="#000000"],.svg-icon [fill=black],.svg-icon [fill="#000"],.svg-icon [fill="#000000"],#EDS svg [style*="fill:black"],#EDS svg [style*="fill: black"],#EDSSVG [style*="fill:black"],#EDSSVG [style*="fill: black"],.svg-icon [style*="fill:black"],.svg-icon [style*="fill: black"]{fill:var(--eds-ink)!important}*{box-sizing:border-box}html{height:100%;background-color:var(--bg)}body{margin:0;padding:0;cursor:default;color:var(--text);background-color:var(--bg)}.spinner{display:none;width:50px;height:50px;border:5px solid rgba(0,0,0,.1);border-top:5px solid #000;border-radius:50%;animation:spin 1s linear infinite;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading .spinner{display:block}button,select,select option,input[type=checkbox]{cursor:pointer}select option{background-color:var(--surface-1);color:var(--text)}td[contenteditable=true]{cursor:text}.container{width:100vw;height:100vh}#topmenu{height:var(--menu-height);width:100%;background-color:var(--menu-bg);align-items:center;padding:0 7px;border-bottom:1px solid var(--border-strong);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}ul#minitabs{display:flex;height:100%;list-style:none;margin:0;padding:1px 0;font-weight:700;text-align:left;align-items:center;white-space:nowrap}ul#minitabs li,ul#minitabs li.menu-item{display:inline;margin:0 6px}ul#minitabs a{text-decoration:none;padding:0 0 3px;border-bottom:4px solid var(--menu-bg);color:var(--menu-link)}ul#minitabs a#current{border-color:var(--menu-accent);color:var(--menu-current)}ul#minitabs a:hover{border-color:var(--menu-accent);color:var(--menu-link-hover);cursor:pointer}ul#minitabs li.menu-item-right{margin-left:auto;position:relative}.topmenu-hamburger{padding:4px 10px}.topmenu-dropdown{position:absolute;right:0;top:calc(100% + 6px);flex-direction:column;gap:6px;padding:8px;background-color:var(--menu-bg);border:1px solid var(--border);border-radius:8px;z-index:1000}.topmenu-dropdown[hidden]{display:none!important}.topmenu-dropdown:not([hidden]){display:flex}.topmenu-auth-user{max-width:220px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600}.theme-toggle{background:transparent;color:var(--text);border:1px solid var(--border);border-radius:8px;padding:4px 10px;font-weight:600}.theme-toggle:hover{background-color:var(--hover)}#ribbon{position:absolute;top:var(--menu-height);height:var(--ribbon-height);left:0;right:0;bottom:0;justify-content:space-between;display:flex;background-color:var(--ribbon-bg);align-items:center;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-bottom:1px solid var(--border);flex-direction:row}#left-icons{top:var(--menu-height);height:var(--ribbon-height);left:0;right:0;bottom:0;justify-content:left;display:flex;background-color:var(--ribbon-bg);align-items:center;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-bottom:1px solid var(--border);flex-direction:row}#right-icons{top:var(--menu-height);height:var(--ribbon-height);left:0;right:0;bottom:0;justify-content:right;display:flex;background-color:var(--ribbon-bg);align-items:center;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-bottom:1px solid var(--border);flex-direction:row}.icon{margin:0 0 0 10px;text-align:center;cursor:pointer;color:var(--text);border-radius:8px;padding:4px}.icon:hover{background-color:var(--hover)}.icon-image{width:32px;height:32px;display:flex;justify-content:center;align-items:baseline;margin:0 auto}.icon-text{display:inline-block;font-size:12px;margin-top:4px;white-space:nowrap}.icon-button{height:50px;margin:0 0 0 5px;text-align:center;cursor:pointer;font-size:24px}.box{position:absolute;background-color:#c0c0c000;border:0px solid #000;cursor:pointer;box-sizing:border-box;transform:rotate(0);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.box[movable=false]{cursor:default}.boxlabel{position:absolute;font-size:11px;background-color:#c0c0c000;border:0px solid #000;cursor:pointer;box-sizing:border-box;transform:rotate(0);display:inline-block;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.boxlabel[movable=false]{cursor:default}.boxlabel.hidden{display:none}.box.selected[movable=false]{border:calc(var(--selectPadding) * 1px) solid red}.box.selected{border:calc(var(--selectPadding) * 1px) solid green}.box.hidden{display:none}body.distance-line-mode #canvas,body.distance-line-mode #paper,body.distance-line-mode .box,body.distance-line-mode .boxlabel{cursor:crosshair!important}#app{flex:1;overflow:hidden}#configsection{position:absolute;top:var(--menu-height);left:0;right:0;bottom:0;overflow:auto;background-color:var(--canvas-bg);padding:12px 8px 8px}#configsection table[border]{border:1px solid var(--border);border-radius:10px;border-collapse:separate!important;border-spacing:0;background-color:var(--bg)}#configsection table[border] td,#configsection table[border] th{border:0;padding:10px}#configsection tr[bgcolor=LightGrey] td,#configsection tr[bgcolor=LightGrey] th,#configsection td[bgcolor=LightGrey]{background-color:var(--surface-2)!important;color:var(--text)}#configsection table[border] thead th{background-color:var(--surface-2);font-weight:700}#configsection table[border] tbody tr+tr td{border-top:1px solid var(--border)}#configsection table[border] tbody tr:hover td{background-color:var(--surface-1)}#configsection button{background:var(--surface-1);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:6px 10px;font-weight:600}#configsection button:hover{background-color:var(--hover)}#configsection input[type=text],#configsection input[type=search],#configsection input[type=email],#configsection input[type=password],#configsection textarea{background:var(--bg);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:6px 10px}#configsection input[type=text]:focus,#configsection input[type=search]:focus,#configsection input[type=email]:focus,#configsection input[type=password]:focus,#configsection textarea:focus,#configsection button:focus{outline:2px solid var(--menu-current);outline-offset:2px}#configsection code{background-color:var(--surface-2);border:1px solid var(--border);border-radius:6px;padding:1px 6px}#canvas_2col{position:absolute;top:calc(var(--menu-height) + var(--ribbon-height));left:0;right:0;bottom:0;overflow:hidden;background-color:var(--canvas-bg);padding:0x;display:flex;flex-direction:row}#outerdiv{display:flex;position:absolute;top:calc(var(--menu-height) + var(--ribbon-height));left:0;right:0;bottom:0;overflow:none;background-color:var(--canvas-bg);padding:0;flex-direction:row}#sidebar{top:0;left:0;width:var(--sideBarWidth);height:100%;overflow:auto;background-color:var(--surface-1);border-right:1px solid var(--border);padding:10px;box-sizing:border-box}.sitplan-sidebar-title{margin:0 0 10px;font-weight:700}.sitplan-sidebar-titlebar{display:flex;align-items:center;justify-content:space-between;gap:10px;margin:0 0 10px}.sitplan-sidebar-titlebar .sitplan-sidebar-title{margin:0}.sitplan-sidebar-actions{display:flex;gap:6px}.sitplan-sidebar-actionbtn{border:1px solid var(--border);border-radius:6px;background:var(--popup-bg);color:var(--text);cursor:pointer;padding:2px 4px;line-height:1;min-width:24px;min-height:22px;display:inline-flex;align-items:center;justify-content:center}.sitplan-sidebar-actionbtn:hover{background:color-mix(in srgb,var(--popup-bg) 85%,white 15%)}.sitplan-sidebar-itemrow{display:flex;align-items:center;gap:8px}.sitplan-sidebar-visbtn{flex:0 0 auto;border:1px solid var(--border);border-radius:6px;background:var(--popup-bg);color:var(--text);cursor:pointer;padding:2px 4px;line-height:1;min-width:24px;min-height:22px;display:inline-flex;align-items:center;justify-content:center}.sitplan-sidebar-visbtn:hover{background:color-mix(in srgb,var(--popup-bg) 85%,white 15%)}.sitplan-sidebar-visbtn:disabled{cursor:default;opacity:.55}.sitplan-sidebar-select{width:100%;margin:6px 0 10px}.sitplan-sidebar-items{display:flex;flex-direction:column;gap:6px}.sitplan-sidebar-item{text-align:left;width:100%;padding:6px 8px;border:1px solid var(--border);border-radius:8px;background:var(--popup-bg);color:var(--text);cursor:pointer;display:flex;align-items:center;justify-content:space-between;gap:10px}.sitplan-sidebar-count{color:var(--muted-text);font-size:12px;white-space:nowrap}.sitplan-sidebar-item:disabled{cursor:default;opacity:.55}.sitplan-sidebar-item:hover{background:color-mix(in srgb,var(--popup-bg) 85%,white 15%)}#canvas{display:flex;position:absolute;top:0;left:var(--sideBarWidth);right:0;bottom:0;overflow:auto;background-color:var(--canvas-bg);padding:0;flex-direction:row}#paper{top:var(--paperPadding);left:var(--paperPadding);width:277mm;height:150mm;background-color:#fff;box-shadow:0 4px 8px #0003,0 6px 20px #00000030;border-radius:5px;position:absolute}#left_col{flex:.35;overflow:auto}#right_col{flex:.65;overflow:auto}#left_col_inner,#right_col_inner{padding:10px;color:var(--text)}#EDS,#EDS #EDSSVG,#EDS [data-eds-id]{cursor:default}html.eds-modifier-active #EDS,html.eds-modifier-active #EDS #EDSSVG,html.eds-modifier-active #EDS [data-eds-id]{cursor:pointer}table.html_edit_table{width:"100%"}table.html_edit_table td:nth-child(1){border-radius:10px;border-collapse:collapse;padding:2px;font-size:150%;text-align:center;cursor:pointer}table.html_edit_table td:nth-child(2){width:"100%";border-collapse:collapse;padding:2px 2px 2px 5px}table.html_edit_table.eds-tree-flash{outline:2px solid rgba(255,170,0,.95);border-radius:6px;animation:edsTreeFlashPulse 2.5s ease-in-out 1}table.html_edit_table.eds-tree-flash td:nth-child(2){background-color:#ffeb788c;transition:background-color .12s ease-in-out}table.html_edit_table.tree-dragging{opacity:.45}table.html_edit_table.tree-drop-before{box-shadow:inset 0 3px #0078d4e6}table.html_edit_table.tree-drop-after{box-shadow:inset 0 -3px #0078d4e6}.tree-drag-handle{display:inline-block;margin-right:8px;padding:1px 6px;border-radius:6px;background:#0078d41f;color:#003c78f2;font-weight:700;user-select:none;cursor:grab}table.html_edit_table.tree-dragging .tree-drag-handle{cursor:grabbing}table.html_edit_table td.hl-collapse-cell{width:16px;min-width:16px;max-width:16px;padding:3px 1px 0;text-align:center;vertical-align:top;font-size:11px;line-height:1.1}table.html_edit_table td.hl-collapse-cell .hl-collapse-icon{position:relative;top:1px;display:inline-block}.hl-open-modal-label{cursor:pointer;color:var(--text)}.hl-open-modal-label:hover{text-decoration:underline}.hl-quick-actions{display:inline-flex;align-items:center;gap:2px;margin-right:4px}.eds-tree-modal{width:min(980px,94vw);max-height:88vh;overflow:hidden;padding:10px 14px 14px}.eds-tree-modal-header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:8px}.eds-tree-modal-preview{width:160px;height:96px;flex:0 0 auto;border:1px solid var(--border);border-radius:10px;background:var(--surface-1);display:flex;align-items:center;justify-content:center;overflow:hidden}.eds-tree-modal-actions{display:inline-flex;gap:6px;align-items:center;flex:0 0 auto}.eds-tree-modal-action{border:1px solid var(--border);background:transparent;color:var(--text);border-radius:8px;padding:6px 10px;font-size:12px}.eds-tree-modal-action:hover:not(:disabled){background:#0000000d}.eds-tree-modal-action:disabled{opacity:.5;cursor:not-allowed}.eds-tree-modal-preview svg{display:block}@media(max-width:560px){.eds-tree-modal-preview{display:none}}.eds-tree-modal-title{font-weight:700;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.eds-tree-modal-close{border:1px solid var(--border);background:transparent;color:var(--text);border-radius:8px;width:32px;height:32px;cursor:pointer;font-size:20px;line-height:28px}.eds-tree-modal-close:hover{background:#0000000d}.eds-tree-modal-body{max-height:calc(88vh - 64px);overflow:auto;padding-right:6px}.eds-tree-modal-body .eds-prop-grid{display:flex;flex-direction:column;gap:8px}.eds-tree-modal-body .eds-prop-row{border:1px solid var(--border);border-radius:10px;padding:8px 10px;background:var(--surface-1);line-height:1.35}.eds-tree-modal-body .eds-prop-row:empty{display:none}.eds-tree-modal-body .eds-prop-section-spacer{height:2px;margin:2px 0;border-top:1px dashed var(--border)}.eds-tree-modal-body .eds-prop-row input[type=text],.eds-tree-modal-body .eds-prop-row select{margin:2px}.eds-tree-modal-body .eds-inline-checkbox-label{cursor:pointer;user-select:none}html[data-theme=dark] table.html_edit_table.eds-tree-flash td:nth-child(2){background-color:#ffd25a38}@keyframes edsTreeFlashPulse{0%,10%{outline-color:#ffaa00f2}20%{outline-color:#fa00}30%{outline-color:#ffaa00f2}40%{outline-color:#fa00}50%{outline-color:#ffaa00f2}60%,to{outline-color:#fa00}}#config{padding-left:7px;padding-right:7px;min-width:100%;min-height:0px}#AJAX_sent,#AJAX_received,#AJAX_draw{padding:0;color:#000}html[data-theme=dark] #AJAX_sent,html[data-theme=dark] #AJAX_received,html[data-theme=dark] #AJAX_draw{color:var(--text)}.onlypointer{cursor:pointer}p{font-size:16px;line-height:16px}div.kring{background-color:#fc9}div.verbruiker{background-color:#ffc}table{border-collapse:collapse}.highlight-warning,.highlight-warning-big{background-color:#ffd1d1;border:1px solid #FF6347;padding:4px 5px;font-weight:400;font-size:smaller;color:#b22222}.highlight-ok-big{background-color:#cfc;border:1px solid #33CC33;padding:4px 5px;font-weight:400;font-size:smaller;color:#060}.EDS-tekenfout{background-color:#fff9e5;border:1px solid #E6C97A;padding:4px 5px;font-weight:400;font-size:smaller;color:var(--EDStekenFoutKleur);margin-top:5px;margin-bottom:5px;cursor:default}.svg-icon{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);pointer-events:none}.context-menu{position:absolute;display:none;border:1px solid var(--border);background-color:var(--context-bg);box-shadow:0 2px 10px #0003;z-index:999999999;font-size:12px;line-height:1}.context-menu-item{padding:4px 6px;cursor:pointer;display:flex;justify-content:space-between;align-items:center}.context-menu-item-disabled{cursor:default}.context-menu-item-disabled:hover{background-color:transparent}.context-menu-item:hover{background-color:var(--context-hover)}.context-menu-shortcut{margin-left:16px;color:var(--muted-text);font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:11px;padding:1px 6px;border:1px solid var(--border);border-radius:6px;background-color:color-mix(in srgb,var(--context-bg) 85%,white 15%)}.context-menu-item-hint{color:var(--muted-text)}.context-menu-item-hint .context-menu-shortcut{color:var(--text);border-color:color-mix(in srgb,var(--border) 50%,#ffb300 50%);background-color:#ffd25a59}.context-menu-separator{border:none;border-top:1px solid var(--border);margin:2px 0}.popup-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;visibility:hidden;z-index:9999}.popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background-color:var(--popup-bg);padding:5px 20px 20px;border:1px solid var(--border);border-radius:8px;box-shadow:0 4px 8px #0003;z-index:1000000}.popup h3{color:var(--link)}.eds-drawing-header{display:flex;align-items:center;gap:10px}.eds-keybinds-help-button{margin-left:auto;width:26px;height:26px;border-radius:999px;border:1px solid var(--border);background:color-mix(in srgb,var(--popup-bg) 85%,white 15%);color:var(--text);cursor:pointer;font-weight:700;line-height:1}.eds-keybinds-help-button:hover{background:color-mix(in srgb,var(--popup-bg) 70%,white 30%)}.eds-keybinds-modal{width:min(680px,calc(100vw - 32px));max-height:min(720px,calc(100vh - 32px));overflow:auto}.eds-keybinds-header{display:flex;align-items:center;justify-content:space-between;gap:12px}.eds-keybinds-title{margin:10px 0 8px}.eds-keybinds-close{border:none;background:transparent;cursor:pointer;font-size:20px;line-height:1;padding:6px 10px;border-radius:8px;color:var(--text)}.eds-keybinds-close:hover{background:color-mix(in srgb,var(--popup-bg) 70%,black 10%)}.eds-keybinds-body{margin-top:6px}.eds-keybinds-note{color:var(--muted-text);font-size:13px;margin:10px 0}.eds-keybinds-grid{display:grid;grid-template-columns:210px 1fr;gap:10px 14px;padding:12px;border:1px solid var(--border);border-radius:10px;background:color-mix(in srgb,var(--popup-bg) 92%,white 8%)}.eds-keybinds-key{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:12px;color:var(--text);padding:4px 8px;border:1px solid var(--border);border-radius:8px;width:fit-content;background:color-mix(in srgb,var(--popup-bg) 85%,white 15%)}.eds-keybinds-desc{color:var(--text);font-size:13px}@media(max-width:520px){.eds-keybinds-grid{grid-template-columns:1fr}}.rounded-button{margin:10px 7px 0;padding:10px 20px;cursor:pointer;background-color:#39f;color:#fff;border:none;border-radius:5px;display:block;width:100px;transition:background-color .3s ease-in-out}.rounded-button:hover{background-color:#06f}.button-insertChild{background-color:green;width:26px;height:26px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M4 11h12M4 11L4 4M16 11L11 6M16 11L11 16" stroke="black" stroke-width="2" stroke-linecap="round"/></svg>');background-repeat:no-repeat;background-position:center;background-size:20px 20px;display:inline-block;vertical-align:middle;margin:1px 4px 1px 0}.button-insertAfter{background-color:green;width:26px;height:26px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10 4v12M10 16l-5-5M10 16l5-5" stroke="black" stroke-width="2" stroke-linecap="round"/></svg>');background-repeat:no-repeat;background-position:center;background-size:20px 20px;display:inline-block;vertical-align:middle;margin:1px 4px 1px 0}.button-insertBefore{background-color:green;width:26px;height:26px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10 4v12M10 4l-5 5M10 4l5 5" stroke="black" stroke-width="2" stroke-linecap="round"/></svg>');background-repeat:no-repeat;background-position:center;background-size:20px 20px;display:inline-block;vertical-align:middle;margin:1px 4px 1px 0}.button-delete{background-color:red;width:26px;height:26px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M4 4l12 12M16 4L4 16" stroke="black" stroke-width="2" stroke-linecap="round"/></svg>');background-repeat:no-repeat;background-position:center;background-size:20px 20px;display:inline-block;vertical-align:middle;margin:1px 4px 1px 0}.button-delete-garbage-can{background-color:red;width:26px;height:26px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M5 5 v12 h10 v-12 M4 5 h12 M8 4 h4" stroke="black" stroke-width="2" stroke-linecap="round" fill="none" /><path d="M8.5 8 v6 M11.5 8 v6" stroke="black" stroke-width="1" stroke-linecap="round" fill="none" /></svg>');background-repeat:no-repeat;background-position:center;background-size:20px 20px;display:inline-block;vertical-align:middle;margin:1px 4px 1px 0}table.html_edit_table .button-insertChild,table.html_edit_table .button-insertAfter,table.html_edit_table .button-insertBefore,table.html_edit_table .button-delete-garbage-can{width:20px;height:20px;min-width:20px;padding:0;background-size:16px 16px;margin-right:2px;margin-top:0;margin-bottom:0;border:0}.button-green{background-color:green;height:26px;display:inline-block;align-items:center;justify-content:center;vertical-align:middle;margin:1px 4px 1px 0;font-size:20px}.button-red{background-color:red;height:26px;min-width:26px;display:inline-block;align-items:center;justify-content:center;vertical-align:middle;padding:0;margin:1px 4px 1px 0;font-size:16px}.button-lightblue{background-color:#add8e6;height:26px;min-width:26px;display:inline-block;align-items:center;justify-content:center;vertical-align:middle;margin:1px 4px 1px 0;font-size:14px;padding:0 5px}.type-orange{background-color:orange;height:26px;min-width:26px;display:inline-block;align-items:flex-end;justify-content:flex-end;vertical-align:bottom;margin:1px 4px 1px 0;font-size:14px;padding:2px 5px}html[data-theme=dark] .button-insertChild{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M4 11h12M4 11L4 4M16 11L11 6M16 11L11 16" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>')}html[data-theme=dark] .button-insertAfter{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10 4v12M10 16l-5-5M10 16l5-5" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>')}html[data-theme=dark] .button-insertBefore{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10 4v12M10 4l-5 5M10 4l5 5" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>')}html[data-theme=dark] .button-delete{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M4 4l12 12M16 4L4 16" stroke="white" stroke-width="2" stroke-linecap="round"/></svg>')}html[data-theme=dark] .button-delete-garbage-can{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M5 5 v12 h10 v-12 M4 5 h12 M8 4 h4" stroke="white" stroke-width="2" stroke-linecap="round" fill="none" /><path d="M8.5 8 v6 M11.5 8 v6" stroke="white" stroke-width="1" stroke-linecap="round" fill="none" /></svg>')}</style>
  </head>
  <body>
    <div id="container" class="container"></div>
  </body>
</html>
